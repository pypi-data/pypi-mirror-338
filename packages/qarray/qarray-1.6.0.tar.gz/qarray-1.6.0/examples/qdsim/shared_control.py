import numpy as np

from qarray import DotArray

Cdd = np.array([
    [0.12, 0.08, 0.08, 0.00, 0.04, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00],
    [0.08, 0.12, 0.04, 0.08, 0.08, 0.00, 0.00, 0.04, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00],
    [0.08, 0.04, 0.12, 0.00, 0.08, 0.08, 0.00, 0.00, 0.04, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00],
    [0.00, 0.08, 0.00, 0.12, 0.04, 0.00, 0.08, 0.08, 0.00, 0.00, 0.04, 0.00, 0.00, 0.00, 0.00, 0.00],
    [0.04, 0.08, 0.08, 0.04, 0.12, 0.04, 0.00, 0.08, 0.08, 0.00, 0.00, 0.04, 0.00, 0.00, 0.00, 0.00],
    [0.00, 0.00, 0.08, 0.00, 0.04, 0.11, 0.00, 0.00, 0.08, 0.08, 0.00, 0.00, 0.04, 0.00, 0.00, 0.00],
    [0.00, 0.00, 0.00, 0.08, 0.00, 0.00, 0.12, 0.04, 0.00, 0.00, 0.08, 0.00, 0.00, 0.00, 0.00, 0.00],
    [0.00, 0.04, 0.00, 0.08, 0.08, 0.00, 0.04, 0.12, 0.04, 0.00, 0.08, 0.08, 0.00, 0.04, 0.00, 0.00],
    [0.00, 0.00, 0.04, 0.00, 0.08, 0.08, 0.00, 0.04, 0.12, 0.04, 0.00, 0.08, 0.08, 0.00, 0.04, 0.00],
    [0.00, 0.00, 0.00, 0.04, 0.00, 0.00, 0.08, 0.08, 0.00, 0.00, 0.12, 0.04, 0.00, 0.08, 0.00, 0.00],
    [0.00, 0.00, 0.00, 0.00, 0.00, 0.08, 0.00, 0.00, 0.04, 0.12, 0.00, 0.00, 0.08, 0.00, 0.00, 0.00],
    [0.00, 0.00, 0.00, 0.00, 0.04, 0.00, 0.00, 0.08, 0.08, 0.00, 0.04, 0.11, 0.04, 0.08, 0.08, 0.04],
    [0.00, 0.00, 0.00, 0.00, 0.00, 0.04, 0.00, 0.00, 0.08, 0.08, 0.00, 0.04, 0.11, 0.00, 0.08, 0.00],
    [0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.04, 0.00, 0.00, 0.08, 0.08, 0.00, 0.11, 0.04, 0.08],
    [0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.04, 0.00, 0.00, 0.08, 0.08, 0.04, 0.12, 0.08],
    [0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.04, 0.00, 0.08, 0.08, 0.12]
])
Cdd = (Cdd + Cdd.T) / 2

Cgd = np.array([
    [0.15, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00],
    [0.00, 0.18, 0.00, 0.00, 0.00, 0.00, 0.00],
    [0.00, 0.18, 0.00, 0.00, 0.00, 0.00, 0.00],
    [0.00, 0.00, 0.12, 0.00, 0.00, 0.00, 0.00],
    [0.00, 0.00, 0.12, 0.00, 0.00, 0.00, 0.00],
    [0.00, 0.00, 0.12, 0.00, 0.00, 0.00, 0.00],
    [0.00, 0.00, 0.00, 0.13, 0.00, 0.00, 0.00],
    [0.00, 0.00, 0.00, 0.13, 0.00, 0.00, 0.00],
    [0.00, 0.00, 0.00, 0.13, 0.00, 0.00, 0.00],
    [0.00, 0.00, 0.00, 0.13, 0.00, 0.00, 0.00],
    [0.00, 0.00, 0.00, 0.00, 0.13, 0.00, 0.00],
    [0.00, 0.00, 0.00, 0.00, 0.13, 0.00, 0.00],
    [0.00, 0.00, 0.00, 0.00, 0.13, 0.00, 0.00],
    [0.00, 0.00, 0.00, 0.00, 0.00, 0.16, 0.00],
    [0.00, 0.00, 0.00, 0.00, 0.00, 0.16, 0.00],
    [0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.13]
])

model = DotArray(
    Cdd=Cdd,
    Cgd=Cgd,
    charge_carrier='e',
    algorithm='thresholded',
    threshold=0.5
)
model.run_gui(print_compute_time=True)
