"use strict";(self.webpackChunk_atoti_jupyterlab_extension=self.webpackChunk_atoti_jupyterlab_extension||[]).push([[5387,5274],{54490:(e,t,o)=>{o.d(t,{y:()=>a});var n=o(42405);const a=({label:e={label:""},insertText:t,kind:o=n.languages.CompletionItemKind.Constant,...a})=>({label:e,kind:o,insertText:void 0!==t?t:"string"==typeof e?e:e.label,range:void 0,...a})},82618:(e,t,o)=>{o.d(t,{C:()=>r});var n=o(42405),a=o(34728);function r({type:e,textModel:t,offset:o,length:r,classNames:s,options:i={}}){const l={error:{color:a.d.error,className:s?.line_error??"",position:4,zIndex:10},warning:{color:a.d.warning,className:s?.line_warning??"",position:1,zIndex:1}};return{range:n.Range.fromPositions(t.getPositionAt(o),t.getPositionAt(o+r)),options:{overviewRuler:{color:l[e].color,position:l[e].position},inlineClassName:l[e].className,zIndex:l[e].zIndex,...i}}}},70782:(e,t,o)=>{function n(e,t){const o=t.reduce(((t,o)=>{const n=function(e="",t=""){if(e.length<2||t.length<2)return 0;const o=new Map;for(let t=0;t<e.length-1;t++){const n=e.substr(t,2);o.set(n,o.get(n)??1)}let n=0;for(let e=0;e<t.length-1;e++){const a=t.substr(e,2),r=o.get(a)??0;r>0&&(o.set(a,r-1),n++)}return 2*n/(e.length+t.length-2)}(o,e);return t.coefficient<n?{value:o,coefficient:n}:t}),{value:"",coefficient:0});if(o.coefficient>.65)return o.value}o.d(t,{a:()=>n})},83070:(e,t,o)=>{function n({header:e="",body:t="",formatMessage:o=(({id:e})=>e),hint:n}){const a=[{value:`#### **${e}**`}];return n&&a.push({value:`${o({id:"aui.mdxEditor.hover.didYouMean"})}: ***${n}?***`,isTrusted:!0}),a.push({value:t}),a}o.d(t,{C:()=>n})},20684:(e,t,o)=>{function n({textModel:e,position:t,numberOfLines:o=0}){return e.getValueInRange({startColumn:0,endColumn:t.column,startLineNumber:t.lineNumber-o,endLineNumber:t.lineNumber})}o.d(t,{O:()=>n})},50964:(e,t,o)=>{o.r(t),o.d(t,{default:()=>S});var n=o(74389),a=o(93345),r=o(95889),s=o(77197),i=o(70833),l=o(31529),d=o(42405),u=o(24537),m=o(18383),c=o(54490),g=o(20684);const p=e=>(e=>{const t=e.matchAll(/Member (?<calculatedMemberUniqueName>.*) AS/gim),o=new Set;for(const e of t){const t=e?.groups?.calculatedMemberUniqueName;t&&o.add(t)}return Array.from(o)})(e).map((e=>{const[{groups:t={}}={}]=e.matchAll(/(\[Measures]).(?:(\[(?<quotedMeasure>.*)\])|(?<unquotedMeasure>\w*))/gi);return t.unquotedMeasure??t.quotedMeasure})).filter(Boolean),f={getSuggestions:({position:e,textModel:t,cube:o,dataModel:n,formatMessage:a})=>{const r=(0,g.O)({textModel:t,position:e});if(r.toLowerCase().includes("from "))return[];const i=r.match(/\[[^\]]*\]?(?:\.(?:\[[^\]]*\]?|\w*))*$/gim)?.at(-1);if(!i)return[];const[f,A,b,h]=(i||"").split(".").map((e=>e.replace(/\[([^\]]*)\]?/,"$1"))),M=o?[o]:n?(0,u.X)(n):[];if((0,m.t)({dimensionName:f}))return(({cubes:e,textModel:t,formatMessage:o})=>[...(0,l.flatMap)(e,(({name:e,measures:t})=>Object.keys(t).map((t=>(0,c.y)({label:{label:t,description:e}}))))),...p(t.getValue()).map(((e="")=>(0,c.y)({label:{label:e,description:o({id:"aui.mdxEditor.autoCompletion.calculatedMeasure"})}})))])({cubes:M,textModel:t,formatMessage:a});if(void 0===A)return(e=>[(0,c.y)({kind:d.languages.CompletionItemKind.Unit,label:"Measures",preselect:!0}),...(0,l.flatMap)(e,(({name:e,dimensions:t})=>Object.keys(t).map((t=>(0,c.y)({label:{label:t,description:e}})))))])(M);if(void 0===b)return(({cubes:e,dimensionName:t})=>(0,l.flatMap)(e,(({name:e,dimensions:o})=>{const n=o[t]?.hierarchies??{};return Object.keys(n).map((o=>(0,c.y)({label:{label:o,description:`${e}/${t}`}})))})))({cubes:M,dimensionName:f});if(void 0===h)return(({cubes:e,dimensionName:t,hierarchyName:o})=>[(0,c.y)({label:{label:"AllMember",description:`${t}/${o}`},preselect:!0}),...(0,l.flatMap)(e,(({name:e,dimensions:n})=>{const a=n[t]?.hierarchies[o]?.levels??{};return Object.keys(a).map((n=>(0,c.y)({label:{label:n,description:`${e}/${t}/${o}`}})))}))])({cubes:M,dimensionName:f,hierarchyName:A});const y="ALL"===b?[(0,c.y)({label:{label:"AllMember",description:`${f}/${A}`},preselect:!0})]:[];return y.push(...s.memberPropertyKeywords.map((e=>(0,c.y)({label:e,kind:d.languages.CompletionItemKind.Property,sortText:"zzz"})))),y}},A={getSuggestions:({position:e,textModel:t,cube:o,dataModel:n})=>{if(null===(0,g.O)({textModel:t,position:e,numberOfLines:1}).match(new RegExp(`(${s.kpiKeywords.join("|")})[(][^)]*`,"i")))return[];const a=o?[o]:n?(0,u.X)(n):[];return(0,l.flatMap)(a,(({name:e,kpis:t})=>Object.keys(t).map((t=>(0,c.y)({kind:d.languages.CompletionItemKind.Event,label:{label:t,description:e}})))))}},b={getSuggestions:({position:e,textModel:t})=>null!==(0,g.O)({textModel:t,position:e}).match(/(\bON\b\s*)([\w]*)$/i)?s.axisKeywords.map((e=>(0,c.y)({label:e}))):[]},h={getSuggestions:({position:e,textModel:t,cube:o,dataModel:n})=>{const a=(0,g.O)({textModel:t,position:e}).match(/(FROM\s+)(\[)([^\]]*)(?<CB>\])*/i);return null!==a&&void 0===a.groups?.CB?(o?[o]:n?(0,u.X)(n):[]).map((({name:e})=>(0,c.y)({kind:d.languages.CompletionItemKind.Interface,label:e}))):[]}},M=({position:e,textModel:t,cube:o,dataModel:n,formatMessage:a})=>{const r=(0,l.flatMap)([h,b,f,A],(({getSuggestions:r})=>r({position:e,textModel:t,cube:o,dataModel:n,formatMessage:a})));return r.length>0?r:[...[...s.functionKeywords,...s.kpiKeywords,...s.memberPropertyKeywords,...s.argumentKeywords].map((e=>(0,c.y)({kind:d.languages.CompletionItemKind.Function,label:e}))),...[...s.axisKeywords].map((e=>(0,c.y)({kind:d.languages.CompletionItemKind.EnumMember,label:e}))),...[...s.booleanKeywords,...s.booleanOperatorKeywords].map((e=>(0,c.y)({kind:d.languages.CompletionItemKind.Operator,label:e}))),...[...s.structuralKeywords,...s.cellPropertyKeywords].map((e=>(0,c.y)({kind:d.languages.CompletionItemKind.Keyword,label:e})))]};var y=o(82618),w=o(70782),x=o(83070);const C=e=>(0,l.flatMap)(e,(e=>Object.values(e.measures))),v=e=>(0,l.flatMap)(e,(e=>Object.values(e.dimensions))),N=(e,t)=>{const o=e.find((e=>e.dimensions[t])),n=o?.dimensions[t];return n?Object.values(n.hierarchies):[]},k={getDecorations:({textModel:e,mdxErrorDetails:t,classNames:o,formatMessage:n})=>{if(!t)return[];const a=((e,t)=>{const o=d.editor.createModel(e);try{if(t.from.ch>=0){const e=o.getValueInRange(new d.Range(t.from.line+1,t.from.ch,t.to.line+1,o.getLineLastNonWhitespaceColumn(t.to.line+1))),n=e.length-e.trimLeft().length;return new d.Range(t.from.line+1,t.from.ch+n,t.to.line+1,t.to.ch+n)}return new d.Range(t.from.line,o.getLineLastNonWhitespaceColumn(t.from.line),t.to.line+1,o.getLineFirstNonWhitespaceColumn(t.to.line+1)+t.text.length)}catch{return new d.Range(0,0,0,0)}})(e.getValue(),t),r=e.getOffsetAt(a.getStartPosition());return[(0,y.C)({type:"error",classNames:o,textModel:e,offset:r,length:e.getOffsetAt(a.getEndPosition())-r,options:{hoverMessage:(0,x.C)({header:`${n({id:"aui.mdxEditor.hover.errorOnLine"})} ***${a.startLineNumber}***`,body:`${n({id:"aui.mdxEditor.hover.availableOptionsAre"})} : \n${t.expected?.map((e=>`- ${e}`)).join("\n")}`,hint:(0,w.a)(t.text,t.expected?.map((e=>e.replace(/'/g,"")))??[]),formatMessage:n})}})]}},K={getDecorations:({textModel:e,classNames:t,formatMessage:o})=>{const n=e.getValue().matchAll(/(?<functionName>\w+)\(/gi),a=[...s.functionKeywords,...s.kpiKeywords],r=[];for(const s of n){const{functionName:n}=s.groups??{};s.index&&!["FROM",...a].map((e=>e.toLowerCase())).includes(n.toLowerCase())&&r.push((0,y.C)({type:"warning",classNames:t,textModel:e,offset:s.index,length:s[0]?.length,options:{hoverMessage:(0,x.C)({header:`${o({id:"aui.mdxEditor.hover.unknownFunction"})} ***${s.groups?.function}***`,body:`${o({id:"aui.mdxEditor.hover.availableFunctionsAre"})} : \n${a.map((e=>`- ${e}`)).join("\n")}`,hint:(0,w.a)(n,a),formatMessage:o})}}))}return r}},$={getDecorations:({textModel:e,cube:t,dataModel:o,classNames:n,formatMessage:a})=>{if(!o&&!t)return[];const r=e.getValue().matchAll(/(?:FROM\s+)(?:([(])|\[([^\]]*)\]?|(\w*))/gi),s=t?[t.name]:o?(0,u.X)(o).map((({name:e})=>e)):[],i=[];for(const t of r){if("("===t[1])continue;const o=t[2]??t[3];t.index&&!s.includes(o)&&i.push((0,y.C)({type:"error",classNames:n,textModel:e,offset:t.index,length:t[0]?.length,options:{hoverMessage:(0,x.C)({header:`${a({id:"aui.error.cubeNotFound"})} ***${o}***`,body:`${a({id:"aui.mdxEditor.hover.availableCubesAre"})} : \n${s.map((e=>`- ${e}`)).join("\n")}`,hint:(0,w.a)(o,s),formatMessage:a})}}))}return i}},E={getDecorations:({textModel:e,cube:t,dataModel:o,classNames:n,isCaseSensitive:a,formatMessage:r})=>{if(!o&&!t)return[];const s=e.getValue().matchAll(/(\[(?<dimensionName>[^\]]*)\]?)(?<dotAfterDimension>\s*\.\s*)?((?:(\[(?<quotedHierarchy>[^\]]*)\]?)|(?<unquotedHierarchy>\w*)))?(?<dotAfterHierarchy>\s*\.\s*)?(?<memberPath>.*)?/gim),i=[];for(const l of s){if(!l.index)continue;const{dimensionName:s,dotAfterDimension:d,quotedHierarchy:c,unquotedHierarchy:g}=l.groups||{},p=e.getPositionAt(l.index);if((0,m.t)({dimensionName:s})||!a&&"measures"===s.toLowerCase()||["from ","member "].some((t=>e.getValueInRange({startLineNumber:p.lineNumber,endLineNumber:p.lineNumber,startColumn:0,endColumn:p.column}).toLowerCase().includes(t))))continue;const f=t?[t]:o?(0,u.X)(o):[],A=v(f),b=a?A.find((e=>e.name===s)):A.find((e=>e.name.toLowerCase()===s.toLowerCase()));if(void 0===b){const t=A.map((({name:e})=>e));i.push((0,y.C)({type:"warning",classNames:n,textModel:e,offset:l.index,length:l[0]?.length,options:{hoverMessage:(0,x.C)({header:`${r({id:"aui.mdxEditor.hover.dimensionNotFound"})} ***${s}***`,body:`${r({id:"aui.mdxEditor.hover.availableDimensionsAre"})} : \n${t.map((e=>`- ${e}`)).join("\n")}`,hint:(0,w.a)(s,t),formatMessage:r})}}));continue}const h=(c||g)??"";if(d){const t=N(f,b.name);if(void 0===(a?t.find((e=>e.name===h)):t.find((e=>e.name.toLowerCase()===h.toLowerCase())))){const o=t.map((e=>e.name));i.push((0,y.C)({type:"warning",classNames:n,textModel:e,offset:l.index,length:l[0]?.length,options:{hoverMessage:(0,x.C)({header:r({id:"aui.mdxEditor.hover.hierarchyWarning"},{dimensionName:s,hierarchyName:h}),body:`${r({id:"aui.mdxEditor.hover.availableHierarchiesAre"},{dimensionName:s,hierarchyName:h})} : \n${o.map((e=>`- ${e}`)).join("\n")}`,hint:(0,w.a)(h,o),formatMessage:r})}}));continue}}}return i}},I={getDecorations:({textModel:e,dataModel:t,classNames:o,formatMessage:n})=>{if(!t)return[];const a=e.getValue().matchAll(new RegExp(`(${s.kpiKeywords.join("|")})[(][^]*?"(?<kpi>.*)"[^]*?[)]`,"gim")),r=(0,l.flatMap)((0,u.X)(t),(e=>Object.keys(e.kpis))),i=[];for(const t of a){const a=t.groups?.kpi??"";t.index&&!r.includes(a)&&i.push((0,y.C)({type:"warning",classNames:o,textModel:e,offset:t.index,length:t[0]?.length,options:{hoverMessage:(0,x.C)({header:`${n({id:"aui.mdxEditor.hover.invalidKPI"})} ***${a}***`,body:`${n({id:"aui.mdxEditor.hover.availableKPIsAre"})} : \n${r.map((e=>`- ${e}`)).join("\n")}`,hint:(0,w.a)(a,r),formatMessage:n})}}))}return i}},O={getDecorations:({textModel:e,cube:t,dataModel:o,classNames:n,formatMessage:a=(()=>"")})=>{if(!o)return[];const r=e.getValue().matchAll(/(\[Measures]).(?:(\[(?<quotedMeasure>.*)\])|(?<unquotedMeasure>\w*))/gi),s=t?[t]:(0,u.X)(o),i=[...C(s).map((({name:e})=>e)),...p(e.getValue())],l=[];for(const t of r){const{groups:{unquotedMeasure:o,quotedMeasure:r}={unquotedMeasure:void 0,quotedMeasure:void 0}}=t||{},s=o??r??" ";if(t.index&&!i.includes(s)){const o=e.getPositionAt(t.index);if(["from","member"].some((t=>e.getValueInRange({startLineNumber:o.lineNumber,endLineNumber:o.lineNumber,startColumn:0,endColumn:o.column}).toLowerCase().includes(t))))continue;l.push((0,y.C)({type:"warning",classNames:n,textModel:e,offset:t.index,length:t[0]?.length,options:{hoverMessage:(0,x.C)({header:`${a({id:"aui.mdxEditor.hover.invalidMeasure"})} **${s}**`,body:`${a({id:"aui.mdxEditor.hover.availableMeasuresAre"})} : \n${i.map((e=>`- ${e}`)).join("\n")}`,hint:(0,w.a)(s,i),formatMessage:a})}}))}}return l}},R={provideDocumentFormattingEdits:e=>{try{return[{range:e.getFullModelRange(),text:(0,s.stringify)((0,s.parse)(e.getValue()),{indent:!0})}]}catch{}}},L={id:"mdx",monarchLanguage:{defaultToken:"",tokenPostfix:".mdx",ignoreCase:!0,brackets:[{open:"{",close:"}",token:"delimiter.curly"},{open:"[",close:"]",token:"delimiter.square"},{close:"(",open:")",token:"delimiter.parenthesis"}],functionKeywords:s.functionKeywords,kpiKeywords:s.kpiKeywords,argumentKeywords:s.argumentKeywords,memberPropertyKeywords:s.memberPropertyKeywords,axisKeywords:s.axisKeywords,cellPropertyKeywords:s.cellPropertyKeywords,booleanOperatorKeywords:s.booleanOperatorKeywords,booleanKeywords:s.booleanKeywords,structuralKeywords:s.structuralKeywords,tokenizer:{root:[{include:"@comments"},{include:"@whiteSpace"},{include:"@numbers"},{include:"@strings"},{include:"@delimitedIdentifier"},[/[\w@]+/,{cases:{"@structuralKeywords":"keyword.structural","@booleanKeywords":"boolean","@booleanOperatorKeywords":"keyword.booleanOperator","@axisKeywords":"keyword.axis","@cellPropertyKeywords":"keyword.cellProperty","@functionKeywords":"keyword.function","@kpiKeywords":"keyword.kpi","@memberPropertyKeywords":"keyword.memberProperty","@argumentKeywords":"keyword.argument","@default":"identifier.regular"}}],{include:"@operators"}],comments:[[/(^|[^\\:])\/\/.*/,"comment"],[/(^|[^\\:])-{2}.*/,"comment"],[/(^|[^\\])\/\*[\s\S]*?(?:\*\/|$)/,"comment"]],whiteSpace:[[/\s+/,"white"]],numbers:[[/\d*\.\d+(E(\+|-)?\d+)?/,"number"],[/\d+/,"number"]],operators:[[/\+|\/|\*|\^|-/,"operator"],[/>=|<=|<>|=|>|</,"operator"],[/:|&/,"operator"]],delimitedIdentifier:[[/\[([^\]]{0,100})\]/,"identifier.delimited"]],strings:[[/'/,{token:"string",next:"@string"}],[/"/,{token:"string.double",next:"@stringDouble"}]],string:[[/[^']+/,"string"],[/''/,"string"],[/'/,{token:"string",next:"@pop"}]],stringDouble:[[/[^"]+/,"string.double"],[/""/,"string.double"],[/"/,{token:"string.double",next:"@pop"}]]}},configuration:{comments:{lineComment:"//",blockComment:["/*","*/"]},brackets:[["{","}"],["[","]"],["(",")"]],autoClosingPairs:[{open:"{",close:"}"},{open:"[",close:"]"},{open:"(",close:")"},{open:'"',close:'"'},{open:"'",close:"'"}],surroundingPairs:[{open:"{",close:"}"},{open:"[",close:"]"},{open:"(",close:")"},{open:'"',close:'"'},{open:"'",close:"'"}],onEnterRules:[{beforeText:/.*\bSELECT\s*$/,action:{indentAction:1}},{beforeText:/.*\bFROM\s*$/,action:{indentAction:1}}]}},P=()=>{},S=(0,a.forwardRef)((({value:e,cube:t,dataModel:o,isCaseSensitive:u,classNames:m,onChange:c=P,options:g},p)=>{const{formatMessage:f}=(0,r.useIntl)(),[A,b]=(0,a.useState)(),h=(0,a.useMemo)((()=>(({cube:e,dataModel:t,formatMessage:o})=>({triggerCharacters:["[","."],provideCompletionItems:(n,a,r,s)=>{if(!s.isCancellationRequested)return{suggestions:M({position:a,textModel:n,cube:e,dataModel:t,formatMessage:o})}}}))({cube:t,dataModel:o,formatMessage:f})),[t,o,f]),y=(0,a.useMemo)((()=>(({value:e,mdxErrorDetails:t,cube:o,dataModel:n,classNames:a,formatMessage:r,isCaseSensitive:s})=>{if(!e)return[];const i=d.editor.createModel(e);return(0,l.flatMap)([k,$,O,E,I,K],(({getDecorations:e})=>e({textModel:i,mdxErrorDetails:t,cube:o,dataModel:n,classNames:a,formatMessage:r,isCaseSensitive:s})))})({value:e,dataModel:o,cube:t,mdxErrorDetails:A,classNames:m,formatMessage:f,isCaseSensitive:u})),[e,A,o,m,f,t,u]);return(0,a.useEffect)((()=>{try{e&&(0,s.parse)(e),b(void 0)}catch(e){if(!(e instanceof s.MdxError))throw e;b(e.details)}}),[e]),(0,n.Y)(i.default,{ref:p,value:e,onChange:c,language:L,options:g,documentFormattingEditProvider:R,completionItemProvider:h,deltaDecorations:y})}))},68968:e=>{e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAAECAYAAACp8Z5+AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAZdEVYdFNvZnR3YXJlAHBhaW50Lm5ldCA0LjAuMTZEaa/1AAAAHUlEQVQYV2PYvXu3JAi7uLiAMaYAjAGTQBPYLQkAa/0Zef3qRswAAAAASUVORK5CYII="},3552:e=>{e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAQAAAC1+jfqAAAAL0lEQVQoz2NgCD3x//9/BhBYBWdhgFVAiVW4JBFKGIa4AqD0//9D3pt4I4tAdAMAHTQ/j5Zom30AAAAASUVORK5CYII="},62974:e=>{e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAQAAADZc7J/AAAAz0lEQVRIx2NgYGBY/R8I/vx5eelX3n82IJ9FxGf6tksvf/8FiTMQAcAGQMDvSwu09abffY8QYSAScNk45G198eX//yev73/4///701eh//kZSARckrNBRvz//+8+6ZohwCzjGNjdgQxkAg7B9WADeBjIBqtJCbhRA0YNoIkBSNmaPEMoNmA0FkYNoFKhapJ6FGyAH3nauaSmPfwI0v/3OukVi0CIZ+F25KrtYcx/CTIy0e+rC7R1Z4KMICVTQQ14feVXIbR695u14+Ir4gwAAD49E54wc1kWAAAAAElFTkSuQmCC"}}]);