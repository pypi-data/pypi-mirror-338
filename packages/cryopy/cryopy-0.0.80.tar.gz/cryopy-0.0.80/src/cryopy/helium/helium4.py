#%% 
def density(temperature,pressure):
    
    """
    ========== DESCRIPTION ==========

    This function return the density of pure Helium 4

    ========== VALIDITY ==========

    <temperature> : [0.8 -> 400]
    <pressure> : [1 -> 1e6] 

    ========== FROM ==========

    HEPAK was written by Vincent Arp, Bob McCarty, and Jeff Fox, formerly of 
    NIST and later of Cryodata, using code from Brian Hands while at the 
    Oxford University Cryogenics Laboratory.

    ========== INPUT ==========

    <temperature>
        -- float --
        The temperature of pure helium 4
        [K]

    <pressure>
        -- float --
        The pressure of pure helium 4
        [Pa]

    ========== OUTPUT ==========

    <density>
        -- float --
        The density of pure helium 4
        [kg].[m]**-3

    ========== STATUS ==========

    Status : Checked 2024-02-27
    
    ========== UPDATE ==========
    

    """
    
    ################## PACKAGES ###############################################
    
    import scipy.interpolate
    import numpy
    
    ################## CONDITIONS #############################################
    
    assert temperature >= 0.8 and temperature <= 400 , 'The function helium4.density is not valid for T = ' + str(temperature) + ' K'
    assert pressure >= 1 and pressure <=  1e6, 'The function helium4.density  is not valid for P = ' + str(pressure) + ' Pa'
    
    ################## INITIALISATION #########################################
    
    data_temperature = numpy.array([0.8,0.9,1,1.1,1.2,1.3,1.4,1.5,1.6,1.7,1.8,1.9,2,2.1,2.2,2.3,2.4,2.5,2.6,2.7,2.8,2.9,3,3.1,3.2,3.3,3.4,3.5,3.6,3.7,3.8,3.9,4,4.1,4.2,4.3,4.4,4.5,4.6,4.7,4.8,4.9,5,5.5,6,8,10,15,20,30,40,50,70,100,120,150,200,250,300,350,400])
    data_pressure = numpy.array([1, 2, 5, 1e1, 2e1, 5e1, 1e2, 2e2, 5e2, 1e3, 2e3, 5e3, 1e4, 2e4, 5e4, 1e5, 2e5, 5e5, 1e6])
    data =      [[0.000602, 145.0, 145.0, 145.0, 145.0, 145.0, 145.0, 145.0, 145.0, 145.0, 145.0, 145.0, 145.0, 146.0, 146.0, 147.0, 149.0, 153.0, 159.0], \
				 [0.000535, 0.00107, 0.00268, 145.0, 145.0, 145.0, 145.0, 145.0, 145.0, 145.0, 145.0, 145.0, 145.0, 146.0, 146.0, 147.0, 148.0, 153.0, 159.0], \
				 [0.000481, 0.000963, 0.00241, 0.00482, 145.0, 145.0, 145.0, 145.0, 145.0, 145.0, 145.0, 145.0, 145.0, 146.0, 146.0, 147.0, 148.0, 153.0, 159.0], \
				 [0.000438, 0.000876, 0.00219, 0.00438, 0.00877, 145.0, 145.0, 145.0, 145.0, 145.0, 145.0, 145.0, 145.0, 146.0, 146.0, 147.0, 148.0, 153.0, 159.0], \
				 [0.000401, 0.000802, 0.00201, 0.00402, 0.00804, 0.0201, 145.0, 145.0, 145.0, 145.0, 145.0, 145.0, 145.0, 146.0, 146.0, 147.0, 148.0, 153.0, 159.0], \
				 [0.00037, 0.000741, 0.00185, 0.00371, 0.00742, 0.0186, 0.0373, 145.0, 145.0, 145.0, 145.0, 145.0, 145.0, 146.0, 146.0, 147.0, 149.0, 153.0, 159.0], \
				 [0.000344, 0.000688, 0.00172, 0.00344, 0.00688, 0.0172, 0.0346, 0.0695, 145.0, 145.0, 145.0, 145.0, 145.0, 146.0, 146.0, 147.0, 149.0, 153.0, 159.0], \
				 [0.000321, 0.000642, 0.00161, 0.00321, 0.00642, 0.0161, 0.0322, 0.0647, 145.0, 145.0, 145.0, 145.0, 145.0, 146.0, 146.0, 147.0, 149.0, 153.0, 159.0], \
				 [0.000301, 0.000602, 0.0015, 0.00301, 0.00602, 0.0151, 0.0302, 0.0606, 0.153, 145.0, 145.0, 145.0, 145.0, 146.0, 146.0, 147.0, 149.0, 153.0, 159.0], \
				 [0.000283, 0.000566, 0.00142, 0.00283, 0.00567, 0.0142, 0.0284, 0.0569, 0.143, 0.291, 145.0, 145.0, 146.0, 146.0, 146.0, 147.0, 149.0, 153.0, 160.0], \
				 [0.000267, 0.000535, 0.00134, 0.00268, 0.00535, 0.0134, 0.0268, 0.0537, 0.135, 0.273, 145.0, 145.0, 146.0, 146.0, 146.0, 147.0, 149.0, 153.0, 160.0], \
				 [0.000253, 0.000507, 0.00127, 0.00253, 0.00507, 0.0127, 0.0254, 0.0509, 0.128, 0.258, 0.527, 146.0, 146.0, 146.0, 146.0, 147.0, 149.0, 154.0, 160.0], \
				 [0.000241, 0.000481, 0.0012, 0.00241, 0.00482, 0.012, 0.0241, 0.0483, 0.121, 0.245, 0.497, 146.0, 146.0, 146.0, 147.0, 147.0, 149.0, 154.0, 161.0], \
				 [0.000229, 0.000458, 0.00115, 0.00229, 0.00459, 0.0115, 0.023, 0.046, 0.115, 0.232, 0.472, 146.0, 146.0, 146.0, 147.0, 148.0, 150.0, 155.0, 161.0], \
				 [0.000219, 0.000438, 0.00109, 0.00219, 0.00438, 0.0109, 0.0219, 0.0439, 0.11, 0.222, 0.449, 1.17, 146.0, 146.0, 147.0, 148.0, 150.0, 155.0, 161.0], \
				 [0.000209, 0.000419, 0.00105, 0.00209, 0.00419, 0.0105, 0.021, 0.042, 0.105, 0.212, 0.428, 1.11, 146.0, 146.0, 147.0, 148.0, 150.0, 155.0, 161.0], \
				 [0.000201, 0.000401, 0.001, 0.00201, 0.00401, 0.01, 0.0201, 0.0402, 0.101, 0.203, 0.409, 1.05, 146.0, 146.0, 146.0, 147.0, 149.0, 154.0, 161.0], \
				 [0.000193, 0.000385, 0.000963, 0.00193, 0.00385, 0.00963, 0.0193, 0.0386, 0.0967, 0.194, 0.392, 1.01, 2.12, 145.0, 146.0, 147.0, 149.0, 154.0, 161.0], \
				 [0.000185, 0.00037, 0.000926, 0.00185, 0.0037, 0.00926, 0.0185, 0.0371, 0.0929, 0.187, 0.376, 0.964, 2.01, 145.0, 145.0, 146.0, 148.0, 153.0, 160.0], \
				 [0.000178, 0.000357, 0.000892, 0.00178, 0.00357, 0.00892, 0.0178, 0.0357, 0.0895, 0.18, 0.362, 0.925, 1.92, 144.0, 145.0, 146.0, 148.0, 153.0, 160.0], \
				 [0.000172, 0.000344, 0.00086, 0.00172, 0.00344, 0.0086, 0.0172, 0.0344, 0.0862, 0.173, 0.348, 0.889, 1.84, 143.0, 144.0, 145.0, 147.0, 153.0, 160.0], \
				 [0.000166, 0.000332, 0.00083, 0.00166, 0.00332, 0.0083, 0.0166, 0.0332, 0.0832, 0.167, 0.336, 0.855, 1.77, 3.8, 143.0, 144.0, 146.0, 152.0, 159.0], \
				 [0.00016, 0.000321, 0.000802, 0.0016, 0.00321, 0.00803, 0.0161, 0.0321, 0.0805, 0.161, 0.324, 0.825, 1.7, 3.63, 142.0, 143.0, 146.0, 151.0, 159.0], \
				 [0.000155, 0.000311, 0.000776, 0.00155, 0.00311, 0.00777, 0.0155, 0.0311, 0.0778, 0.156, 0.314, 0.797, 1.64, 3.48, 141.0, 142.0, 145.0, 151.0, 158.0], \
				 [0.00015, 0.000301, 0.000752, 0.0015, 0.00301, 0.00752, 0.0151, 0.0301, 0.0754, 0.151, 0.304, 0.77, 1.58, 3.34, 140.0, 141.0, 144.0, 150.0, 158.0], \
				 [0.000146, 0.000292, 0.000729, 0.00146, 0.00292, 0.0073, 0.0146, 0.0292, 0.0731, 0.147, 0.294, 0.746, 1.53, 3.21, 139.0, 140.0, 143.0, 149.0, 157.0], \
				 [0.000142, 0.000283, 0.000708, 0.00142, 0.00283, 0.00708, 0.0142, 0.0283, 0.0709, 0.142, 0.285, 0.722, 1.48, 3.09, 138.0, 139.0, 142.0, 149.0, 157.0], \
				 [0.000138, 0.000275, 0.000688, 0.00138, 0.00275, 0.00688, 0.0138, 0.0275, 0.0689, 0.138, 0.277, 0.701, 1.43, 2.98, 136.0, 138.0, 141.0, 148.0, 156.0], \
				 [0.000134, 0.000267, 0.000669, 0.00134, 0.00267, 0.00669, 0.0134, 0.0268, 0.067, 0.134, 0.269, 0.681, 1.39, 2.88, 8.37, 137.0, 140.0, 147.0, 155.0], \
				 [0.00013, 0.00026, 0.000651, 0.0013, 0.0026, 0.00651, 0.013, 0.026, 0.0652, 0.131, 0.262, 0.661, 1.35, 2.79, 8.0, 135.0, 138.0, 146.0, 155.0], \
				 [0.000127, 0.000253, 0.000633, 0.00127, 0.00253, 0.00634, 0.0127, 0.0254, 0.0634, 0.127, 0.255, 0.643, 1.31, 2.71, 7.66, 133.0, 137.0, 145.0, 154.0], \
				 [0.000123, 0.000247, 0.000617, 0.00123, 0.00247, 0.00617, 0.0123, 0.0247, 0.0618, 0.124, 0.248, 0.626, 1.27, 2.63, 7.36, 132.0, 136.0, 144.0, 153.0], \
				 [0.00012, 0.000241, 0.000602, 0.0012, 0.00241, 0.00602, 0.012, 0.0241, 0.0603, 0.121, 0.242, 0.61, 1.24, 2.55, 7.09, 130.0, 134.0, 143.0, 152.0], \
				 [0.000117, 0.000235, 0.000587, 0.00117, 0.00235, 0.00587, 0.0117, 0.0235, 0.0588, 0.118, 0.236, 0.595, 1.21, 2.48, 6.84, 128.0, 132.0, 142.0, 152.0], \
				 [0.000115, 0.000229, 0.000573, 0.00115, 0.00229, 0.00573, 0.0115, 0.0229, 0.0574, 0.115, 0.23, 0.58, 1.18, 2.41, 6.61, 125.0, 131.0, 141.0, 151.0], \
				 [0.000112, 0.000224, 0.00056, 0.00112, 0.00224, 0.0056, 0.0112, 0.0224, 0.056, 0.112, 0.225, 0.566, 1.15, 2.35, 6.39, 15.7, 129.0, 139.0, 150.0], \
				 [0.000109, 0.000219, 0.000547, 0.00109, 0.00219, 0.00547, 0.0109, 0.0219, 0.0548, 0.11, 0.22, 0.553, 1.12, 2.29, 6.2, 14.9, 127.0, 138.0, 149.0], \
				 [0.000107, 0.000214, 0.000535, 0.00107, 0.00214, 0.00535, 0.0107, 0.0214, 0.0535, 0.107, 0.215, 0.541, 1.09, 2.23, 6.02, 14.3, 124.0, 137.0, 148.0], \
				 [0.000105, 0.000209, 0.000523, 0.00105, 0.00209, 0.00523, 0.0105, 0.0209, 0.0524, 0.105, 0.21, 0.528, 1.07, 2.18, 5.85, 13.6, 122.0, 135.0, 147.0], \
				 [0.000102, 0.000205, 0.000512, 0.00102, 0.00205, 0.00512, 0.0102, 0.0205, 0.0513, 0.103, 0.206, 0.517, 1.04, 2.13, 5.69, 13.1, 119.0, 134.0, 146.0], \
				 [0.0001, 0.000201, 0.000501, 0.001, 0.00201, 0.00502, 0.01, 0.0201, 0.0502, 0.1, 0.201, 0.506, 1.02, 2.08, 5.54, 12.6, 115.0, 132.0, 145.0], \
				 [9.82e-05, 0.000196, 0.000491, 0.000982, 0.00197, 0.00491, 0.00983, 0.0197, 0.0492, 0.0984, 0.197, 0.495, 1.0, 2.04, 5.39, 12.2, 110.0, 131.0, 144.0], \
				 [9.63e-05, 0.000193, 0.000481, 0.000963, 0.00193, 0.00481, 0.00963, 0.0193, 0.0482, 0.0964, 0.193, 0.485, 0.979, 1.99, 5.26, 11.8, 103.0, 129.0, 143.0], \
				 [8.75e-05, 0.000175, 0.000438, 0.000875, 0.00175, 0.00438, 0.00875, 0.0175, 0.0438, 0.0876, 0.176, 0.44, 0.887, 1.8, 4.69, 10.2, 26.2, 118.0, 138.0], \
				 [8.02e-05, 0.00016, 0.000401, 0.000802, 0.0016, 0.00401, 0.00802, 0.0161, 0.0401, 0.0803, 0.161, 0.403, 0.811, 1.64, 4.24, 9.03, 21.3, 102.0, 131.0], \
				 [6.02e-05, 0.00012, 0.000301, 0.000602, 0.0012, 0.00301, 0.00602, 0.012, 0.0301, 0.0602, 0.12, 0.302, 0.605, 1.22, 3.09, 6.34, 13.4, 41.3, 93.3], \
				 [4.81e-05, 9.63e-05, 0.000241, 0.000481, 0.000963, 0.00241, 0.00481, 0.00963, 0.0241, 0.0482, 0.0963, 0.241, 0.483, 0.968, 2.44, 4.95, 10.2, 27.8, 61.4], \
				 [3.21e-05, 6.42e-05, 0.00016, 0.000321, 0.000642, 0.0016, 0.00321, 0.00642, 0.016, 0.0321, 0.0642, 0.161, 0.321, 0.643, 1.61, 3.23, 6.5, 16.5, 33.6], \
				 [2.41e-05, 4.81e-05, 0.00012, 0.000241, 0.000481, 0.0012, 0.00241, 0.00481, 0.012, 0.0241, 0.0481, 0.12, 0.241, 0.481, 1.2, 2.41, 4.82, 12.0, 24.0], \
				 [1.6e-05, 3.21e-05, 8.02e-05, 0.00016, 0.000321, 0.000802, 0.0016, 0.00321, 0.00802, 0.016, 0.0321, 0.0802, 0.16, 0.321, 0.801, 1.6, 3.19, 7.93, 15.7], \
				 [1.2e-05, 2.41e-05, 6.02e-05, 0.00012, 0.000241, 0.000602, 0.0012, 0.00241, 0.00602, 0.012, 0.0241, 0.0602, 0.12, 0.241, 0.601, 1.2, 2.39, 5.94, 11.7], \
				 [9.63e-06, 1.93e-05, 4.81e-05, 9.63e-05, 0.000193, 0.000481, 0.000963, 0.00193, 0.00481, 0.00963, 0.0193, 0.0481, 0.0963, 0.192, 0.481, 0.96, 1.92, 4.76, 9.4], \
				 [6.88e-06, 1.38e-05, 3.44e-05, 6.88e-05, 0.000138, 0.000344, 0.000688, 0.00138, 0.00344, 0.00688, 0.0138, 0.0344, 0.0688, 0.137, 0.344, 0.686, 1.37, 3.4, 6.74], \
				 [4.81e-06, 9.63e-06, 2.41e-05, 4.81e-05, 9.63e-05, 0.000241, 0.000481, 0.000963, 0.00241, 0.00481, 0.00963, 0.0241, 0.0481, 0.0963, 0.241, 0.481, 0.96, 2.39, 4.74], \
				 [4.01e-06, 8.02e-06, 2.01e-05, 4.01e-05, 8.02e-05, 0.000201, 0.000401, 0.000802, 0.00201, 0.00401, 0.00802, 0.0201, 0.0401, 0.0802, 0.2, 0.401, 0.8, 1.99, 3.96], \
				 [3.21e-06, 6.42e-06, 1.6e-05, 3.21e-05, 6.42e-05, 0.00016, 0.000321, 0.000642, 0.0016, 0.00321, 0.00642, 0.016, 0.0321, 0.0642, 0.16, 0.321, 0.641, 1.6, 3.18], \
				 [2.41e-06, 4.81e-06, 1.2e-05, 2.41e-05, 4.81e-05, 0.00012, 0.000241, 0.000481, 0.0012, 0.00241, 0.00481, 0.012, 0.0241, 0.0481, 0.12, 0.241, 0.481, 1.2, 2.39], \
				 [1.93e-06, 3.85e-06, 9.63e-06, 1.93e-05, 3.85e-05, 9.63e-05, 0.000193, 0.000385, 0.000963, 0.00193, 0.00385, 0.00963, 0.0193, 0.0385, 0.0963, 0.192, 0.385, 0.96, 1.91], \
				 [1.6e-06, 3.21e-06, 8.02e-06, 1.6e-05, 3.21e-05, 8.02e-05, 0.00016, 0.000321, 0.000802, 0.0016, 0.00321, 0.00802, 0.016, 0.0321, 0.0802, 0.16, 0.321, 0.801, 1.6], \
				 [1.38e-06, 2.75e-06, 6.88e-06, 1.38e-05, 2.75e-05, 6.88e-05, 0.000138, 0.000275, 0.000688, 0.00138, 0.00275, 0.00688, 0.0138, 0.0275, 0.0688, 0.137, 0.275, 0.686, 1.37], \
				 [1.2e-06, 2.41e-06, 6.02e-06, 1.2e-05, 2.41e-05, 6.02e-05, 0.00012, 0.000241, 0.000602, 0.0012, 0.00241, 0.00602, 0.012, 0.0241, 0.0602, 0.12, 0.241, 0.601, 1.2]]
    

    ################## FUNCTION ###############################################
    
    function = scipy.interpolate.RectBivariateSpline(data_temperature, data_pressure, data)

    result = function(temperature,pressure)[0][0]
    
    return result

#%% 
def compressibility(temperature,pressure):
    
    """
    ========== DESCRIPTION ==========

    This function return the compressibility of pure Helium 4

    ========== VALIDITY ==========

    <temperature> : [0.8 -> 400]
    <pressure> : [1 -> 1e6] 

    ========== FROM ==========

    HEPAK was written by Vincent Arp, Bob McCarty, and Jeff Fox, formerly of 
    NIST and later of Cryodata, using code from Brian Hands while at the 
    Oxford University Cryogenics Laboratory.


    ========== INPUT ==========

    <temperature>
        -- float --
        The temperature of pure helium 4
        [K]

    <pressure>
        -- float --
        The pressure of pure helium 4
        [Pa]

    ========== OUTPUT ==========

    <compressibility>
        -- float --
        The compressibility of pure helium 4
        []

    ========== STATUS ==========

    Status : Checked 2024-02-27
    
    ========== UPDATE ==========
    

    """
    
    ################## PACKAGES ###############################################
    
    import scipy.interpolate
    import numpy
    
    ################## CONDITIONS #############################################
    
    assert temperature >= 0.8 and temperature <= 400 , 'The function helium4.compressibility is not valid for T = ' + str(temperature) + ' K'
    assert pressure >= 1 and pressure <=  1e6, 'The function helium4.compressibility  is not valid for P = ' + str(pressure) + ' Pa'
    
    ################## INITIALISATION #########################################
    
    data_temperature = numpy.array([0.8,0.9,1,1.1,1.2,1.3,1.4,1.5,1.6,1.7,1.8,1.9,2,2.1,2.2,2.3,2.4,2.5,2.6,2.7,2.8,2.9,3,3.1,3.2,3.3,3.4,3.5,3.6,3.7,3.8,3.9,4,4.1,4.2,4.3,4.4,4.5,4.6,4.7,4.8,4.9,5,5.5,6,8,10,15,20,30,40,50,70,100,120,150,200,250,300,350,400])
    data_pressure = numpy.array([1, 2, 5, 1e1, 2e1, 5e1, 1e2, 2e2, 5e2, 1e3, 2e3, 5e3, 1e4, 2e4, 5e4, 1e5, 2e5, 5e5, 1e6])
    data =      [[1.0, 8.29e-06, 2.07e-05, 4.15e-05, 8.29e-05, 0.000207, 0.000415, 0.000829, 0.00207, 0.00414, 0.00829, 0.0207, 0.0414, 0.0827, 0.206, 0.41, 0.81, 1.97, 3.79], \
				 [1.0, 0.999, 0.999, 3.68e-05, 7.37e-05, 0.000184, 0.000368, 0.000737, 0.00184, 0.00368, 0.00737, 0.0184, 0.0368, 0.0735, 0.183, 0.364, 0.72, 1.75, 3.37], \
				 [1.0, 1.0, 0.999, 0.998, 6.63e-05, 0.000166, 0.000332, 0.000663, 0.00166, 0.00332, 0.00663, 0.0166, 0.0331, 0.0662, 0.165, 0.328, 0.648, 1.58, 3.03], \
				 [1.0, 1.0, 0.999, 0.999, 0.998, 0.000151, 0.000301, 0.000603, 0.00151, 0.00301, 0.00603, 0.0151, 0.0301, 0.0602, 0.15, 0.298, 0.589, 1.43, 2.76], \
				 [1.0, 1.0, 1.0, 0.999, 0.998, 0.996, 0.000276, 0.000553, 0.00138, 0.00276, 0.00553, 0.0138, 0.0276, 0.0551, 0.137, 0.273, 0.54, 1.31, 2.53], \
				 [1.0, 1.0, 1.0, 0.999, 0.999, 0.997, 0.993, 0.00051, 0.00128, 0.00255, 0.0051, 0.0127, 0.0255, 0.0509, 0.127, 0.252, 0.499, 1.21, 2.33], \
				 [1.0, 1.0, 1.0, 0.999, 0.999, 0.998, 0.995, 0.99, 0.00118, 0.00237, 0.00474, 0.0118, 0.0237, 0.0473, 0.118, 0.234, 0.463, 1.12, 2.16], \
				 [1.0, 1.0, 1.0, 1.0, 0.999, 0.998, 0.996, 0.992, 0.0011, 0.00221, 0.00442, 0.011, 0.0221, 0.0441, 0.11, 0.218, 0.432, 1.05, 2.02], \
				 [1.0, 1.0, 1.0, 1.0, 0.999, 0.998, 0.997, 0.994, 0.984, 0.00207, 0.00414, 0.0103, 0.0207, 0.0413, 0.103, 0.205, 0.405, 0.983, 1.89], \
				 [1.0, 1.0, 1.0, 1.0, 0.999, 0.999, 0.997, 0.995, 0.987, 0.974, 0.0039, 0.00974, 0.0195, 0.0389, 0.0968, 0.193, 0.381, 0.924, 1.77], \
				 [1.0, 1.0, 1.0, 1.0, 1.0, 0.999, 0.998, 0.996, 0.989, 0.978, 0.00368, 0.00919, 0.0184, 0.0367, 0.0914, 0.182, 0.359, 0.872, 1.67], \
				 [1.0, 1.0, 1.0, 1.0, 1.0, 0.999, 0.998, 0.996, 0.991, 0.981, 0.962, 0.0087, 0.0174, 0.0347, 0.0865, 0.172, 0.34, 0.824, 1.58], \
				 [1.0, 1.0, 1.0, 1.0, 1.0, 0.999, 0.998, 0.997, 0.992, 0.984, 0.968, 0.00826, 0.0165, 0.033, 0.0821, 0.163, 0.323, 0.781, 1.5], \
				 [1.0, 1.0, 1.0, 1.0, 1.0, 0.999, 0.999, 0.997, 0.993, 0.986, 0.972, 0.00786, 0.0157, 0.0314, 0.0781, 0.155, 0.306, 0.742, 1.42], \
				 [1.0, 1.0, 1.0, 1.0, 1.0, 0.999, 0.999, 0.998, 0.994, 0.988, 0.976, 0.938, 0.015, 0.0299, 0.0744, 0.148, 0.292, 0.707, 1.36], \
				 [1.0, 1.0, 1.0, 1.0, 1.0, 0.999, 0.999, 0.998, 0.995, 0.989, 0.978, 0.945, 0.0143, 0.0286, 0.0713, 0.142, 0.28, 0.677, 1.3], \
				 [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.999, 0.998, 0.995, 0.99, 0.981, 0.951, 0.0138, 0.0275, 0.0685, 0.136, 0.269, 0.65, 1.25], \
				 [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.999, 0.998, 0.996, 0.991, 0.983, 0.956, 0.91, 0.0265, 0.066, 0.131, 0.259, 0.626, 1.2], \
				 [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.999, 0.998, 0.996, 0.992, 0.984, 0.961, 0.919, 0.0256, 0.0637, 0.127, 0.25, 0.603, 1.16], \
				 [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.999, 0.999, 0.996, 0.993, 0.986, 0.964, 0.927, 0.0248, 0.0617, 0.122, 0.241, 0.583, 1.12], \
				 [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.999, 0.999, 0.997, 0.994, 0.987, 0.967, 0.934, 0.024, 0.0598, 0.119, 0.234, 0.564, 1.08], \
				 [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.999, 0.999, 0.997, 0.994, 0.988, 0.97, 0.939, 0.873, 0.0581, 0.115, 0.227, 0.546, 1.04], \
				 [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.999, 0.999, 0.997, 0.995, 0.989, 0.973, 0.944, 0.884, 0.0565, 0.112, 0.22, 0.53, 1.01], \
				 [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.999, 0.999, 0.998, 0.995, 0.99, 0.975, 0.949, 0.894, 0.055, 0.109, 0.214, 0.515, 0.982], \
				 [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.999, 0.998, 0.995, 0.991, 0.977, 0.953, 0.902, 0.0537, 0.106, 0.209, 0.501, 0.954], \
				 [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.999, 0.998, 0.996, 0.991, 0.978, 0.956, 0.909, 0.0525, 0.104, 0.204, 0.489, 0.929], \
				 [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.999, 0.998, 0.996, 0.992, 0.98, 0.959, 0.916, 0.0515, 0.102, 0.2, 0.477, 0.905], \
				 [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.999, 0.998, 0.996, 0.993, 0.981, 0.962, 0.922, 0.0505, 0.0998, 0.195, 0.466, 0.882], \
				 [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.999, 0.998, 0.997, 0.993, 0.982, 0.965, 0.927, 0.799, 0.098, 0.192, 0.455, 0.861], \
				 [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.999, 0.998, 0.997, 0.993, 0.984, 0.967, 0.932, 0.814, 0.0963, 0.188, 0.446, 0.842], \
				 [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.999, 0.998, 0.997, 0.994, 0.985, 0.969, 0.936, 0.827, 0.0949, 0.185, 0.437, 0.823], \
				 [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.999, 0.999, 0.997, 0.994, 0.985, 0.971, 0.94, 0.839, 0.0937, 0.182, 0.429, 0.806], \
				 [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.999, 0.999, 0.997, 0.995, 0.986, 0.972, 0.944, 0.849, 0.0927, 0.179, 0.421, 0.79], \
				 [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.999, 0.999, 0.997, 0.995, 0.987, 0.974, 0.947, 0.859, 0.0919, 0.177, 0.414, 0.774], \
				 [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.999, 0.998, 0.995, 0.988, 0.975, 0.95, 0.868, 0.0914, 0.175, 0.408, 0.76], \
				 [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.999, 0.998, 0.995, 0.988, 0.977, 0.953, 0.875, 0.711, 0.174, 0.402, 0.746], \
				 [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.999, 0.998, 0.996, 0.989, 0.978, 0.955, 0.883, 0.732, 0.173, 0.396, 0.734], \
				 [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.999, 0.998, 0.996, 0.99, 0.979, 0.958, 0.889, 0.751, 0.172, 0.391, 0.722], \
				 [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.999, 0.998, 0.996, 0.99, 0.98, 0.96, 0.895, 0.767, 0.172, 0.386, 0.71], \
				 [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.999, 0.998, 0.996, 0.991, 0.981, 0.962, 0.901, 0.782, 0.173, 0.382, 0.7], \
				 [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.999, 0.998, 0.996, 0.991, 0.982, 0.964, 0.906, 0.795, 0.175, 0.379, 0.69], \
				 [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.999, 0.998, 0.997, 0.992, 0.983, 0.966, 0.911, 0.807, 0.179, 0.376, 0.681], \
				 [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.999, 0.998, 0.997, 0.992, 0.984, 0.967, 0.915, 0.817, 0.187, 0.373, 0.672], \
				 [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.999, 0.999, 0.997, 0.994, 0.987, 0.974, 0.933, 0.86, 0.669, 0.37, 0.636], \
				 [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.999, 0.999, 0.998, 0.995, 0.99, 0.979, 0.946, 0.889, 0.755, 0.393, 0.613], \
				 [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.999, 0.999, 0.997, 0.995, 0.99, 0.974, 0.949, 0.895, 0.728, 0.645], \
				 [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.999, 0.999, 0.997, 0.995, 0.986, 0.973, 0.946, 0.867, 0.785], \
				 [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.999, 0.999, 0.997, 0.994, 0.988, 0.972, 0.954], \
				 [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.999, 0.999, 1.0], \
				 [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.01, 1.02], \
				 [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.01, 1.01, 1.03], \
				 [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.01, 1.02], \
				 [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.01, 1.02], \
				 [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.01, 1.01], \
				 [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.01, 1.01], \
				 [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.01], \
				 [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.01], \
				 [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.01], \
				 [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0], \
				 [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0], \
				 [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]]

    ################## FUNCTION ###############################################
    
    function = scipy.interpolate.RectBivariateSpline(data_temperature, data_pressure, data)

    result = function(temperature,pressure)[0][0]
    
    return result

#%% 
def enthalpy(temperature,pressure,unit):
    
    """
    ========== DESCRIPTION ==========

    This function return the enthalpy of pure Helium 4

    ========== VALIDITY ==========

    <temperature> : [0.8 -> 400]
    <pressure> : [1 -> 1e6] 

    ========== FROM ==========

    HEPAK was written by Vincent Arp, Bob McCarty, and Jeff Fox, formerly of 
    NIST and later of Cryodata, using code from Brian Hands while at the 
    Oxford University Cryogenics Laboratory.


    ========== INPUT ==========

    <temperature>
        -- float --
        The temperature of pure helium 4
        [K]

    <pressure>
        -- float --
        The pressure of pure helium 4
        [Pa]
        
    <unit>
        -- string --
        Either kg or mol

    ========== OUTPUT ==========

    <enthalpy>
        -- float --
        The enthalpy of pure helium 4
        if 'kg' : [J].[kg]**(-1)
        if 'mol' : [J].[mol]**(-1)

    ========== STATUS ==========

    Status : Checked 2024-02-27
    
    ========== UPDATE ==========
    

    """
    
    ################## PACKAGES ###############################################
    
    import scipy.interpolate
    import numpy
    
    ################## CONDITIONS #############################################
    
    assert temperature >= 0.8 and temperature <= 400 , 'The function helium4.enthalpy is not valid for T = ' + str(temperature) + ' K'
    assert pressure >= 1 and pressure <=  1e6, 'The function helium4.enthalpy  is not valid for P = ' + str(pressure) + ' Pa'
    
    ################## INITIALISATION #########################################
    
    data_temperature = numpy.array([0.8,0.9,1,1.1,1.2,1.3,1.4,1.5,1.6,1.7,1.8,1.9,2,2.1,2.2,2.3,2.4,2.5,2.6,2.7,2.8,2.9,3,3.1,3.2,3.3,3.4,3.5,3.6,3.7,3.8,3.9,4,4.1,4.2,4.3,4.4,4.5,4.6,4.7,4.8,4.9,5,5.5,6,8,10,15,20,30,40,50,70,100,120,150,200,250,300,350,400])
    data_pressure = numpy.array([1, 2, 5, 1e1, 2e1, 5e1, 1e2, 2e2, 5e2, 1e3, 2e3, 5e3, 1e4, 2e4, 5e4, 1e5, 2e5, 5e5, 1e6])
    data =		[[19400.0, 1.88, 1.9, 1.94, 2.0, 2.21, 2.56, 3.24, 5.31, 8.75, 15.6, 36.3, 70.7, 139.0, 345.0, 686.0, 1360.0, 3350.0, 6560.0], \
				 [19900.0, 19900.0, 19900.0, 5.39, 5.46, 5.66, 6.01, 6.7, 8.76, 12.2, 19.1, 39.7, 74.1, 143.0, 349.0, 690.0, 1370.0, 3360.0, 6570.0], \
				 [20500.0, 20500.0, 20500.0, 20500.0, 12.7, 12.9, 13.3, 13.9, 16.0, 19.5, 26.3, 47.0, 81.4, 150.0, 356.0, 697.0, 1370.0, 3360.0, 6580.0], \
				 [21000.0, 21000.0, 21000.0, 21000.0, 21000.0, 26.8, 27.2, 27.9, 29.9, 33.4, 40.3, 60.9, 95.4, 164.0, 370.0, 711.0, 1390.0, 3380.0, 6600.0], \
				 [21500.0, 21500.0, 21500.0, 21500.0, 21500.0, 21500.0, 51.9, 52.6, 54.6, 58.1, 65.0, 85.7, 120.0, 189.0, 395.0, 737.0, 1410.0, 3410.0, 6630.0], \
				 [22000.0, 22000.0, 22000.0, 22000.0, 22000.0, 22000.0, 22000.0, 93.4, 95.5, 99.0, 106.0, 127.0, 161.0, 230.0, 436.0, 778.0, 1460.0, 3450.0, 6680.0], \
				 [22500.0, 22500.0, 22500.0, 22500.0, 22500.0, 22500.0, 22500.0, 22400.0, 159.0, 163.0, 170.0, 190.0, 225.0, 294.0, 500.0, 842.0, 1520.0, 3520.0, 6750.0], \
				 [23100.0, 23100.0, 23100.0, 23100.0, 23100.0, 23000.0, 23000.0, 23000.0, 254.0, 258.0, 265.0, 286.0, 320.0, 389.0, 596.0, 938.0, 1620.0, 3620.0, 6860.0], \
				 [23600.0, 23600.0, 23600.0, 23600.0, 23600.0, 23600.0, 23500.0, 23500.0, 23400.0, 394.0, 401.0, 422.0, 456.0, 525.0, 732.0, 1080.0, 1760.0, 3770.0, 7020.0], \
				 [24100.0, 24100.0, 24100.0, 24100.0, 24100.0, 24100.0, 24100.0, 24000.0, 24000.0, 23800.0, 590.0, 610.0, 645.0, 714.0, 921.0, 1270.0, 1950.0, 3970.0, 7240.0], \
				 [24600.0, 24600.0, 24600.0, 24600.0, 24600.0, 24600.0, 24600.0, 24600.0, 24500.0, 24400.0, 845.0, 865.0, 900.0, 970.0, 1180.0, 1520.0, 2210.0, 4240.0, 7530.0], \
				 [25100.0, 25100.0, 25100.0, 25100.0, 25100.0, 25100.0, 25100.0, 25100.0, 25000.0, 24900.0, 24700.0, 1200.0, 1240.0, 1310.0, 1520.0, 1860.0, 2550.0, 4600.0, 7920.0], \
				 [25700.0, 25700.0, 25700.0, 25700.0, 25700.0, 25600.0, 25600.0, 25600.0, 25600.0, 25500.0, 25300.0, 1660.0, 1690.0, 1760.0, 1970.0, 2320.0, 3010.0, 5080.0, 8470.0], \
				 [26200.0, 26200.0, 26200.0, 26200.0, 26200.0, 26200.0, 26200.0, 26100.0, 26100.0, 26000.0, 25800.0, 2270.0, 2300.0, 2370.0, 2590.0, 2940.0, 3650.0, 5760.0, 9150.0], \
				 [26700.0, 26700.0, 26700.0, 26700.0, 26700.0, 26700.0, 26700.0, 26700.0, 26600.0, 26500.0, 26400.0, 25900.0, 3120.0, 3190.0, 3390.0, 3720.0, 4380.0, 6300.0, 9390.0], \
				 [27200.0, 27200.0, 27200.0, 27200.0, 27200.0, 27200.0, 27200.0, 27200.0, 27100.0, 27100.0, 26900.0, 26500.0, 3440.0, 3500.0, 3700.0, 4020.0, 4650.0, 6540.0, 9580.0], \
				 [27700.0, 27700.0, 27700.0, 27700.0, 27700.0, 27700.0, 27700.0, 27700.0, 27700.0, 27600.0, 27500.0, 27100.0, 3690.0, 3750.0, 3940.0, 4260.0, 4880.0, 6740.0, 9750.0], \
				 [28300.0, 28300.0, 28300.0, 28300.0, 28300.0, 28200.0, 28200.0, 28200.0, 28200.0, 28100.0, 28000.0, 27700.0, 27000.0, 3980.0, 4170.0, 4480.0, 5100.0, 6930.0, 9920.0], \
				 [28800.0, 28800.0, 28800.0, 28800.0, 28800.0, 28800.0, 28800.0, 28800.0, 28700.0, 28700.0, 28600.0, 28200.0, 27700.0, 4210.0, 4390.0, 4700.0, 5310.0, 7120.0, 10100.0], \
				 [29300.0, 29300.0, 29300.0, 29300.0, 29300.0, 29300.0, 29300.0, 29300.0, 29200.0, 29200.0, 29100.0, 28800.0, 28300.0, 4440.0, 4620.0, 4920.0, 5520.0, 7320.0, 10300.0], \
				 [29800.0, 29800.0, 29800.0, 29800.0, 29800.0, 29800.0, 29800.0, 29800.0, 29800.0, 29700.0, 29600.0, 29300.0, 28800.0, 4680.0, 4850.0, 5150.0, 5740.0, 7510.0, 10400.0], \
				 [30300.0, 30300.0, 30300.0, 30300.0, 30300.0, 30300.0, 30300.0, 30300.0, 30300.0, 30200.0, 30200.0, 29900.0, 29400.0, 28400.0, 5090.0, 5380.0, 5960.0, 7710.0, 10600.0], \
				 [30900.0, 30900.0, 30900.0, 30900.0, 30900.0, 30800.0, 30800.0, 30800.0, 30800.0, 30800.0, 30700.0, 30400.0, 30000.0, 29100.0, 5340.0, 5620.0, 6190.0, 7920.0, 10800.0], \
				 [31400.0, 31400.0, 31400.0, 31400.0, 31400.0, 31400.0, 31400.0, 31400.0, 31300.0, 31300.0, 31200.0, 31000.0, 30600.0, 29700.0, 5600.0, 5880.0, 6440.0, 8140.0, 11000.0], \
				 [31900.0, 31900.0, 31900.0, 31900.0, 31900.0, 31900.0, 31900.0, 31900.0, 31900.0, 31800.0, 31700.0, 31500.0, 31100.0, 30300.0, 5880.0, 6150.0, 6700.0, 8370.0, 11200.0], \
				 [32400.0, 32400.0, 32400.0, 32400.0, 32400.0, 32400.0, 32400.0, 32400.0, 32400.0, 32300.0, 32300.0, 32100.0, 31700.0, 30900.0, 6180.0, 6440.0, 6970.0, 8620.0, 11400.0], \
				 [32900.0, 32900.0, 32900.0, 32900.0, 32900.0, 32900.0, 32900.0, 32900.0, 32900.0, 32900.0, 32800.0, 32600.0, 32200.0, 31500.0, 6490.0, 6740.0, 7250.0, 8870.0, 11600.0], \
				 [33400.0, 33400.0, 33400.0, 33400.0, 33400.0, 33400.0, 33400.0, 33400.0, 33400.0, 33400.0, 33300.0, 33100.0, 32800.0, 32100.0, 6820.0, 7060.0, 7560.0, 9140.0, 11900.0], \
				 [34000.0, 34000.0, 34000.0, 34000.0, 34000.0, 34000.0, 34000.0, 34000.0, 33900.0, 33900.0, 33800.0, 33700.0, 33300.0, 32700.0, 30400.0, 7400.0, 7870.0, 9420.0, 12100.0], \
				 [34500.0, 34500.0, 34500.0, 34500.0, 34500.0, 34500.0, 34500.0, 34500.0, 34500.0, 34400.0, 34400.0, 34200.0, 33900.0, 33300.0, 31100.0, 7750.0, 8210.0, 9720.0, 12400.0], \
				 [35000.0, 35000.0, 35000.0, 35000.0, 35000.0, 35000.0, 35000.0, 35000.0, 35000.0, 35000.0, 34900.0, 34700.0, 34400.0, 33800.0, 31800.0, 8130.0, 8550.0, 10000.0, 12700.0], \
				 [35500.0, 35500.0, 35500.0, 35500.0, 35500.0, 35500.0, 35500.0, 35500.0, 35500.0, 35500.0, 35400.0, 35300.0, 35000.0, 34400.0, 32500.0, 8530.0, 8920.0, 10300.0, 12900.0], \
				 [36000.0, 36000.0, 36000.0, 36000.0, 36000.0, 36000.0, 36000.0, 36000.0, 36000.0, 36000.0, 35900.0, 35800.0, 35500.0, 35000.0, 33100.0, 8950.0, 9300.0, 10700.0, 13200.0], \
				 [36600.0, 36600.0, 36600.0, 36600.0, 36600.0, 36600.0, 36600.0, 36600.0, 36500.0, 36500.0, 36500.0, 36300.0, 36000.0, 35500.0, 33800.0, 9410.0, 9710.0, 11000.0, 13500.0], \
				 [37100.0, 37100.0, 37100.0, 37100.0, 37100.0, 37100.0, 37100.0, 37100.0, 37100.0, 37000.0, 37000.0, 36800.0, 36600.0, 36100.0, 34400.0, 9900.0, 10100.0, 11300.0, 13800.0], \
				 [37600.0, 37600.0, 37600.0, 37600.0, 37600.0, 37600.0, 37600.0, 37600.0, 37600.0, 37600.0, 37500.0, 37400.0, 37100.0, 36600.0, 35000.0, 31500.0, 10600.0, 11700.0, 14100.0], \
				 [38100.0, 38100.0, 38100.0, 38100.0, 38100.0, 38100.0, 38100.0, 38100.0, 38100.0, 38100.0, 38000.0, 37900.0, 37700.0, 37200.0, 35600.0, 32400.0, 11100.0, 12100.0, 14400.0], \
				 [38600.0, 38600.0, 38600.0, 38600.0, 38600.0, 38600.0, 38600.0, 38600.0, 38600.0, 38600.0, 38600.0, 38400.0, 38200.0, 37700.0, 36200.0, 33200.0, 11600.0, 12500.0, 14800.0], \
				 [39200.0, 39200.0, 39200.0, 39200.0, 39200.0, 39200.0, 39200.0, 39200.0, 39100.0, 39100.0, 39100.0, 38900.0, 38700.0, 38300.0, 36800.0, 33900.0, 12200.0, 12900.0, 15100.0], \
				 [39700.0, 39700.0, 39700.0, 39700.0, 39700.0, 39700.0, 39700.0, 39700.0, 39700.0, 39600.0, 39600.0, 39500.0, 39300.0, 38800.0, 37400.0, 34700.0, 12800.0, 13300.0, 15400.0], \
				 [40200.0, 40200.0, 40200.0, 40200.0, 40200.0, 40200.0, 40200.0, 40200.0, 40200.0, 40200.0, 40100.0, 40000.0, 39800.0, 39400.0, 38000.0, 35400.0, 13500.0, 13700.0, 15800.0], \
				 [40700.0, 40700.0, 40700.0, 40700.0, 40700.0, 40700.0, 40700.0, 40700.0, 40700.0, 40700.0, 40600.0, 40500.0, 40300.0, 39900.0, 38600.0, 36100.0, 14400.0, 14200.0, 16100.0], \
				 [41200.0, 41200.0, 41200.0, 41200.0, 41200.0, 41200.0, 41200.0, 41200.0, 41200.0, 41200.0, 41200.0, 41000.0, 40800.0, 40400.0, 39200.0, 36700.0, 15700.0, 14700.0, 16500.0], \
				 [43800.0, 43800.0, 43800.0, 43800.0, 43800.0, 43800.0, 43800.0, 43800.0, 43800.0, 43800.0, 43800.0, 43700.0, 43500.0, 43100.0, 42000.0, 40000.0, 34600.0, 17400.0, 18500.0], \
				 [46400.0, 46400.0, 46400.0, 46400.0, 46400.0, 46400.0, 46400.0, 46400.0, 46400.0, 46400.0, 46400.0, 46300.0, 46100.0, 45800.0, 44800.0, 43000.0, 38800.0, 21400.0, 20800.0], \
				 [56800.0, 56800.0, 56800.0, 56800.0, 56800.0, 56800.0, 56800.0, 56800.0, 56800.0, 56800.0, 56800.0, 56700.0, 56600.0, 56400.0, 55700.0, 54500.0, 52100.0, 43800.0, 33900.0], \
				 [67200.0, 67200.0, 67200.0, 67200.0, 67200.0, 67200.0, 67200.0, 67200.0, 67200.0, 67200.0, 67200.0, 67100.0, 67000.0, 66900.0, 66400.0, 65500.0, 63800.0, 58500.0, 50400.0], \
				 [93200.0, 93200.0, 93200.0, 93200.0, 93200.0, 93200.0, 93200.0, 93200.0, 93200.0, 93200.0, 93200.0, 93100.0, 93100.0, 93000.0, 92700.0, 92200.0, 91300.0, 88700.0, 84600.0], \
				 [119000.0, 119000.0, 119000.0, 119000.0, 119000.0, 119000.0, 119000.0, 119000.0, 119000.0, 119000.0, 119000.0, 119000.0, 119000.0, 119000.0, 119000.0, 119000.0, 118000.0, 117000.0, 114000.0], \
				 [171000.0, 171000.0, 171000.0, 171000.0, 171000.0, 171000.0, 171000.0, 171000.0, 171000.0, 171000.0, 171000.0, 171000.0, 171000.0, 171000.0, 171000.0, 171000.0, 171000.0, 170000.0, 170000.0], \
				 [223000.0, 223000.0, 223000.0, 223000.0, 223000.0, 223000.0, 223000.0, 223000.0, 223000.0, 223000.0, 223000.0, 223000.0, 223000.0, 223000.0, 223000.0, 223000.0, 223000.0, 223000.0, 223000.0], \
				 [275000.0, 275000.0, 275000.0, 275000.0, 275000.0, 275000.0, 275000.0, 275000.0, 275000.0, 275000.0, 275000.0, 275000.0, 275000.0, 275000.0, 275000.0, 275000.0, 275000.0, 276000.0, 276000.0], \
				 [379000.0, 379000.0, 379000.0, 379000.0, 379000.0, 379000.0, 379000.0, 379000.0, 379000.0, 379000.0, 379000.0, 379000.0, 379000.0, 379000.0, 379000.0, 379000.0, 379000.0, 380000.0, 381000.0], \
				 [535000.0, 535000.0, 535000.0, 535000.0, 535000.0, 535000.0, 535000.0, 535000.0, 535000.0, 535000.0, 535000.0, 535000.0, 535000.0, 535000.0, 535000.0, 535000.0, 535000.0, 536000.0, 537000.0], \
				 [638000.0, 638000.0, 638000.0, 638000.0, 638000.0, 638000.0, 638000.0, 638000.0, 638000.0, 638000.0, 638000.0, 638000.0, 638000.0, 639000.0, 639000.0, 639000.0, 639000.0, 640000.0, 641000.0], \
				 [794000.0, 794000.0, 794000.0, 794000.0, 794000.0, 794000.0, 794000.0, 794000.0, 794000.0, 794000.0, 794000.0, 794000.0, 794000.0, 794000.0, 794000.0, 795000.0, 795000.0, 796000.0, 797000.0], \
				 [1050000.0, 1050000.0, 1050000.0, 1050000.0, 1050000.0, 1050000.0, 1050000.0, 1050000.0, 1050000.0, 1050000.0, 1050000.0, 1050000.0, 1050000.0, 1050000.0, 1050000.0, 1050000.0, 1050000.0, 1060000.0, 1060000.0], \
				 [1310000.0, 1310000.0, 1310000.0, 1310000.0, 1310000.0, 1310000.0, 1310000.0, 1310000.0, 1310000.0, 1310000.0, 1310000.0, 1310000.0, 1310000.0, 1310000.0, 1310000.0, 1310000.0, 1310000.0, 1320000.0, 1320000.0], \
				 [1570000.0, 1570000.0, 1570000.0, 1570000.0, 1570000.0, 1570000.0, 1570000.0, 1570000.0, 1570000.0, 1570000.0, 1570000.0, 1570000.0, 1570000.0, 1570000.0, 1570000.0, 1570000.0, 1570000.0, 1570000.0, 1580000.0], \
				 [1830000.0, 1830000.0, 1830000.0, 1830000.0, 1830000.0, 1830000.0, 1830000.0, 1830000.0, 1830000.0, 1830000.0, 1830000.0, 1830000.0, 1830000.0, 1830000.0, 1830000.0, 1830000.0, 1830000.0, 1830000.0, 1840000.0], \
				 [2090000.0, 2090000.0, 2090000.0, 2090000.0, 2090000.0, 2090000.0, 2090000.0, 2090000.0, 2090000.0, 2090000.0, 2090000.0, 2090000.0, 2090000.0, 2090000.0, 2090000.0, 2090000.0, 2090000.0, 2090000.0, 2100000.0]]
    

    ################## FUNCTION ###############################################
    
    function = scipy.interpolate.RectBivariateSpline(data_temperature, data_pressure, data)

    result = function(temperature,pressure)[0][0]
    
    if unit == 'kg':
        return result
    
    if unit == 'mol':
        return result*molar_mass()
    
#%% 
def entropy(temperature,pressure,unit):
    
    """
    ========== DESCRIPTION ==========

    This function return the entropy of pure Helium 4

    ========== VALIDITY ==========

    <temperature> : [0.8 -> 400]
    <pressure> : [1 -> 1e6] 

    ========== FROM ==========

    HEPAK was written by Vincent Arp, Bob McCarty, and Jeff Fox, formerly of 
    NIST and later of Cryodata, using code from Brian Hands while at the 
    Oxford University Cryogenics Laboratory.


    ========== INPUT ==========

    <temperature>
        -- float --
        The temperature of pure helium 4
        [K]

    <pressure>
        -- float --
        The pressure of pure helium 4
        [Pa]
        
    <unit>
        -- string --
        Either kg or mol

    ========== OUTPUT ==========

    <entropy>
        -- float --
        The entropy of pure helium 4
        if 'kg' : [J].[kg]**(-1).[K]**(-1)
        if 'mol' : [J].[mol]**(-1).[K]**(-1)

    ========== STATUS ==========

    Status : Checked 2024-02-27
    
    ========== UPDATE ==========
    

    """
    
    ################## PACKAGES ###############################################
    
    import scipy.interpolate
    import numpy
    
    ################## CONDITIONS #############################################
    
    assert temperature >= 0.8 and temperature <= 400 , 'The function helium4.entropy is not valid for T = ' + str(temperature) + ' K'
    assert pressure >= 1 and pressure <=  1e6, 'The function helium4.entropy  is not valid for P = ' + str(pressure) + ' Pa'
    
    ################## INITIALISATION #########################################
    
    data_temperature = numpy.array([0.8,0.9,1,1.1,1.2,1.3,1.4,1.5,1.6,1.7,1.8,1.9,2,2.1,2.2,2.3,2.4,2.5,2.6,2.7,2.8,2.9,3,3.1,3.2,3.3,3.4,3.5,3.6,3.7,3.8,3.9,4,4.1,4.2,4.3,4.4,4.5,4.6,4.7,4.8,4.9,5,5.5,6,8,10,15,20,30,40,50,70,100,120,150,200,250,300,350,400])
    data_pressure = numpy.array([1, 2, 5, 1e1, 2e1, 5e1, 1e2, 2e2, 5e2, 1e3, 2e3, 5e3, 1e4, 2e4, 5e4, 1e5, 2e5, 5e5, 1e6])
    data =		[[24700.0, 4.71, 4.71, 4.71, 4.71, 4.71, 4.71, 4.71, 4.71, 4.71, 4.71, 4.7, 4.68, 4.65, 4.54, 4.34, 3.98, 3.49, 3.98], \
				 [25400.0, 23900.0, 22000.0, 8.75, 8.75, 8.75, 8.75, 8.75, 8.75, 8.75, 8.74, 8.73, 8.72, 8.69, 8.6, 8.43, 8.07, 7.51, 9.46], \
				 [25900.0, 24500.0, 22600.0, 21100.0, 16.3, 16.3, 16.3, 16.3, 16.3, 16.3, 16.3, 16.3, 16.3, 16.3, 16.3, 16.2, 16.0, 15.7, 19.7], \
				 [26400.0, 25000.0, 23100.0, 21600.0, 20200.0, 29.6, 29.6, 29.6, 29.6, 29.6, 29.6, 29.6, 29.6, 29.6, 29.6, 29.7, 29.7, 30.2, 36.9], \
				 [26900.0, 25400.0, 23500.0, 22100.0, 20600.0, 18700.0, 51.0, 51.0, 51.0, 51.0, 51.0, 51.0, 51.0, 51.0, 51.2, 51.4, 51.8, 53.6, 63.8], \
				 [27300.0, 25800.0, 23900.0, 22500.0, 21000.0, 19100.0, 17700.0, 83.6, 83.6, 83.6, 83.6, 83.6, 83.6, 83.7, 84.0, 84.4, 85.3, 89.0, 104.0], \
				 [27700.0, 26200.0, 24300.0, 22900.0, 21400.0, 19500.0, 18100.0, 16600.0, 131.0, 131.0, 131.0, 131.0, 131.0, 131.0, 131.0, 132.0, 134.0, 140.0, 160.0], \
				 [28000.0, 26600.0, 24700.0, 23200.0, 21800.0, 19900.0, 18400.0, 17000.0, 196.0, 196.0, 196.0, 196.0, 196.0, 197.0, 197.0, 198.0, 200.0, 210.0, 236.0], \
				 [28300.0, 26900.0, 25000.0, 23600.0, 22100.0, 20200.0, 18800.0, 17300.0, 15400.0, 284.0, 284.0, 284.0, 284.0, 284.0, 285.0, 286.0, 290.0, 303.0, 337.0], \
				 [28700.0, 27200.0, 25300.0, 23900.0, 22400.0, 20500.0, 19100.0, 17600.0, 15700.0, 14200.0, 398.0, 398.0, 398.0, 399.0, 400.0, 401.0, 406.0, 425.0, 468.0], \
				 [29000.0, 27500.0, 25600.0, 24200.0, 22700.0, 20800.0, 19400.0, 17900.0, 16000.0, 14500.0, 544.0, 544.0, 544.0, 544.0, 546.0, 548.0, 554.0, 579.0, 635.0], \
				 [29200.0, 27800.0, 25900.0, 24500.0, 23000.0, 21100.0, 19700.0, 18200.0, 16300.0, 14800.0, 13300.0, 727.0, 727.0, 728.0, 730.0, 733.0, 741.0, 774.0, 849.0], \
				 [29500.0, 28100.0, 26200.0, 24700.0, 23300.0, 21400.0, 19900.0, 18500.0, 16600.0, 15100.0, 13600.0, 958.0, 958.0, 959.0, 961.0, 966.0, 977.0, 1020.0, 1130.0], \
				 [29800.0, 28300.0, 26400.0, 25000.0, 23500.0, 21600.0, 20200.0, 18700.0, 16800.0, 15400.0, 13900.0, 1260.0, 1260.0, 1260.0, 1260.0, 1270.0, 1280.0, 1350.0, 1460.0], \
				 [30000.0, 28600.0, 26700.0, 25200.0, 23800.0, 21900.0, 20400.0, 19000.0, 17100.0, 15600.0, 14100.0, 12100.0, 1640.0, 1640.0, 1630.0, 1630.0, 1620.0, 1600.0, 1570.0], \
				 [30200.0, 28800.0, 26900.0, 25400.0, 24000.0, 22100.0, 20700.0, 19200.0, 17300.0, 15800.0, 14400.0, 12300.0, 1780.0, 1780.0, 1770.0, 1760.0, 1750.0, 1710.0, 1660.0], \
				 [30500.0, 29000.0, 27100.0, 25700.0, 24200.0, 22300.0, 20900.0, 19400.0, 17500.0, 16100.0, 14600.0, 12600.0, 1890.0, 1880.0, 1880.0, 1870.0, 1850.0, 1800.0, 1730.0], \
				 [30700.0, 29200.0, 27300.0, 25900.0, 24400.0, 22500.0, 21100.0, 19700.0, 17700.0, 16300.0, 14800.0, 12800.0, 11200.0, 1980.0, 1970.0, 1960.0, 1930.0, 1880.0, 1800.0], \
				 [30900.0, 29400.0, 27500.0, 26100.0, 24600.0, 22700.0, 21300.0, 19900.0, 17900.0, 16500.0, 15000.0, 13000.0, 11500.0, 2070.0, 2060.0, 2040.0, 2020.0, 1950.0, 1870.0], \
				 [31100.0, 29600.0, 27700.0, 26300.0, 24800.0, 22900.0, 21500.0, 20100.0, 18100.0, 16700.0, 15200.0, 13300.0, 11700.0, 2150.0, 2140.0, 2130.0, 2100.0, 2020.0, 1930.0], \
				 [31300.0, 29800.0, 27900.0, 26500.0, 25000.0, 23100.0, 21700.0, 20200.0, 18300.0, 16900.0, 15400.0, 13500.0, 11900.0, 2240.0, 2230.0, 2210.0, 2180.0, 2090.0, 2000.0], \
				 [31400.0, 30000.0, 28100.0, 26700.0, 25200.0, 23300.0, 21900.0, 20400.0, 18500.0, 17100.0, 15600.0, 13700.0, 12100.0, 10500.0, 2310.0, 2290.0, 2250.0, 2160.0, 2060.0], \
				 [31600.0, 30200.0, 28300.0, 26800.0, 25400.0, 23500.0, 22000.0, 20600.0, 18700.0, 17200.0, 15800.0, 13800.0, 12300.0, 10700.0, 2400.0, 2370.0, 2330.0, 2240.0, 2120.0], \
				 [31800.0, 30300.0, 28400.0, 27000.0, 25600.0, 23700.0, 22200.0, 20800.0, 18900.0, 17400.0, 16000.0, 14000.0, 12500.0, 10900.0, 2480.0, 2460.0, 2410.0, 2310.0, 2180.0], \
				 [31900.0, 30500.0, 28600.0, 27200.0, 25700.0, 23800.0, 22400.0, 20900.0, 19000.0, 17600.0, 16100.0, 14200.0, 12700.0, 11100.0, 2570.0, 2540.0, 2490.0, 2380.0, 2250.0], \
				 [32100.0, 30700.0, 28800.0, 27300.0, 25900.0, 24000.0, 22500.0, 21100.0, 19200.0, 17700.0, 16300.0, 14400.0, 12800.0, 11300.0, 2660.0, 2630.0, 2580.0, 2460.0, 2320.0], \
				 [32300.0, 30800.0, 28900.0, 27500.0, 26000.0, 24100.0, 22700.0, 21300.0, 19300.0, 17900.0, 16400.0, 14500.0, 13000.0, 11400.0, 2750.0, 2720.0, 2660.0, 2530.0, 2380.0], \
				 [32400.0, 31000.0, 29100.0, 27600.0, 26200.0, 24300.0, 22800.0, 21400.0, 19500.0, 18100.0, 16600.0, 14700.0, 13200.0, 11600.0, 2850.0, 2810.0, 2750.0, 2610.0, 2450.0], \
				 [32600.0, 31100.0, 29200.0, 27800.0, 26300.0, 24400.0, 23000.0, 21600.0, 19600.0, 18200.0, 16700.0, 14800.0, 13300.0, 11800.0, 9480.0, 2910.0, 2840.0, 2690.0, 2520.0], \
				 [32700.0, 31300.0, 29400.0, 27900.0, 26500.0, 24600.0, 23100.0, 21700.0, 19800.0, 18300.0, 16900.0, 15000.0, 13500.0, 11900.0, 9680.0, 3010.0, 2930.0, 2770.0, 2590.0], \
				 [32800.0, 31400.0, 29500.0, 28100.0, 26600.0, 24700.0, 23300.0, 21800.0, 19900.0, 18500.0, 17000.0, 15100.0, 13600.0, 12100.0, 9860.0, 3110.0, 3020.0, 2850.0, 2670.0], \
				 [33000.0, 31500.0, 29600.0, 28200.0, 26800.0, 24800.0, 23400.0, 22000.0, 20100.0, 18600.0, 17200.0, 15200.0, 13800.0, 12200.0, 10000.0, 3210.0, 3120.0, 2930.0, 2740.0], \
				 [33100.0, 31700.0, 29800.0, 28300.0, 26900.0, 25000.0, 23500.0, 22100.0, 20200.0, 18700.0, 17300.0, 15400.0, 13900.0, 12400.0, 10200.0, 3320.0, 3220.0, 3020.0, 2810.0], \
				 [33200.0, 31800.0, 29900.0, 28500.0, 27000.0, 25100.0, 23700.0, 22200.0, 20300.0, 18900.0, 17400.0, 15500.0, 14000.0, 12500.0, 10400.0, 3430.0, 3320.0, 3100.0, 2880.0], \
				 [33400.0, 31900.0, 30000.0, 28600.0, 27100.0, 25200.0, 23800.0, 22400.0, 20400.0, 19000.0, 17600.0, 15600.0, 14200.0, 12600.0, 10500.0, 3550.0, 3420.0, 3180.0, 2950.0], \
				 [33500.0, 32000.0, 30100.0, 28700.0, 27300.0, 25400.0, 23900.0, 22500.0, 20600.0, 19100.0, 17700.0, 15800.0, 14300.0, 12800.0, 10600.0, 8680.0, 3530.0, 3270.0, 3030.0], \
				 [33600.0, 32200.0, 30300.0, 28800.0, 27400.0, 25500.0, 24000.0, 22600.0, 20700.0, 19200.0, 17800.0, 15900.0, 14400.0, 12900.0, 10800.0, 8870.0, 3640.0, 3350.0, 3100.0], \
				 [33700.0, 32300.0, 30400.0, 28900.0, 27500.0, 25600.0, 24200.0, 22700.0, 20800.0, 19400.0, 17900.0, 16000.0, 14500.0, 13000.0, 10900.0, 9050.0, 3750.0, 3440.0, 3170.0], \
				 [33800.0, 32400.0, 30500.0, 29000.0, 27600.0, 25700.0, 24300.0, 22800.0, 20900.0, 19500.0, 18000.0, 16100.0, 14600.0, 13100.0, 11100.0, 9220.0, 3880.0, 3530.0, 3240.0], \
				 [33900.0, 32500.0, 30600.0, 29200.0, 27700.0, 25800.0, 24400.0, 22900.0, 21000.0, 19600.0, 18100.0, 16200.0, 14800.0, 13300.0, 11200.0, 9370.0, 4020.0, 3620.0, 3320.0], \
				 [34100.0, 32600.0, 30700.0, 29300.0, 27800.0, 25900.0, 24500.0, 23000.0, 21100.0, 19700.0, 18300.0, 16300.0, 14900.0, 13400.0, 11300.0, 9520.0, 4170.0, 3710.0, 3390.0], \
				 [34200.0, 32700.0, 30800.0, 29400.0, 27900.0, 26000.0, 24600.0, 23200.0, 21200.0, 19800.0, 18400.0, 16400.0, 15000.0, 13500.0, 11400.0, 9670.0, 4350.0, 3810.0, 3470.0], \
				 [34300.0, 32800.0, 30900.0, 29500.0, 28000.0, 26100.0, 24700.0, 23300.0, 21400.0, 19900.0, 18500.0, 16500.0, 15100.0, 13600.0, 11500.0, 9800.0, 4610.0, 3900.0, 3540.0], \
				 [34800.0, 33300.0, 31400.0, 30000.0, 28500.0, 26600.0, 25200.0, 23800.0, 21800.0, 20400.0, 19000.0, 17000.0, 15600.0, 14100.0, 12100.0, 10400.0, 8310.0, 4430.0, 3920.0], \
				 [35200.0, 33800.0, 31900.0, 30400.0, 29000.0, 27100.0, 25600.0, 24200.0, 22300.0, 20900.0, 19400.0, 17500.0, 16000.0, 14600.0, 12600.0, 11000.0, 9060.0, 5120.0, 4310.0], \
				 [36700.0, 35300.0, 33400.0, 31900.0, 30500.0, 28600.0, 27100.0, 25700.0, 23800.0, 22400.0, 20900.0, 19000.0, 17600.0, 16100.0, 14100.0, 12600.0, 11000.0, 8370.0, 6180.0], \
				 [37900.0, 36400.0, 34500.0, 33100.0, 31600.0, 29700.0, 28300.0, 26900.0, 25000.0, 23500.0, 22100.0, 20200.0, 18700.0, 17300.0, 15300.0, 13800.0, 12300.0, 10000.0, 8020.0], \
				 [40000.0, 38500.0, 36600.0, 35200.0, 33700.0, 31800.0, 30400.0, 29000.0, 27100.0, 25600.0, 24200.0, 22300.0, 20800.0, 19400.0, 17500.0, 16000.0, 14500.0, 12500.0, 10800.0], \
				 [41500.0, 40000.0, 38100.0, 36700.0, 35200.0, 33300.0, 31900.0, 30500.0, 28600.0, 27100.0, 25700.0, 23800.0, 22300.0, 20900.0, 19000.0, 17500.0, 16100.0, 14100.0, 12500.0], \
				 [43600.0, 42100.0, 40200.0, 38800.0, 37300.0, 35400.0, 34000.0, 32600.0, 30700.0, 29200.0, 27800.0, 25900.0, 24400.0, 23000.0, 21100.0, 19600.0, 18200.0, 16300.0, 14800.0], \
				 [45100.0, 43600.0, 41700.0, 40300.0, 38800.0, 36900.0, 35500.0, 34100.0, 32200.0, 30700.0, 29300.0, 27400.0, 25900.0, 24500.0, 22600.0, 21100.0, 19700.0, 17800.0, 16300.0], \
				 [46200.0, 44800.0, 42900.0, 41400.0, 40000.0, 38100.0, 36700.0, 35200.0, 33300.0, 31900.0, 30400.0, 28500.0, 27100.0, 25600.0, 23700.0, 22300.0, 20900.0, 18900.0, 17500.0], \
				 [48000.0, 46500.0, 44600.0, 43200.0, 41700.0, 39800.0, 38400.0, 37000.0, 35100.0, 33600.0, 32200.0, 30300.0, 28800.0, 27400.0, 25500.0, 24100.0, 22600.0, 20700.0, 19300.0], \
				 [49800.0, 48400.0, 46500.0, 45000.0, 43600.0, 41700.0, 40300.0, 38800.0, 36900.0, 35500.0, 34000.0, 32100.0, 30700.0, 29200.0, 27300.0, 25900.0, 24500.0, 22600.0, 21100.0], \
				 [50800.0, 49300.0, 47400.0, 46000.0, 44500.0, 42600.0, 41200.0, 39800.0, 37900.0, 36400.0, 35000.0, 33100.0, 31600.0, 30200.0, 28300.0, 26900.0, 25400.0, 23500.0, 22100.0], \
				 [51900.0, 50500.0, 48600.0, 47100.0, 45700.0, 43800.0, 42400.0, 40900.0, 39000.0, 37600.0, 36100.0, 34200.0, 32800.0, 31400.0, 29500.0, 28000.0, 26600.0, 24700.0, 23200.0], \
				 [53400.0, 52000.0, 50100.0, 48600.0, 47200.0, 45300.0, 43900.0, 42400.0, 40500.0, 39100.0, 37600.0, 35700.0, 34300.0, 32800.0, 30900.0, 29500.0, 28100.0, 26200.0, 24700.0], \
				 [54600.0, 53100.0, 51200.0, 49800.0, 48400.0, 46500.0, 45000.0, 43600.0, 41700.0, 40200.0, 38800.0, 36900.0, 35400.0, 34000.0, 32100.0, 30700.0, 29200.0, 27300.0, 25900.0], \
				 [55500.0, 54100.0, 52200.0, 50700.0, 49300.0, 47400.0, 46000.0, 44500.0, 42600.0, 41200.0, 39700.0, 37800.0, 36400.0, 35000.0, 33100.0, 31600.0, 30200.0, 28300.0, 26800.0], \
				 [56300.0, 54900.0, 53000.0, 51500.0, 50100.0, 48200.0, 46800.0, 45300.0, 43400.0, 42000.0, 40500.0, 38600.0, 37200.0, 35800.0, 33900.0, 32400.0, 31000.0, 29100.0, 27600.0], \
				 [57000.0, 55600.0, 53700.0, 52200.0, 50800.0, 48900.0, 47500.0, 46000.0, 44100.0, 42700.0, 41200.0, 39300.0, 37900.0, 36400.0, 34500.0, 33100.0, 31700.0, 29800.0, 28300.0]]
    
    ################## FUNCTION ###############################################
    
    function = scipy.interpolate.RectBivariateSpline(data_temperature, data_pressure, data)

    result = function(temperature,pressure)[0][0]
    
    if unit == 'kg':
        return result
    
    if unit == 'mol':
        return result*molar_mass()

#%% 
def gibbs_energy(temperature,pressure,unit):
    
    """
    ========== DESCRIPTION ==========

    This function return the gibbs energy of pure Helium 4

    ========== VALIDITY ==========

    <temperature> : [0.8 -> 400]
    <pressure> : [1 -> 1e6] 

    ========== FROM ==========

    HEPAK was written by Vincent Arp, Bob McCarty, and Jeff Fox, formerly of 
    NIST and later of Cryodata, using code from Brian Hands while at the 
    Oxford University Cryogenics Laboratory.


    ========== INPUT ==========

    <temperature>
        -- float --
        The temperature of pure helium 4
        [K]

    <pressure>
        -- float --
        The pressure of pure helium 4
        [Pa]
        
    <unit>
        -- string --
        Either kg or mol

    ========== OUTPUT ==========

    <gibbs_energy>
        -- float --
        The gibbs energy of pure helium 4
        if 'kg' : [J].[kg]**(-1)
        if 'mol' : [J].[mol]**(-1)

    ========== STATUS ==========

    Status : Checked 2024-02-27
    
    ========== UPDATE ==========
    

    """
    
    ################## PACKAGES ###############################################
    
    import scipy.interpolate
    import numpy
    
    ################## CONDITIONS #############################################
    
    assert temperature >= 0.8 and temperature <= 400 , 'The function helium4.gibbs_energy is not valid for T = ' + str(temperature) + ' K'
    assert pressure >= 1 and pressure <=  1e6, 'The function helium4.gibbs_energy  is not valid for P = ' + str(pressure) + ' Pa'
    
    ################## INITIALISATION #########################################
    
    data_temperature = numpy.array([0.8,0.9,1,1.1,1.2,1.3,1.4,1.5,1.6,1.7,1.8,1.9,2,2.1,2.2,2.3,2.4,2.5,2.6,2.7,2.8,2.9,3,3.1,3.2,3.3,3.4,3.5,3.6,3.7,3.8,3.9,4,4.1,4.2,4.3,4.4,4.5,4.6,4.7,4.8,4.9,5,5.5,6,8,10,15,20,30,40,50,70,100,120,150,200,250,300,350,400])
    data_pressure = numpy.array([1, 2, 5, 1e1, 2e1, 5e1, 1e2, 2e2, 5e2, 1e3, 2e3, 5e3, 1e4, 2e4, 5e4, 1e5, 2e5, 5e5, 1e6])
    data =		[[-371.0, -1.89, -1.87, -1.83, -1.77, -1.56, -1.21, -0.526, 1.54, 4.98, 11.9, 32.5, 66.9, 136.0, 341.0, 683.0, 1360.0, 3350.0, 6560.0], \
				 [-2880.0, -1580.0, 130.0, -2.49, -2.42, -2.21, -1.87, -1.18, 0.89, 4.33, 11.2, 31.9, 66.3, 135.0, 341.0, 682.0, 1360.0, 3350.0, 6560.0], \
				 [-5440.0, -4000.0, -2100.0, -661.0, -3.63, -3.43, -3.08, -2.39, -0.327, 3.12, 10.0, 30.7, 65.1, 134.0, 340.0, 681.0, 1360.0, 3350.0, 6560.0], \
				 [-8060.0, -6470.0, -4380.0, -2800.0, -1220.0, -5.66, -5.32, -4.63, -2.56, 0.879, 7.77, 28.4, 62.8, 132.0, 337.0, 679.0, 1360.0, 3350.0, 6560.0], \
				 [-10700.0, -8990.0, -6710.0, -4980.0, -3260.0, -979.0, -9.27, -8.58, -6.51, -3.07, 3.82, 24.5, 58.9, 128.0, 333.0, 675.0, 1350.0, 3340.0, 6550.0], \
				 [-13400.0, -11600.0, -9080.0, -7210.0, -5340.0, -2870.0, -1010.0, -15.2, -13.1, -9.69, -2.8, 17.9, 52.3, 121.0, 327.0, 668.0, 1350.0, 3340.0, 6540.0], \
				 [-16200.0, -14200.0, -11500.0, -9480.0, -7460.0, -4800.0, -2790.0, -793.0, -23.7, -20.3, -13.4, 7.27, 41.7, 110.0, 316.0, 657.0, 1330.0, 3320.0, 6530.0], \
				 [-19000.0, -16800.0, -13900.0, -11800.0, -9620.0, -6770.0, -4620.0, -2470.0, -39.9, -36.5, -29.6, -8.92, 25.5, 94.2, 300.0, 641.0, 1320.0, 3310.0, 6510.0], \
				 [-21800.0, -19500.0, -16400.0, -14100.0, -11800.0, -8780.0, -6480.0, -4190.0, -1170.0, -60.3, -53.4, -32.7, 1.66, 70.4, 276.0, 617.0, 1290.0, 3280.0, 6480.0], \
				 [-24600.0, -22200.0, -18900.0, -16500.0, -14000.0, -10800.0, -8370.0, -5930.0, -2720.0, -323.0, -87.2, -66.6, -32.2, 36.5, 242.0, 583.0, 1260.0, 3250.0, 6440.0], \
				 [-27500.0, -24900.0, -21500.0, -18900.0, -16300.0, -12900.0, -10300.0, -7710.0, -4310.0, -1760.0, -134.0, -113.0, -79.1, -10.4, 195.0, 536.0, 1210.0, 3200.0, 6390.0], \
				 [-30400.0, -27700.0, -24100.0, -21300.0, -18600.0, -15000.0, -12200.0, -9520.0, -5920.0, -3230.0, -564.0, -177.0, -142.0, -73.7, 132.0, 472.0, 1150.0, 3130.0, 6310.0], \
				 [-33400.0, -30500.0, -26700.0, -23800.0, -20900.0, -17100.0, -14200.0, -11400.0, -7570.0, -4720.0, -1910.0, -260.0, -226.0, -158.0, 47.5, 388.0, 1060.0, 3040.0, 6210.0], \
				 [-36300.0, -33300.0, -29300.0, -26300.0, -23200.0, -19300.0, -16200.0, -13200.0, -9240.0, -6240.0, -3280.0, -370.0, -336.0, -268.0, -62.9, 277.0, 949.0, 2920.0, 6080.0], \
				 [-39300.0, -36100.0, -31900.0, -28800.0, -25600.0, -21400.0, -18300.0, -15100.0, -10900.0, -7790.0, -4680.0, -662.0, -482.0, -413.0, -209.0, 130.0, 801.0, 2770.0, 5930.0], \
				 [-42300.0, -39000.0, -34600.0, -31300.0, -28000.0, -23600.0, -20300.0, -17000.0, -12700.0, -9360.0, -6100.0, -1880.0, -653.0, -584.0, -380.0, -40.1, 632.0, 2600.0, 5770.0], \
				 [-45400.0, -41900.0, -37300.0, -33900.0, -30400.0, -25800.0, -22400.0, -18900.0, -14400.0, -11000.0, -7550.0, -3130.0, -836.0, -768.0, -562.0, -222.0, 452.0, 2430.0, 5600.0], \
				 [-48400.0, -44800.0, -40000.0, -36400.0, -32900.0, -28100.0, -24500.0, -20900.0, -16200.0, -12600.0, -9020.0, -4400.0, -1030.0, -961.0, -755.0, -413.0, 263.0, 2240.0, 5420.0], \
				 [-51500.0, -47700.0, -42800.0, -39000.0, -35300.0, -30400.0, -26600.0, -22900.0, -17900.0, -14200.0, -10500.0, -5690.0, -2170.0, -1160.0, -956.0, -613.0, 65.6, 2050.0, 5240.0], \
				 [-54600.0, -50700.0, -45600.0, -41700.0, -37800.0, -32600.0, -28800.0, -24900.0, -19700.0, -15900.0, -12000.0, -7010.0, -3320.0, -1370.0, -1170.0, -821.0, -140.0, 1850.0, 5050.0], \
				 [-57700.0, -53700.0, -48300.0, -44300.0, -40300.0, -34900.0, -30900.0, -26900.0, -21600.0, -17600.0, -13600.0, -8340.0, -4500.0, -1590.0, -1380.0, -1040.0, -354.0, 1650.0, 4850.0], \
				 [-60800.0, -56700.0, -51100.0, -47000.0, -42800.0, -37300.0, -33100.0, -28900.0, -23400.0, -19300.0, -15100.0, -9700.0, -5710.0, -1900.0, -1610.0, -1260.0, -575.0, 1430.0, 4640.0], \
				 [-64000.0, -59700.0, -54000.0, -49600.0, -45300.0, -39600.0, -35300.0, -31000.0, -25300.0, -21000.0, -16700.0, -11100.0, -6930.0, -2960.0, -1850.0, -1500.0, -804.0, 1210.0, 4440.0], \
				 [-67200.0, -62700.0, -56800.0, -52300.0, -47900.0, -42000.0, -37500.0, -33000.0, -27100.0, -22700.0, -18300.0, -12500.0, -8170.0, -4040.0, -2090.0, -1740.0, -1040.0, 987.0, 4220.0], \
				 [-70300.0, -65700.0, -59600.0, -55000.0, -50400.0, -44300.0, -39700.0, -35100.0, -29000.0, -24500.0, -19900.0, -13900.0, -9430.0, -5140.0, -2340.0, -1990.0, -1290.0, 753.0, 4000.0], \
				 [-73500.0, -68800.0, -62500.0, -57800.0, -53000.0, -46700.0, -42000.0, -37200.0, -31000.0, -26200.0, -21500.0, -15300.0, -10700.0, -6260.0, -2600.0, -2250.0, -1540.0, 511.0, 3770.0], \
				 [-76800.0, -71900.0, -65400.0, -60500.0, -55600.0, -49100.0, -44200.0, -39300.0, -32900.0, -28000.0, -23100.0, -16700.0, -12000.0, -7390.0, -2880.0, -2510.0, -1800.0, 261.0, 3540.0], \
				 [-80000.0, -75000.0, -68300.0, -63300.0, -58200.0, -51600.0, -46500.0, -41500.0, -34800.0, -29800.0, -24800.0, -18200.0, -13300.0, -8540.0, -3160.0, -2790.0, -2070.0, 4.03, 3290.0], \
				 [-83200.0, -78100.0, -71200.0, -66000.0, -60800.0, -54000.0, -48800.0, -43600.0, -36800.0, -31600.0, -26500.0, -19700.0, -14600.0, -9710.0, -3720.0, -3080.0, -2350.0, -261.0, 3040.0], \
				 [-86500.0, -81200.0, -74100.0, -68800.0, -63500.0, -56400.0, -51100.0, -45800.0, -38800.0, -33400.0, -28100.0, -21200.0, -16000.0, -10900.0, -4680.0, -3370.0, -2640.0, -534.0, 2790.0], \
				 [-89800.0, -84300.0, -77100.0, -71600.0, -66100.0, -58900.0, -53400.0, -48000.0, -40700.0, -35300.0, -29800.0, -22700.0, -17300.0, -12100.0, -5650.0, -3680.0, -2940.0, -815.0, 2530.0], \
				 [-93100.0, -87500.0, -80000.0, -74400.0, -68800.0, -61400.0, -55800.0, -50200.0, -42700.0, -37100.0, -31500.0, -24200.0, -18700.0, -13300.0, -6650.0, -3990.0, -3250.0, -1100.0, 2260.0], \
				 [-96400.0, -90600.0, -83000.0, -77200.0, -71500.0, -63900.0, -58100.0, -52400.0, -44800.0, -39000.0, -33300.0, -25700.0, -20100.0, -14500.0, -7660.0, -4320.0, -3560.0, -1400.0, 1980.0], \
				 [-99700.0, -93800.0, -86000.0, -80100.0, -74200.0, -66400.0, -60500.0, -54600.0, -46800.0, -40900.0, -35000.0, -27300.0, -21500.0, -15800.0, -8690.0, -4660.0, -3890.0, -1710.0, 1690.0], \
				 [-103000.0, -97000.0, -89000.0, -82900.0, -76900.0, -68900.0, -62800.0, -56800.0, -48800.0, -42800.0, -36800.0, -28800.0, -22900.0, -17100.0, -9730.0, -5010.0, -4230.0, -2020.0, 1400.0], \
				 [-106000.0, -100000.0, -92000.0, -85800.0, -79600.0, -71400.0, -65200.0, -59000.0, -50900.0, -44700.0, -38500.0, -30400.0, -24300.0, -18300.0, -10800.0, -5780.0, -4570.0, -2340.0, 1100.0], \
				 [-110000.0, -103000.0, -95000.0, -88700.0, -82300.0, -74000.0, -67600.0, -61300.0, -52900.0, -46600.0, -40300.0, -32000.0, -25700.0, -19600.0, -11900.0, -6660.0, -4930.0, -2680.0, 797.0], \
				 [-113000.0, -107000.0, -98000.0, -91600.0, -85100.0, -76500.0, -70000.0, -63600.0, -55000.0, -48500.0, -42100.0, -33600.0, -27200.0, -20900.0, -12900.0, -7560.0, -5300.0, -3020.0, 483.0], \
				 [-116000.0, -110000.0, -101000.0, -94500.0, -87800.0, -79100.0, -72500.0, -65800.0, -57100.0, -50500.0, -43900.0, -35200.0, -28600.0, -22200.0, -14000.0, -8470.0, -5680.0, -3360.0, 163.0], \
				 [-120000.0, -113000.0, -104000.0, -97400.0, -90600.0, -81700.0, -74900.0, -68100.0, -59200.0, -52400.0, -45700.0, -36800.0, -30100.0, -23500.0, -15200.0, -9400.0, -6080.0, -3720.0, -166.0], \
				 [-123000.0, -116000.0, -107000.0, -100000.0, -93400.0, -84200.0, -77300.0, -70400.0, -61300.0, -54400.0, -47500.0, -38400.0, -31600.0, -24900.0, -16300.0, -10300.0, -6490.0, -4090.0, -501.0], \
				 [-127000.0, -120000.0, -110000.0, -103000.0, -96200.0, -86800.0, -79800.0, -72700.0, -63400.0, -56400.0, -49300.0, -40100.0, -33100.0, -26200.0, -17400.0, -11300.0, -6910.0, -4460.0, -844.0], \
				 [-130000.0, -123000.0, -113000.0, -106000.0, -99000.0, -89500.0, -82300.0, -75100.0, -65500.0, -58400.0, -51200.0, -41700.0, -34600.0, -27600.0, -18600.0, -12300.0, -7360.0, -4850.0, -1190.0], \
				 [-147000.0, -139000.0, -129000.0, -121000.0, -113000.0, -103000.0, -94700.0, -86800.0, -76300.0, -68400.0, -60500.0, -50100.0, -42300.0, -34500.0, -24500.0, -17300.0, -11100.0, -6930.0, -3060.0], \
				 [-165000.0, -156000.0, -145000.0, -136000.0, -127000.0, -116000.0, -107000.0, -98800.0, -87400.0, -78800.0, -70100.0, -58700.0, -50200.0, -41700.0, -30600.0, -22700.0, -15500.0, -9300.0, -5110.0], \
				 [-237000.0, -225000.0, -210000.0, -199000.0, -187000.0, -172000.0, -160000.0, -149000.0, -134000.0, -122000.0, -111000.0, -95300.0, -83900.0, -72400.0, -57400.0, -46400.0, -35700.0, -23200.0, -15500.0], \
				 [-311000.0, -297000.0, -278000.0, -264000.0, -249000.0, -230000.0, -216000.0, -201000.0, -182000.0, -168000.0, -154000.0, -135000.0, -120000.0, -106000.0, -87000.0, -72900.0, -59000.0, -41700.0, -29800.0], \
				 [-506000.0, -485000.0, -456000.0, -435000.0, -413000.0, -384000.0, -363000.0, -341000.0, -313000.0, -291000.0, -270000.0, -241000.0, -219000.0, -198000.0, -169000.0, -148000.0, -126000.0, -98400.0, -77600.0], \
				 [-710000.0, -681000.0, -643000.0, -614000.0, -586000.0, -548000.0, -519000.0, -490000.0, -452000.0, -423000.0, -394000.0, -356000.0, -327000.0, -299000.0, -261000.0, -232000.0, -203000.0, -165000.0, -136000.0], \
				 [-1140000.0, -1090000.0, -1040000.0, -993000.0, -949000.0, -892000.0, -849000.0, -806000.0, -749000.0, -706000.0, -662000.0, -605000.0, -562000.0, -519000.0, -462000.0, -418000.0, -375000.0, -318000.0, -274000.0], \
				 [-1580000.0, -1520000.0, -1450000.0, -1390000.0, -1330000.0, -1250000.0, -1200000.0, -1140000.0, -1060000.0, -1010000.0, -948000.0, -872000.0, -814000.0, -757000.0, -680000.0, -623000.0, -565000.0, -488000.0, -429000.0], \
				 [-2040000.0, -1960000.0, -1870000.0, -1800000.0, -1730000.0, -1630000.0, -1560000.0, -1490000.0, -1390000.0, -1320000.0, -1250000.0, -1150000.0, -1080000.0, -1010000.0, -912000.0, -840000.0, -768000.0, -672000.0, -599000.0], \
				 [-2980000.0, -2880000.0, -2750000.0, -2640000.0, -2540000.0, -2410000.0, -2310000.0, -2210000.0, -2080000.0, -1970000.0, -1870000.0, -1740000.0, -1640000.0, -1540000.0, -1410000.0, -1300000.0, -1200000.0, -1070000.0, -967000.0], \
				 [-4450000.0, -4300000.0, -4110000.0, -3970000.0, -3830000.0, -3630000.0, -3490000.0, -3350000.0, -3160000.0, -3010000.0, -2870000.0, -2680000.0, -2530000.0, -2390000.0, -2200000.0, -2060000.0, -1910000.0, -1720000.0, -1570000.0], \
				 [-5450000.0, -5280000.0, -5050000.0, -4880000.0, -4710000.0, -4480000.0, -4310000.0, -4130000.0, -3900000.0, -3730000.0, -3560000.0, -3330000.0, -3160000.0, -2990000.0, -2760000.0, -2580000.0, -2410000.0, -2180000.0, -2010000.0], \
				 [-6990000.0, -6780000.0, -6490000.0, -6280000.0, -6060000.0, -5780000.0, -5560000.0, -5340000.0, -5060000.0, -4840000.0, -4630000.0, -4340000.0, -4120000.0, -3910000.0, -3620000.0, -3410000.0, -3190000.0, -2900000.0, -2690000.0], \
				 [-9630000.0, -9340000.0, -8960000.0, -8670000.0, -8390000.0, -8010000.0, -7720000.0, -7430000.0, -7050000.0, -6760000.0, -6470000.0, -6090000.0, -5800000.0, -5520000.0, -5140000.0, -4850000.0, -4560000.0, -4180000.0, -3890000.0], \
				 [-12300000.0, -12000000.0, -11500000.0, -11100000.0, -10800000.0, -10300000.0, -9940000.0, -9580000.0, -9100000.0, -8740000.0, -8380000.0, -7910000.0, -7550000.0, -7190000.0, -6710000.0, -6350000.0, -5990000.0, -5520000.0, -5150000.0], \
				 [-15100000.0, -14700000.0, -14100000.0, -13600000.0, -13200000.0, -12600000.0, -12200000.0, -11800000.0, -11200000.0, -10800000.0, -10300000.0, -9780000.0, -9350000.0, -8910000.0, -8340000.0, -7910000.0, -7480000.0, -6910000.0, -6470000.0], \
				 [-17900000.0, -17400000.0, -16700000.0, -16200000.0, -15700000.0, -15000000.0, -14500000.0, -14000000.0, -13400000.0, -12900000.0, -12400000.0, -11700000.0, -11200000.0, -10700000.0, -10000000.0, -9510000.0, -9010000.0, -8340000.0, -7830000.0], \
				 [-20700000.0, -20100000.0, -19400000.0, -18800000.0, -18200000.0, -17500000.0, -16900000.0, -16300000.0, -15600000.0, -15000000.0, -14400000.0, -13600000.0, -13100000.0, -12500000.0, -11700000.0, -11100000.0, -10600000.0, -9810000.0, -9230000.0]]
    
    ################## FUNCTION ###############################################
    
    function = scipy.interpolate.RectBivariateSpline(data_temperature, data_pressure, data)

    result = function(temperature,pressure)[0][0]
    
    if unit == 'kg':
        return result
    
    if unit == 'mol':
        return result*molar_mass()

#%% 
def internal_energy(temperature,pressure,unit):
    
    """
    ========== DESCRIPTION ==========

    This function return the internal energy of pure Helium 4

    ========== VALIDITY ==========

    <temperature> : [0.8 -> 400]
    <pressure> : [1 -> 1e6] 

    ========== FROM ==========

    HEPAK was written by Vincent Arp, Bob McCarty, and Jeff Fox, formerly of 
    NIST and later of Cryodata, using code from Brian Hands while at the 
    Oxford University Cryogenics Laboratory.


    ========== INPUT ==========

    <temperature>
        -- float --
        The temperature of pure helium 4
        [K]

    <pressure>
        -- float --
        The pressure of pure helium 4
        [Pa]
        
    <unit>
        -- string --
        Either kg or mol

    ========== OUTPUT ==========

    <gibbs_energy>
        -- float --
        The gibbs energy of pure helium 4
        if 'kg' : [J].[kg]**(-1)
        if 'mol' : [J].[mol]**(-1)

    ========== STATUS ==========

    Status : Checked 2024-02-27
    
    ========== UPDATE ==========
    

    """
    
    ################## PACKAGES ###############################################
    
    import scipy.interpolate
    import numpy
    
    ################## CONDITIONS #############################################
    
    assert temperature >= 0.8 and temperature <= 400 , 'The function helium4.internal_energy is not valid for T = ' + str(temperature) + ' K'
    assert pressure >= 1 and pressure <=  1e6, 'The function helium4.internal_energy  is not valid for P = ' + str(pressure) + ' Pa'
    
    ################## INITIALISATION #########################################
    
    data_temperature = numpy.array([0.8,0.9,1,1.1,1.2,1.3,1.4,1.5,1.6,1.7,1.8,1.9,2,2.1,2.2,2.3,2.4,2.5,2.6,2.7,2.8,2.9,3,3.1,3.2,3.3,3.4,3.5,3.6,3.7,3.8,3.9,4,4.1,4.2,4.3,4.4,4.5,4.6,4.7,4.8,4.9,5,5.5,6,8,10,15,20,30,40,50,70,100,120,150,200,250,300,350,400])
    data_pressure = numpy.array([1, 2, 5, 1e1, 2e1, 5e1, 1e2, 2e2, 5e2, 1e3, 2e3, 5e3, 1e4, 2e4, 5e4, 1e5, 2e5, 5e5, 1e6])
    data =		[[17800.0, 1.87, 1.87, 1.87, 1.87, 1.87, 1.87, 1.87, 1.87, 1.86, 1.86, 1.86, 1.88, 1.98, 2.75, 5.55, 16.3, 80.6, 261.0], \
				 [18100.0, 18100.0, 18100.0, 5.32, 5.32, 5.32, 5.32, 5.32, 5.32, 5.32, 5.32, 5.32, 5.34, 5.44, 6.21, 9.01, 19.7, 84.0, 266.0], \
				 [18400.0, 18400.0, 18400.0, 18400.0, 12.6, 12.6, 12.6, 12.6, 12.6, 12.6, 12.6, 12.6, 12.6, 12.7, 13.5, 16.4, 27.2, 91.9, 277.0], \
				 [18700.0, 18700.0, 18700.0, 18700.0, 18700.0, 26.5, 26.5, 26.5, 26.5, 26.5, 26.5, 26.5, 26.6, 26.7, 27.6, 30.6, 41.7, 107.0, 297.0], \
				 [19000.0, 19000.0, 19000.0, 19000.0, 19000.0, 19000.0, 51.2, 51.2, 51.2, 51.2, 51.2, 51.2, 51.3, 51.5, 52.5, 55.7, 67.2, 135.0, 330.0], \
				 [19300.0, 19300.0, 19300.0, 19300.0, 19300.0, 19300.0, 19300.0, 92.1, 92.1, 92.1, 92.1, 92.1, 92.2, 92.4, 93.6, 97.2, 109.0, 180.0, 383.0], \
				 [19600.0, 19600.0, 19600.0, 19600.0, 19600.0, 19600.0, 19600.0, 19600.0, 156.0, 156.0, 156.0, 156.0, 156.0, 156.0, 158.0, 162.0, 175.0, 250.0, 464.0], \
				 [19900.0, 19900.0, 19900.0, 19900.0, 19900.0, 19900.0, 19900.0, 19900.0, 251.0, 251.0, 251.0, 251.0, 251.0, 252.0, 253.0, 258.0, 272.0, 353.0, 581.0], \
				 [20300.0, 20300.0, 20300.0, 20300.0, 20300.0, 20200.0, 20200.0, 20200.0, 20100.0, 387.0, 387.0, 387.0, 388.0, 388.0, 390.0, 395.0, 412.0, 501.0, 745.0], \
				 [20600.0, 20600.0, 20600.0, 20600.0, 20600.0, 20600.0, 20500.0, 20500.0, 20500.0, 20400.0, 576.0, 576.0, 576.0, 577.0, 579.0, 585.0, 604.0, 704.0, 970.0], \
				 [20900.0, 20900.0, 20900.0, 20900.0, 20900.0, 20900.0, 20900.0, 20800.0, 20800.0, 20700.0, 831.0, 831.0, 831.0, 832.0, 835.0, 843.0, 865.0, 979.0, 1270.0], \
				 [21200.0, 21200.0, 21200.0, 21200.0, 21200.0, 21200.0, 21200.0, 21200.0, 21100.0, 21000.0, 20900.0, 1170.0, 1170.0, 1170.0, 1180.0, 1190.0, 1210.0, 1350.0, 1680.0], \
				 [21500.0, 21500.0, 21500.0, 21500.0, 21500.0, 21500.0, 21500.0, 21500.0, 21400.0, 21400.0, 21200.0, 1620.0, 1620.0, 1620.0, 1630.0, 1640.0, 1670.0, 1840.0, 2250.0], \
				 [21800.0, 21800.0, 21800.0, 21800.0, 21800.0, 21800.0, 21800.0, 21800.0, 21800.0, 21700.0, 21600.0, 2230.0, 2230.0, 2240.0, 2250.0, 2260.0, 2310.0, 2530.0, 2960.0], \
				 [22100.0, 22100.0, 22100.0, 22100.0, 22100.0, 22100.0, 22100.0, 22100.0, 22100.0, 22000.0, 21900.0, 21600.0, 3050.0, 3050.0, 3050.0, 3040.0, 3040.0, 3070.0, 3190.0], \
				 [22400.0, 22400.0, 22400.0, 22400.0, 22400.0, 22400.0, 22400.0, 22400.0, 22400.0, 22400.0, 22300.0, 22000.0, 3370.0, 3370.0, 3360.0, 3340.0, 3320.0, 3300.0, 3370.0], \
				 [22800.0, 22800.0, 22800.0, 22800.0, 22700.0, 22700.0, 22700.0, 22700.0, 22700.0, 22700.0, 22600.0, 22300.0, 3620.0, 3610.0, 3600.0, 3580.0, 3540.0, 3500.0, 3540.0], \
				 [23100.0, 23100.0, 23100.0, 23100.0, 23100.0, 23100.0, 23100.0, 23000.0, 23000.0, 23000.0, 22900.0, 22700.0, 22300.0, 3850.0, 3830.0, 3800.0, 3750.0, 3680.0, 3690.0], \
				 [23400.0, 23400.0, 23400.0, 23400.0, 23400.0, 23400.0, 23400.0, 23400.0, 23300.0, 23300.0, 23200.0, 23000.0, 22700.0, 4070.0, 4050.0, 4010.0, 3960.0, 3870.0, 3850.0], \
				 [23700.0, 23700.0, 23700.0, 23700.0, 23700.0, 23700.0, 23700.0, 23700.0, 23700.0, 23600.0, 23600.0, 23400.0, 23100.0, 4300.0, 4270.0, 4230.0, 4170.0, 4050.0, 4010.0], \
				 [24000.0, 24000.0, 24000.0, 24000.0, 24000.0, 24000.0, 24000.0, 24000.0, 24000.0, 23900.0, 23900.0, 23700.0, 23400.0, 4540.0, 4500.0, 4460.0, 4380.0, 4230.0, 4170.0], \
				 [24300.0, 24300.0, 24300.0, 24300.0, 24300.0, 24300.0, 24300.0, 24300.0, 24300.0, 24300.0, 24200.0, 24000.0, 23800.0, 23200.0, 4740.0, 4690.0, 4590.0, 4420.0, 4330.0], \
				 [24600.0, 24600.0, 24600.0, 24600.0, 24600.0, 24600.0, 24600.0, 24600.0, 24600.0, 24600.0, 24500.0, 24400.0, 24100.0, 23600.0, 4990.0, 4920.0, 4820.0, 4620.0, 4500.0], \
				 [24900.0, 24900.0, 24900.0, 24900.0, 24900.0, 24900.0, 24900.0, 24900.0, 24900.0, 24900.0, 24800.0, 24700.0, 24500.0, 24000.0, 5250.0, 5180.0, 5060.0, 4820.0, 4670.0], \
				 [25200.0, 25200.0, 25200.0, 25200.0, 25200.0, 25200.0, 25200.0, 25200.0, 25200.0, 25200.0, 25200.0, 25000.0, 24800.0, 24300.0, 5520.0, 5440.0, 5310.0, 5040.0, 4860.0], \
				 [25600.0, 25600.0, 25600.0, 25600.0, 25600.0, 25600.0, 25600.0, 25500.0, 25500.0, 25500.0, 25500.0, 25300.0, 25100.0, 24700.0, 5820.0, 5720.0, 5570.0, 5270.0, 5050.0], \
				 [25900.0, 25900.0, 25900.0, 25900.0, 25900.0, 25900.0, 25900.0, 25900.0, 25800.0, 25800.0, 25800.0, 25700.0, 25500.0, 25100.0, 6130.0, 6020.0, 5850.0, 5510.0, 5260.0], \
				 [26200.0, 26200.0, 26200.0, 26200.0, 26200.0, 26200.0, 26200.0, 26200.0, 26200.0, 26100.0, 26100.0, 26000.0, 25800.0, 25400.0, 6450.0, 6330.0, 6140.0, 5760.0, 5470.0], \
				 [26500.0, 26500.0, 26500.0, 26500.0, 26500.0, 26500.0, 26500.0, 26500.0, 26500.0, 26500.0, 26400.0, 26300.0, 26100.0, 25800.0, 24500.0, 6660.0, 6440.0, 6020.0, 5690.0], \
				 [26800.0, 26800.0, 26800.0, 26800.0, 26800.0, 26800.0, 26800.0, 26800.0, 26800.0, 26800.0, 26700.0, 26600.0, 26500.0, 26100.0, 24900.0, 7010.0, 6760.0, 6290.0, 5920.0], \
				 [27100.0, 27100.0, 27100.0, 27100.0, 27100.0, 27100.0, 27100.0, 27100.0, 27100.0, 27100.0, 27000.0, 26900.0, 26800.0, 26400.0, 25300.0, 7380.0, 7100.0, 6570.0, 6160.0], \
				 [27400.0, 27400.0, 27400.0, 27400.0, 27400.0, 27400.0, 27400.0, 27400.0, 27400.0, 27400.0, 27400.0, 27300.0, 27100.0, 26800.0, 25700.0, 7770.0, 7450.0, 6860.0, 6400.0], \
				 [27700.0, 27700.0, 27700.0, 27700.0, 27700.0, 27700.0, 27700.0, 27700.0, 27700.0, 27700.0, 27700.0, 27600.0, 27400.0, 27100.0, 26100.0, 8180.0, 7810.0, 7160.0, 6650.0], \
				 [28000.0, 28000.0, 28000.0, 28000.0, 28000.0, 28000.0, 28000.0, 28000.0, 28000.0, 28000.0, 28000.0, 27900.0, 27800.0, 27400.0, 26400.0, 8630.0, 8200.0, 7470.0, 6910.0], \
				 [28400.0, 28400.0, 28400.0, 28400.0, 28400.0, 28400.0, 28400.0, 28400.0, 28300.0, 28300.0, 28300.0, 28200.0, 28100.0, 27800.0, 26800.0, 9100.0, 8610.0, 7790.0, 7180.0], \
				 [28700.0, 28700.0, 28700.0, 28700.0, 28700.0, 28700.0, 28700.0, 28700.0, 28700.0, 28600.0, 28600.0, 28500.0, 28400.0, 28100.0, 27200.0, 25200.0, 9040.0, 8120.0, 7450.0], \
				 [29000.0, 29000.0, 29000.0, 29000.0, 29000.0, 29000.0, 29000.0, 29000.0, 29000.0, 29000.0, 28900.0, 28800.0, 28700.0, 28400.0, 27500.0, 25700.0, 9490.0, 8470.0, 7730.0], \
				 [29300.0, 29300.0, 29300.0, 29300.0, 29300.0, 29300.0, 29300.0, 29300.0, 29300.0, 29300.0, 29200.0, 29200.0, 29000.0, 28800.0, 27900.0, 26100.0, 9990.0, 8820.0, 8010.0], \
				 [29600.0, 29600.0, 29600.0, 29600.0, 29600.0, 29600.0, 29600.0, 29600.0, 29600.0, 29600.0, 29600.0, 29500.0, 29400.0, 29100.0, 28300.0, 26600.0, 10500.0, 9180.0, 8300.0], \
				 [29900.0, 29900.0, 29900.0, 29900.0, 29900.0, 29900.0, 29900.0, 29900.0, 29900.0, 29900.0, 29900.0, 29800.0, 29700.0, 29400.0, 28600.0, 27000.0, 11100.0, 9560.0, 8600.0], \
				 [30200.0, 30200.0, 30200.0, 30200.0, 30200.0, 30200.0, 30200.0, 30200.0, 30200.0, 30200.0, 30200.0, 30100.0, 30000.0, 29700.0, 29000.0, 27400.0, 11800.0, 9950.0, 8900.0], \
				 [30500.0, 30500.0, 30500.0, 30500.0, 30500.0, 30500.0, 30500.0, 30500.0, 30500.0, 30500.0, 30500.0, 30400.0, 30300.0, 30100.0, 29300.0, 27800.0, 12600.0, 10400.0, 9210.0], \
				 [30900.0, 30900.0, 30900.0, 30900.0, 30900.0, 30900.0, 30800.0, 30800.0, 30800.0, 30800.0, 30800.0, 30700.0, 30600.0, 30400.0, 29700.0, 28200.0, 13700.0, 10800.0, 9530.0], \
				 [32400.0, 32400.0, 32400.0, 32400.0, 32400.0, 32400.0, 32400.0, 32400.0, 32400.0, 32400.0, 32400.0, 32300.0, 32200.0, 32000.0, 31300.0, 30200.0, 26900.0, 13200.0, 11200.0], \
				 [34000.0, 34000.0, 34000.0, 34000.0, 34000.0, 34000.0, 34000.0, 34000.0, 34000.0, 33900.0, 33900.0, 33900.0, 33800.0, 33600.0, 33000.0, 32000.0, 29400.0, 16500.0, 13100.0], \
				 [40200.0, 40200.0, 40200.0, 40200.0, 40200.0, 40200.0, 40200.0, 40200.0, 40200.0, 40200.0, 40200.0, 40100.0, 40100.0, 39900.0, 39500.0, 38800.0, 37200.0, 31700.0, 23200.0], \
				 [46400.0, 46400.0, 46400.0, 46400.0, 46400.0, 46400.0, 46400.0, 46400.0, 46400.0, 46400.0, 46400.0, 46400.0, 46300.0, 46200.0, 45900.0, 45300.0, 44200.0, 40500.0, 34100.0], \
				 [62000.0, 62000.0, 62000.0, 62000.0, 62000.0, 62000.0, 62000.0, 62000.0, 62000.0, 62000.0, 62000.0, 62000.0, 61900.0, 61900.0, 61600.0, 61300.0, 60600.0, 58400.0, 54800.0], \
				 [77600.0, 77600.0, 77600.0, 77600.0, 77600.0, 77600.0, 77600.0, 77600.0, 77600.0, 77600.0, 77600.0, 77600.0, 77500.0, 77500.0, 77300.0, 77100.0, 76600.0, 75000.0, 72500.0], \
				 [109000.0, 109000.0, 109000.0, 109000.0, 109000.0, 109000.0, 109000.0, 109000.0, 109000.0, 109000.0, 109000.0, 109000.0, 109000.0, 109000.0, 109000.0, 108000.0, 108000.0, 107000.0, 106000.0], \
				 [140000.0, 140000.0, 140000.0, 140000.0, 140000.0, 140000.0, 140000.0, 140000.0, 140000.0, 140000.0, 140000.0, 140000.0, 140000.0, 140000.0, 140000.0, 140000.0, 140000.0, 139000.0, 138000.0], \
				 [171000.0, 171000.0, 171000.0, 171000.0, 171000.0, 171000.0, 171000.0, 171000.0, 171000.0, 171000.0, 171000.0, 171000.0, 171000.0, 171000.0, 171000.0, 171000.0, 171000.0, 170000.0, 170000.0], \
				 [233000.0, 233000.0, 233000.0, 233000.0, 233000.0, 233000.0, 233000.0, 233000.0, 233000.0, 233000.0, 233000.0, 233000.0, 233000.0, 233000.0, 233000.0, 233000.0, 233000.0, 233000.0, 233000.0], \
				 [327000.0, 327000.0, 327000.0, 327000.0, 327000.0, 327000.0, 327000.0, 327000.0, 327000.0, 327000.0, 327000.0, 327000.0, 327000.0, 327000.0, 327000.0, 327000.0, 327000.0, 327000.0, 327000.0], \
				 [389000.0, 389000.0, 389000.0, 389000.0, 389000.0, 389000.0, 389000.0, 389000.0, 389000.0, 389000.0, 389000.0, 389000.0, 389000.0, 389000.0, 389000.0, 389000.0, 389000.0, 389000.0, 389000.0], \
				 [483000.0, 483000.0, 483000.0, 483000.0, 483000.0, 483000.0, 483000.0, 483000.0, 483000.0, 483000.0, 483000.0, 483000.0, 483000.0, 483000.0, 483000.0, 483000.0, 483000.0, 483000.0, 483000.0], \
				 [638000.0, 638000.0, 638000.0, 638000.0, 638000.0, 638000.0, 638000.0, 638000.0, 638000.0, 638000.0, 638000.0, 638000.0, 638000.0, 638000.0, 638000.0, 638000.0, 638000.0, 639000.0, 639000.0], \
				 [794000.0, 794000.0, 794000.0, 794000.0, 794000.0, 794000.0, 794000.0, 794000.0, 794000.0, 794000.0, 794000.0, 794000.0, 794000.0, 794000.0, 794000.0, 794000.0, 794000.0, 794000.0, 795000.0], \
				 [950000.0, 950000.0, 950000.0, 950000.0, 950000.0, 950000.0, 950000.0, 950000.0, 950000.0, 950000.0, 950000.0, 950000.0, 950000.0, 950000.0, 950000.0, 950000.0, 950000.0, 950000.0, 950000.0], \
				 [1110000.0, 1110000.0, 1110000.0, 1110000.0, 1110000.0, 1110000.0, 1110000.0, 1110000.0, 1110000.0, 1110000.0, 1110000.0, 1110000.0, 1110000.0, 1110000.0, 1110000.0, 1110000.0, 1110000.0, 1110000.0, 1110000.0], \
				 [1260000.0, 1260000.0, 1260000.0, 1260000.0, 1260000.0, 1260000.0, 1260000.0, 1260000.0, 1260000.0, 1260000.0, 1260000.0, 1260000.0, 1260000.0, 1260000.0, 1260000.0, 1260000.0, 1260000.0, 1260000.0, 1260000.0]]
    
    
    
    ################## FUNCTION ###############################################
    
    function = scipy.interpolate.RectBivariateSpline(data_temperature, data_pressure, data)

    result = function(temperature,pressure)[0][0]
    
    if unit == 'kg':
        return result
    
    if unit == 'mol':
        return result*molar_mass()

#%% 
def sound_velocity(temperature,pressure):
    
    """
    ========== DESCRIPTION ==========

    This function return the sound velocity of pure Helium 4

    ========== VALIDITY ==========

    <temperature> : [0.8 -> 400]
    <pressure> : [1 -> 1e6] 

    ========== FROM ==========

    HEPAK was written by Vincent Arp, Bob McCarty, and Jeff Fox, formerly of 
    NIST and later of Cryodata, using code from Brian Hands while at the 
    Oxford University Cryogenics Laboratory.


    ========== INPUT ==========

    <temperature>
        -- float --
        The temperature of pure helium 4
        [K]

    <pressure>
        -- float --
        The pressure of pure helium 4
        [Pa]

    ========== OUTPUT ==========

    <sound_velocity>
        -- float --
        The sound velocity of pure helium 4
        [m].[s]**(-1)

    ========== STATUS ==========

    Status : Checked 2024-02-27
    
    ========== UPDATE ==========
    

    """
    
    ################## PACKAGES ###############################################
    
    import scipy.interpolate
    import numpy
    
    ################## CONDITIONS #############################################
    
    assert temperature >= 0.8 and temperature <= 400 , 'The function helium4.sound_velocity is not valid for T = ' + str(temperature) + ' K'
    assert pressure >= 1 and pressure <=  1e6, 'The function helium4.sound_velocity  is not valid for P = ' + str(pressure) + ' Pa'
    
    ################## INITIALISATION #########################################
    
    data_temperature = numpy.array([0.8,0.9,1,1.1,1.2,1.3,1.4,1.5,1.6,1.7,1.8,1.9,2,2.1,2.2,2.3,2.4,2.5,2.6,2.7,2.8,2.9,3,3.1,3.2,3.3,3.4,3.5,3.6,3.7,3.8,3.9,4,4.1,4.2,4.3,4.4,4.5,4.6,4.7,4.8,4.9,5,5.5,6,8,10,15,20,30,40,50,70,100,120,150,200,250,300,350,400])
    data_pressure = numpy.array([1, 2, 5, 1e1, 2e1, 5e1, 1e2, 2e2, 5e2, 1e3, 2e3, 5e3, 1e4, 2e4, 5e4, 1e5, 2e5, 5e5, 1e6])
    data =		[[52.6, 238.0, 238.0, 238.0, 238.0, 238.0, 238.0, 238.0, 238.0, 238.0, 238.0, 238.0, 238.0, 239.0, 241.0, 245.0, 253.0, 277.0, 304.0], \
				 [55.8, 55.8, 55.8, 238.0, 238.0, 238.0, 238.0, 238.0, 238.0, 238.0, 238.0, 238.0, 239.0, 239.0, 241.0, 245.0, 253.0, 277.0, 304.0], \
				 [58.8, 58.8, 58.8, 58.8, 238.0, 238.0, 238.0, 238.0, 238.0, 238.0, 238.0, 238.0, 239.0, 239.0, 241.0, 245.0, 253.0, 276.0, 303.0], \
				 [61.7, 61.7, 61.7, 61.7, 61.6, 238.0, 238.0, 238.0, 238.0, 238.0, 238.0, 238.0, 239.0, 239.0, 241.0, 245.0, 253.0, 275.0, 303.0], \
				 [64.5, 64.4, 64.4, 64.4, 64.4, 64.3, 238.0, 238.0, 238.0, 238.0, 238.0, 238.0, 238.0, 239.0, 241.0, 245.0, 253.0, 275.0, 302.0], \
				 [67.1, 67.1, 67.1, 67.1, 67.0, 66.9, 66.8, 237.0, 237.0, 237.0, 237.0, 238.0, 238.0, 239.0, 241.0, 245.0, 253.0, 274.0, 301.0], \
				 [69.6, 69.6, 69.6, 69.6, 69.6, 69.5, 69.4, 69.1, 236.0, 236.0, 237.0, 237.0, 237.0, 238.0, 241.0, 245.0, 253.0, 272.0, 300.0], \
				 [72.1, 72.1, 72.1, 72.0, 72.0, 72.0, 71.9, 71.7, 235.0, 235.0, 236.0, 236.0, 236.0, 237.0, 240.0, 245.0, 252.0, 271.0, 299.0], \
				 [74.4, 74.4, 74.4, 74.4, 74.4, 74.3, 74.3, 74.1, 73.6, 234.0, 234.0, 235.0, 235.0, 237.0, 240.0, 244.0, 252.0, 270.0, 298.0], \
				 [76.7, 76.7, 76.7, 76.7, 76.7, 76.6, 76.6, 76.4, 76.0, 75.3, 233.0, 234.0, 234.0, 235.0, 238.0, 243.0, 250.0, 268.0, 297.0], \
				 [78.9, 78.9, 78.9, 78.9, 78.9, 78.9, 78.8, 78.7, 78.4, 77.8, 232.0, 232.0, 232.0, 233.0, 236.0, 240.0, 248.0, 267.0, 295.0], \
				 [81.1, 81.1, 81.1, 81.1, 81.1, 81.1, 81.0, 80.9, 80.6, 80.1, 79.0, 230.0, 230.0, 231.0, 234.0, 238.0, 245.0, 265.0, 293.0], \
				 [83.2, 83.2, 83.2, 83.2, 83.2, 83.2, 83.1, 83.0, 82.8, 82.3, 81.4, 227.0, 227.0, 228.0, 230.0, 234.0, 242.0, 263.0, 289.0], \
				 [85.3, 85.3, 85.3, 85.3, 85.3, 85.2, 85.2, 85.1, 84.9, 84.5, 83.7, 223.0, 223.0, 224.0, 226.0, 230.0, 238.0, 259.0, 288.0], \
				 [87.3, 87.3, 87.3, 87.3, 87.3, 87.2, 87.2, 87.1, 86.9, 86.6, 85.9, 83.7, 220.0, 221.0, 224.0, 228.0, 237.0, 260.0, 292.0], \
				 [89.2, 89.2, 89.2, 89.2, 89.2, 89.2, 89.2, 89.1, 88.9, 88.6, 88.0, 86.0, 222.0, 222.0, 225.0, 230.0, 239.0, 263.0, 294.0], \
				 [91.2, 91.2, 91.2, 91.1, 91.1, 91.1, 91.1, 91.0, 90.9, 90.6, 90.0, 88.3, 222.0, 223.0, 226.0, 231.0, 240.0, 264.0, 296.0], \
				 [93.0, 93.0, 93.0, 93.0, 93.0, 93.0, 93.0, 92.9, 92.8, 92.5, 92.0, 90.4, 87.6, 223.0, 226.0, 231.0, 240.0, 265.0, 297.0], \
				 [94.9, 94.9, 94.9, 94.9, 94.9, 94.9, 94.8, 94.8, 94.6, 94.4, 93.9, 92.5, 90.0, 221.0, 224.0, 229.0, 239.0, 265.0, 298.0], \
				 [96.7, 96.7, 96.7, 96.7, 96.7, 96.7, 96.6, 96.6, 96.5, 96.3, 95.8, 94.5, 92.2, 219.0, 223.0, 228.0, 239.0, 265.0, 298.0], \
				 [98.5, 98.5, 98.5, 98.5, 98.4, 98.4, 98.4, 98.4, 98.3, 98.1, 97.7, 96.5, 94.4, 217.0, 221.0, 227.0, 238.0, 265.0, 299.0], \
				 [100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 99.8, 99.5, 98.4, 96.4, 92.2, 220.0, 226.0, 237.0, 264.0, 299.0], \
				 [102.0, 102.0, 102.0, 102.0, 102.0, 102.0, 102.0, 102.0, 102.0, 102.0, 101.0, 100.0, 98.5, 94.6, 218.0, 224.0, 235.0, 263.0, 298.0], \
				 [104.0, 104.0, 104.0, 104.0, 104.0, 104.0, 104.0, 104.0, 103.0, 103.0, 103.0, 102.0, 100.0, 96.9, 216.0, 222.0, 233.0, 262.0, 297.0], \
				 [105.0, 105.0, 105.0, 105.0, 105.0, 105.0, 105.0, 105.0, 105.0, 105.0, 105.0, 104.0, 102.0, 99.0, 213.0, 219.0, 231.0, 260.0, 296.0], \
				 [107.0, 107.0, 107.0, 107.0, 107.0, 107.0, 107.0, 107.0, 107.0, 107.0, 106.0, 106.0, 104.0, 101.0, 210.0, 217.0, 229.0, 259.0, 295.0], \
				 [108.0, 108.0, 108.0, 108.0, 108.0, 108.0, 108.0, 108.0, 108.0, 108.0, 108.0, 107.0, 106.0, 103.0, 207.0, 214.0, 227.0, 257.0, 294.0], \
				 [110.0, 110.0, 110.0, 110.0, 110.0, 110.0, 110.0, 110.0, 110.0, 110.0, 110.0, 109.0, 108.0, 105.0, 203.0, 210.0, 224.0, 255.0, 292.0], \
				 [112.0, 112.0, 112.0, 112.0, 112.0, 112.0, 112.0, 112.0, 112.0, 111.0, 111.0, 111.0, 109.0, 107.0, 98.4, 207.0, 221.0, 253.0, 291.0], \
				 [113.0, 113.0, 113.0, 113.0, 113.0, 113.0, 113.0, 113.0, 113.0, 113.0, 113.0, 112.0, 111.0, 109.0, 101.0, 203.0, 218.0, 251.0, 290.0], \
				 [115.0, 115.0, 115.0, 115.0, 115.0, 115.0, 115.0, 115.0, 115.0, 115.0, 114.0, 114.0, 113.0, 111.0, 103.0, 199.0, 214.0, 249.0, 288.0], \
				 [116.0, 116.0, 116.0, 116.0, 116.0, 116.0, 116.0, 116.0, 116.0, 116.0, 116.0, 115.0, 114.0, 112.0, 106.0, 195.0, 211.0, 247.0, 287.0], \
				 [118.0, 118.0, 118.0, 118.0, 118.0, 118.0, 118.0, 118.0, 118.0, 118.0, 117.0, 117.0, 116.0, 114.0, 108.0, 190.0, 207.0, 244.0, 286.0], \
				 [119.0, 119.0, 119.0, 119.0, 119.0, 119.0, 119.0, 119.0, 119.0, 119.0, 119.0, 118.0, 117.0, 116.0, 110.0, 184.0, 203.0, 242.0, 284.0], \
				 [121.0, 121.0, 121.0, 121.0, 121.0, 121.0, 121.0, 121.0, 121.0, 120.0, 120.0, 120.0, 119.0, 117.0, 112.0, 178.0, 199.0, 239.0, 283.0], \
				 [122.0, 122.0, 122.0, 122.0, 122.0, 122.0, 122.0, 122.0, 122.0, 122.0, 122.0, 121.0, 121.0, 119.0, 114.0, 103.0, 194.0, 237.0, 281.0], \
				 [123.0, 123.0, 123.0, 123.0, 123.0, 123.0, 123.0, 123.0, 123.0, 123.0, 123.0, 123.0, 122.0, 121.0, 116.0, 106.0, 189.0, 234.0, 280.0], \
				 [125.0, 125.0, 125.0, 125.0, 125.0, 125.0, 125.0, 125.0, 125.0, 125.0, 125.0, 124.0, 123.0, 122.0, 118.0, 108.0, 183.0, 231.0, 278.0], \
				 [126.0, 126.0, 126.0, 126.0, 126.0, 126.0, 126.0, 126.0, 126.0, 126.0, 126.0, 126.0, 125.0, 124.0, 119.0, 111.0, 177.0, 228.0, 277.0], \
				 [128.0, 128.0, 128.0, 128.0, 128.0, 128.0, 128.0, 128.0, 127.0, 127.0, 127.0, 127.0, 126.0, 125.0, 121.0, 113.0, 170.0, 225.0, 275.0], \
				 [129.0, 129.0, 129.0, 129.0, 129.0, 129.0, 129.0, 129.0, 129.0, 129.0, 129.0, 128.0, 128.0, 127.0, 123.0, 115.0, 161.0, 222.0, 273.0], \
				 [130.0, 130.0, 130.0, 130.0, 130.0, 130.0, 130.0, 130.0, 130.0, 130.0, 130.0, 130.0, 129.0, 128.0, 124.0, 118.0, 151.0, 219.0, 272.0], \
				 [132.0, 132.0, 132.0, 132.0, 132.0, 132.0, 132.0, 132.0, 132.0, 131.0, 131.0, 131.0, 131.0, 129.0, 126.0, 120.0, 137.0, 215.0, 270.0], \
				 [138.0, 138.0, 138.0, 138.0, 138.0, 138.0, 138.0, 138.0, 138.0, 138.0, 138.0, 138.0, 137.0, 136.0, 134.0, 129.0, 118.0, 194.0, 260.0], \
				 [144.0, 144.0, 144.0, 144.0, 144.0, 144.0, 144.0, 144.0, 144.0, 144.0, 144.0, 144.0, 143.0, 143.0, 141.0, 137.0, 129.0, 167.0, 248.0], \
				 [166.0, 166.0, 166.0, 166.0, 166.0, 166.0, 166.0, 166.0, 166.0, 166.0, 166.0, 166.0, 166.0, 166.0, 165.0, 164.0, 161.0, 158.0, 199.0], \
				 [186.0, 186.0, 186.0, 186.0, 186.0, 186.0, 186.0, 186.0, 186.0, 186.0, 186.0, 186.0, 186.0, 186.0, 186.0, 185.0, 184.0, 184.0, 198.0], \
				 [228.0, 228.0, 228.0, 228.0, 228.0, 228.0, 228.0, 228.0, 228.0, 228.0, 228.0, 228.0, 228.0, 228.0, 228.0, 229.0, 229.0, 232.0, 240.0], \
				 [263.0, 263.0, 263.0, 263.0, 263.0, 263.0, 263.0, 263.0, 263.0, 263.0, 263.0, 263.0, 263.0, 263.0, 264.0, 264.0, 265.0, 269.0, 276.0], \
				 [322.0, 322.0, 322.0, 322.0, 322.0, 322.0, 322.0, 322.0, 322.0, 322.0, 322.0, 322.0, 322.0, 323.0, 323.0, 324.0, 325.0, 329.0, 336.0], \
				 [372.0, 372.0, 372.0, 372.0, 372.0, 372.0, 372.0, 372.0, 372.0, 372.0, 372.0, 372.0, 372.0, 372.0, 373.0, 373.0, 375.0, 378.0, 385.0], \
				 [416.0, 416.0, 416.0, 416.0, 416.0, 416.0, 416.0, 416.0, 416.0, 416.0, 416.0, 416.0, 416.0, 416.0, 417.0, 417.0, 418.0, 422.0, 428.0], \
				 [492.0, 492.0, 492.0, 492.0, 492.0, 492.0, 492.0, 492.0, 492.0, 492.0, 492.0, 492.0, 492.0, 492.0, 493.0, 493.0, 494.0, 497.0, 503.0], \
				 [588.0, 588.0, 588.0, 588.0, 588.0, 588.0, 588.0, 588.0, 588.0, 588.0, 588.0, 588.0, 588.0, 589.0, 589.0, 589.0, 590.0, 593.0, 597.0], \
				 [645.0, 645.0, 645.0, 645.0, 645.0, 645.0, 645.0, 645.0, 645.0, 645.0, 645.0, 645.0, 645.0, 645.0, 645.0, 645.0, 646.0, 648.0, 652.0], \
				 [721.0, 721.0, 721.0, 721.0, 721.0, 721.0, 721.0, 721.0, 721.0, 721.0, 721.0, 721.0, 721.0, 721.0, 721.0, 721.0, 722.0, 724.0, 727.0], \
				 [832.0, 832.0, 832.0, 832.0, 832.0, 832.0, 832.0, 832.0, 832.0, 832.0, 832.0, 832.0, 832.0, 832.0, 832.0, 833.0, 833.0, 835.0, 838.0], \
				 [930.0, 930.0, 930.0, 930.0, 930.0, 930.0, 930.0, 930.0, 930.0, 930.0, 930.0, 930.0, 930.0, 930.0, 931.0, 931.0, 931.0, 933.0, 935.0], \
				 [1020.0, 1020.0, 1020.0, 1020.0, 1020.0, 1020.0, 1020.0, 1020.0, 1020.0, 1020.0, 1020.0, 1020.0, 1020.0, 1020.0, 1020.0, 1020.0, 1020.0, 1020.0, 1020.0], \
				 [1100.0, 1100.0, 1100.0, 1100.0, 1100.0, 1100.0, 1100.0, 1100.0, 1100.0, 1100.0, 1100.0, 1100.0, 1100.0, 1100.0, 1100.0, 1100.0, 1100.0, 1100.0, 1100.0], \
				 [1180.0, 1180.0, 1180.0, 1180.0, 1180.0, 1180.0, 1180.0, 1180.0, 1180.0, 1180.0, 1180.0, 1180.0, 1180.0, 1180.0, 1180.0, 1180.0, 1180.0, 1180.0, 1180.0]]
    
    ################## FUNCTION ###############################################
    
    function = scipy.interpolate.RectBivariateSpline(data_temperature, data_pressure, data)

    result = function(temperature,pressure)[0][0]
    
    return result

#%% 
def specific_heat(temperature,pressure, unit,constant):
    
    """
    ========== DESCRIPTION ==========

    This function return the specific heat of pure Helium 4

    ========== VALIDITY ==========

    <temperature> : [0.8 -> 400]
    <pressure> : [1 -> 1e6] 

    ========== FROM ==========

    HEPAK was written by Vincent Arp, Bob McCarty, and Jeff Fox, formerly of 
    NIST and later of Cryodata, using code from Brian Hands while at the 
    Oxford University Cryogenics Laboratory.


    ========== INPUT ==========

    <temperature>
        -- float --
        The temperature of pure helium 4
        [K]

    <pressure>
        -- float --
        The pressure of pure helium 4
        [Pa]
        
    <unit>
        -- string --
        Either kg or mol

    <constant>
        -- string --
        Either p or v

    ========== OUTPUT ==========

    <specific_heat>
        -- float --
        The specific heat of pure helium 4
        if 'kg' : [J].[kg]**(-1)
        if 'mol' : [J].[mol]**(-1)

    ========== STATUS ==========

    Status : Checked 2024-02-27
    
    ========== UPDATE ==========
    

    """
    
    ################## PACKAGES ###############################################
    
    import scipy.interpolate
    import numpy
    
    ################## CONDITIONS #############################################
    
    assert temperature >= 0.8 and temperature <= 400 , 'The function helium4.internal_energy is not valid for T = ' + str(temperature) + ' K'
    assert pressure >= 1 and pressure <=  1e6, 'The function helium4.internal_energy  is not valid for P = ' + str(pressure) + ' Pa'
    
    ################## INITIALISATION #########################################
    
    data_temperature = numpy.array([0.8,0.9,1,1.1,1.2,1.3,1.4,1.5,1.6,1.7,1.8,1.9,2,2.1,2.2,2.3,2.4,2.5,2.6,2.7,2.8,2.9,3,3.1,3.2,3.3,3.4,3.5,3.6,3.7,3.8,3.9,4,4.1,4.2,4.3,4.4,4.5,4.6,4.7,4.8,4.9,5,5.5,6,8,10,15,20,30,40,50,70,100,120,150,200,250,300,350,400])
    data_pressure = numpy.array([1, 2, 5, 1e1, 2e1, 5e1, 1e2, 2e2, 5e2, 1e3, 2e3, 5e3, 1e4, 2e4, 5e4, 1e5, 2e5, 5e5, 1e6])
    
    if constant == 'p':
        data =		    [[5200.0, 22.4, 22.4, 22.4, 22.4, 22.4, 22.4, 22.4, 22.4, 22.4, 22.4, 22.4, 22.4, 22.4, 22.4, 22.4, 21.9, 20.1, 29.5], \
        				 [5200.0, 5210.0, 5230.0, 49.7, 49.7, 49.7, 49.7, 49.7, 49.7, 49.7, 49.7, 49.7, 49.7, 49.8, 50.1, 50.6, 51.2, 52.1, 68.0], \
        				 [5200.0, 5200.0, 5210.0, 5240.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 101.0, 101.0, 102.0, 104.0, 109.0, 133.0], \
        				 [5200.0, 5200.0, 5210.0, 5220.0, 5250.0, 185.0, 185.0, 185.0, 185.0, 185.0, 185.0, 185.0, 186.0, 186.0, 187.0, 189.0, 192.0, 203.0, 237.0], \
        				 [5200.0, 5200.0, 5200.0, 5210.0, 5230.0, 5300.0, 318.0, 318.0, 318.0, 318.0, 318.0, 318.0, 318.0, 318.0, 320.0, 322.0, 328.0, 346.0, 393.0], \
        				 [5190.0, 5200.0, 5200.0, 5210.0, 5220.0, 5270.0, 5340.0, 511.0, 511.0, 511.0, 511.0, 511.0, 512.0, 512.0, 514.0, 517.0, 524.0, 553.0, 615.0], \
        				 [5190.0, 5200.0, 5200.0, 5200.0, 5210.0, 5250.0, 5300.0, 5410.0, 780.0, 780.0, 780.0, 780.0, 780.0, 781.0, 783.0, 787.0, 797.0, 838.0, 919.0], \
        				 [5190.0, 5190.0, 5200.0, 5200.0, 5210.0, 5230.0, 5270.0, 5350.0, 1140.0, 1140.0, 1140.0, 1140.0, 1140.0, 1140.0, 1140.0, 1150.0, 1160.0, 1220.0, 1320.0], \
        				 [5190.0, 5190.0, 5200.0, 5200.0, 5210.0, 5220.0, 5250.0, 5310.0, 5500.0, 1600.0, 1600.0, 1600.0, 1600.0, 1600.0, 1610.0, 1610.0, 1630.0, 1710.0, 1840.0], \
        				 [5190.0, 5190.0, 5200.0, 5200.0, 5200.0, 5220.0, 5240.0, 5290.0, 5430.0, 5670.0, 2190.0, 2190.0, 2190.0, 2200.0, 2200.0, 2210.0, 2230.0, 2330.0, 2510.0], \
        				 [5190.0, 5190.0, 5190.0, 5200.0, 5200.0, 5210.0, 5230.0, 5270.0, 5380.0, 5570.0, 2940.0, 2940.0, 2940.0, 2940.0, 2950.0, 2960.0, 2990.0, 3120.0, 3380.0], \
        				 [5190.0, 5190.0, 5190.0, 5200.0, 5200.0, 5210.0, 5220.0, 5250.0, 5340.0, 5490.0, 5800.0, 3890.0, 3900.0, 3900.0, 3910.0, 3930.0, 3970.0, 4150.0, 4580.0], \
        				 [5190.0, 5190.0, 5190.0, 5200.0, 5200.0, 5200.0, 5220.0, 5240.0, 5310.0, 5430.0, 5680.0, 5190.0, 5190.0, 5200.0, 5220.0, 5250.0, 5320.0, 5600.0, 6540.0], \
        				 [5190.0, 5190.0, 5190.0, 5190.0, 5200.0, 5200.0, 5210.0, 5230.0, 5290.0, 5390.0, 5590.0, 7250.0, 7250.0, 7270.0, 7320.0, 7400.0, 7590.0, 8520.0, 3030.0], \
        				 [5190.0, 5190.0, 5190.0, 5190.0, 5200.0, 5200.0, 5210.0, 5230.0, 5270.0, 5350.0, 5520.0, 6050.0, 4200.0, 4140.0, 4000.0, 3780.0, 3420.0, 2700.0, 2030.0], \
        				 [5190.0, 5190.0, 5190.0, 5190.0, 5200.0, 5200.0, 5210.0, 5220.0, 5260.0, 5330.0, 5470.0, 5900.0, 2680.0, 2670.0, 2630.0, 2560.0, 2450.0, 2150.0, 1800.0], \
        				 [5190.0, 5190.0, 5190.0, 5190.0, 5200.0, 5200.0, 5200.0, 5220.0, 5250.0, 5310.0, 5420.0, 5790.0, 2370.0, 2360.0, 2330.0, 2280.0, 2200.0, 1990.0, 1730.0], \
        				 [5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5200.0, 5200.0, 5210.0, 5240.0, 5290.0, 5390.0, 5700.0, 6260.0, 2270.0, 2240.0, 2200.0, 2130.0, 1970.0, 1780.0], \
        				 [5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5200.0, 5200.0, 5210.0, 5230.0, 5280.0, 5360.0, 5620.0, 6100.0, 2310.0, 2280.0, 2230.0, 2150.0, 1980.0, 1780.0], \
        				 [5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5200.0, 5200.0, 5210.0, 5230.0, 5260.0, 5340.0, 5560.0, 5970.0, 2350.0, 2310.0, 2260.0, 2170.0, 1970.0, 1760.0], \
        				 [5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5200.0, 5200.0, 5210.0, 5220.0, 5260.0, 5320.0, 5520.0, 5870.0, 2400.0, 2360.0, 2310.0, 2210.0, 1990.0, 1760.0], \
        				 [5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5200.0, 5200.0, 5200.0, 5220.0, 5250.0, 5300.0, 5480.0, 5780.0, 6490.0, 2450.0, 2390.0, 2280.0, 2050.0, 1810.0], \
        				 [5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5200.0, 5200.0, 5200.0, 5220.0, 5240.0, 5290.0, 5440.0, 5710.0, 6320.0, 2560.0, 2500.0, 2390.0, 2150.0, 1900.0], \
        				 [5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5200.0, 5200.0, 5200.0, 5210.0, 5240.0, 5280.0, 5410.0, 5650.0, 6190.0, 2710.0, 2630.0, 2510.0, 2260.0, 2010.0], \
        				 [5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5200.0, 5200.0, 5210.0, 5230.0, 5270.0, 5390.0, 5600.0, 6070.0, 2860.0, 2780.0, 2650.0, 2390.0, 2120.0], \
        				 [5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5200.0, 5200.0, 5210.0, 5230.0, 5260.0, 5370.0, 5560.0, 5980.0, 3030.0, 2940.0, 2800.0, 2510.0, 2220.0], \
        				 [5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5200.0, 5200.0, 5210.0, 5220.0, 5260.0, 5350.0, 5520.0, 5900.0, 3210.0, 3110.0, 2940.0, 2630.0, 2330.0], \
        				 [5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5200.0, 5200.0, 5210.0, 5220.0, 5250.0, 5340.0, 5490.0, 5830.0, 3400.0, 3280.0, 3090.0, 2750.0, 2430.0], \
        				 [5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5200.0, 5200.0, 5210.0, 5220.0, 5240.0, 5320.0, 5460.0, 5770.0, 7100.0, 3460.0, 3250.0, 2860.0, 2530.0], \
        				 [5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5200.0, 5200.0, 5200.0, 5220.0, 5240.0, 5310.0, 5440.0, 5710.0, 6890.0, 3660.0, 3400.0, 2980.0, 2620.0], \
        				 [5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5200.0, 5200.0, 5200.0, 5210.0, 5240.0, 5300.0, 5420.0, 5670.0, 6710.0, 3870.0, 3570.0, 3090.0, 2710.0], \
        				 [5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5200.0, 5200.0, 5200.0, 5210.0, 5230.0, 5290.0, 5400.0, 5630.0, 6560.0, 4120.0, 3750.0, 3210.0, 2800.0], \
        				 [5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5200.0, 5200.0, 5210.0, 5230.0, 5290.0, 5380.0, 5600.0, 6430.0, 4400.0, 3940.0, 3320.0, 2880.0], \
        				 [5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5200.0, 5200.0, 5210.0, 5230.0, 5280.0, 5370.0, 5570.0, 6320.0, 4730.0, 4150.0, 3440.0, 2960.0], \
        				 [5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5200.0, 5200.0, 5210.0, 5220.0, 5270.0, 5360.0, 5540.0, 6230.0, 5160.0, 4390.0, 3560.0, 3040.0], \
        				 [5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5200.0, 5200.0, 5210.0, 5220.0, 5270.0, 5350.0, 5510.0, 6150.0, 8510.0, 4680.0, 3680.0, 3130.0], \
        				 [5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5200.0, 5200.0, 5210.0, 5220.0, 5260.0, 5340.0, 5490.0, 6070.0, 8060.0, 5010.0, 3820.0, 3210.0], \
        				 [5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5200.0, 5200.0, 5210.0, 5220.0, 5260.0, 5330.0, 5470.0, 6010.0, 7710.0, 5430.0, 3950.0, 3290.0], \
        				 [5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5200.0, 5200.0, 5210.0, 5220.0, 5260.0, 5320.0, 5460.0, 5950.0, 7440.0, 5980.0, 4100.0, 3370.0], \
        				 [5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5200.0, 5200.0, 5200.0, 5220.0, 5250.0, 5310.0, 5440.0, 5900.0, 7210.0, 6750.0, 4260.0, 3450.0], \
        				 [5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5200.0, 5200.0, 5200.0, 5210.0, 5250.0, 5310.0, 5430.0, 5860.0, 7030.0, 7940.0, 4440.0, 3540.0], \
        				 [5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5200.0, 5200.0, 5200.0, 5210.0, 5250.0, 5300.0, 5410.0, 5820.0, 6870.0, 10200.0, 4630.0, 3630.0], \
        				 [5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5200.0, 5200.0, 5200.0, 5210.0, 5240.0, 5290.0, 5400.0, 5780.0, 6740.0, 16600.0, 4850.0, 3720.0], \
        				 [5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5200.0, 5200.0, 5210.0, 5230.0, 5270.0, 5360.0, 5640.0, 6280.0, 9740.0, 6430.0, 4220.0], \
        				 [5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5200.0, 5200.0, 5210.0, 5220.0, 5260.0, 5320.0, 5550.0, 6010.0, 7740.0, 10000.0, 4850.0], \
        				 [5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5200.0, 5200.0, 5210.0, 5230.0, 5260.0, 5370.0, 5570.0, 6060.0, 8510.0, 8250.0], \
        				 [5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5200.0, 5200.0, 5200.0, 5220.0, 5240.0, 5310.0, 5430.0, 5680.0, 6630.0, 7820.0], \
        				 [5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5200.0, 5200.0, 5200.0, 5210.0, 5240.0, 5290.0, 5400.0, 5710.0, 6200.0], \
        				 [5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5200.0, 5200.0, 5200.0, 5220.0, 5250.0, 5310.0, 5470.0, 5730.0], \
        				 [5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5200.0, 5200.0, 5210.0, 5220.0, 5240.0, 5310.0, 5420.0], \
        				 [5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5200.0, 5200.0, 5210.0, 5220.0, 5260.0, 5320.0], \
        				 [5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5200.0, 5200.0, 5210.0, 5230.0, 5270.0], \
        				 [5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5200.0, 5200.0, 5210.0, 5230.0], \
        				 [5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5200.0, 5200.0, 5210.0], \
        				 [5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5200.0, 5200.0], \
        				 [5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5200.0], \
        				 [5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0], \
        				 [5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0], \
        				 [5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0], \
        				 [5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0], \
        				 [5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0, 5190.0]]
            
        
    if constant == 'v':
        data =		[[3120.0, 22.4, 22.4, 22.4, 22.4, 22.4, 22.4, 22.4, 22.4, 22.4, 22.4, 22.4, 22.4, 22.4, 22.4, 22.4, 21.9, 20.1, 29.5], \
        				 [3120.0, 3120.0, 3130.0, 49.6, 49.6, 49.6, 49.6, 49.6, 49.7, 49.7, 49.7, 49.7, 49.7, 49.8, 50.1, 50.6, 51.2, 52.1, 67.9], \
        				 [3120.0, 3120.0, 3130.0, 3140.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 101.0, 101.0, 102.0, 104.0, 109.0, 133.0], \
        				 [3120.0, 3120.0, 3120.0, 3130.0, 3150.0, 185.0, 185.0, 185.0, 185.0, 185.0, 185.0, 185.0, 186.0, 186.0, 187.0, 189.0, 192.0, 203.0, 236.0], \
        				 [3120.0, 3120.0, 3120.0, 3130.0, 3140.0, 3170.0, 318.0, 318.0, 318.0, 318.0, 318.0, 318.0, 318.0, 318.0, 320.0, 322.0, 328.0, 346.0, 391.0], \
        				 [3120.0, 3120.0, 3120.0, 3120.0, 3130.0, 3150.0, 3190.0, 511.0, 511.0, 511.0, 511.0, 511.0, 511.0, 512.0, 514.0, 517.0, 524.0, 552.0, 611.0], \
        				 [3120.0, 3120.0, 3120.0, 3120.0, 3130.0, 3140.0, 3170.0, 3220.0, 780.0, 780.0, 780.0, 780.0, 780.0, 781.0, 783.0, 787.0, 796.0, 836.0, 911.0], \
        				 [3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3140.0, 3160.0, 3200.0, 1140.0, 1140.0, 1140.0, 1140.0, 1140.0, 1140.0, 1140.0, 1150.0, 1160.0, 1210.0, 1310.0], \
        				 [3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3130.0, 3150.0, 3180.0, 3270.0, 1600.0, 1600.0, 1600.0, 1600.0, 1600.0, 1610.0, 1610.0, 1630.0, 1700.0, 1820.0], \
        				 [3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3130.0, 3140.0, 3160.0, 3230.0, 3340.0, 2190.0, 2190.0, 2190.0, 2190.0, 2200.0, 2200.0, 2220.0, 2310.0, 2480.0], \
        				 [3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3130.0, 3150.0, 3200.0, 3290.0, 2940.0, 2940.0, 2940.0, 2940.0, 2940.0, 2950.0, 2980.0, 3090.0, 3320.0], \
        				 [3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3130.0, 3140.0, 3180.0, 3250.0, 3390.0, 3890.0, 3890.0, 3890.0, 3900.0, 3920.0, 3950.0, 4100.0, 4460.0], \
        				 [3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3130.0, 3140.0, 3170.0, 3230.0, 3330.0, 5180.0, 5180.0, 5190.0, 5200.0, 5230.0, 5280.0, 5510.0, 6240.0], \
        				 [3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3130.0, 3160.0, 3200.0, 3290.0, 7220.0, 7220.0, 7240.0, 7280.0, 7350.0, 7500.0, 8270.0, 3030.0], \
        				 [3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3130.0, 3150.0, 3190.0, 3260.0, 3460.0, 4190.0, 4130.0, 3980.0, 3760.0, 3410.0, 2680.0, 2000.0], \
        				 [3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3130.0, 3140.0, 3170.0, 3230.0, 3400.0, 2610.0, 2600.0, 2560.0, 2500.0, 2390.0, 2100.0, 1750.0], \
        				 [3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3130.0, 3140.0, 3160.0, 3210.0, 3350.0, 2250.0, 2240.0, 2210.0, 2170.0, 2100.0, 1900.0, 1650.0], \
        				 [3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3130.0, 3150.0, 3190.0, 3300.0, 3490.0, 2100.0, 2080.0, 2050.0, 2000.0, 1860.0, 1690.0], \
        				 [3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3130.0, 3150.0, 3180.0, 3270.0, 3420.0, 2080.0, 2060.0, 2030.0, 1970.0, 1830.0, 1660.0], \
        				 [3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3130.0, 3140.0, 3170.0, 3250.0, 3370.0, 2050.0, 2030.0, 2000.0, 1940.0, 1790.0, 1620.0], \
        				 [3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3130.0, 3140.0, 3160.0, 3220.0, 3330.0, 2030.0, 2010.0, 1980.0, 1920.0, 1770.0, 1600.0], \
        				 [3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3130.0, 3130.0, 3150.0, 3210.0, 3290.0, 3460.0, 2020.0, 1980.0, 1930.0, 1790.0, 1620.0], \
        				 [3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3130.0, 3150.0, 3190.0, 3270.0, 3400.0, 2050.0, 2020.0, 1970.0, 1840.0, 1680.0], \
        				 [3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3130.0, 3140.0, 3180.0, 3240.0, 3360.0, 2100.0, 2070.0, 2020.0, 1900.0, 1750.0], \
        				 [3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3130.0, 3140.0, 3170.0, 3220.0, 3320.0, 2160.0, 2130.0, 2090.0, 1970.0, 1830.0], \
        				 [3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3130.0, 3130.0, 3160.0, 3210.0, 3290.0, 2220.0, 2200.0, 2150.0, 2040.0, 1900.0], \
        				 [3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3130.0, 3160.0, 3190.0, 3270.0, 2280.0, 2250.0, 2210.0, 2100.0, 1970.0], \
        				 [3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3130.0, 3150.0, 3180.0, 3250.0, 2330.0, 2310.0, 2260.0, 2160.0, 2030.0], \
        				 [3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3130.0, 3150.0, 3170.0, 3230.0, 3350.0, 2350.0, 2310.0, 2210.0, 2080.0], \
        				 [3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3130.0, 3140.0, 3170.0, 3210.0, 3320.0, 2390.0, 2350.0, 2250.0, 2130.0], \
        				 [3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3140.0, 3160.0, 3200.0, 3290.0, 2430.0, 2390.0, 2290.0, 2170.0], \
        				 [3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3130.0, 3150.0, 3190.0, 3270.0, 2470.0, 2420.0, 2320.0, 2210.0], \
        				 [3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3130.0, 3150.0, 3180.0, 3250.0, 2490.0, 2450.0, 2350.0, 2240.0], \
        				 [3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3130.0, 3140.0, 3170.0, 3230.0, 2520.0, 2480.0, 2380.0, 2270.0], \
        				 [3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3130.0, 3140.0, 3160.0, 3220.0, 2550.0, 2500.0, 2400.0, 2290.0], \
        				 [3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3130.0, 3140.0, 3160.0, 3200.0, 3230.0, 2520.0, 2420.0, 2310.0], \
        				 [3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3130.0, 3150.0, 3190.0, 3220.0, 2540.0, 2440.0, 2330.0], \
        				 [3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3130.0, 3150.0, 3180.0, 3210.0, 2560.0, 2460.0, 2350.0], \
        				 [3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3130.0, 3140.0, 3170.0, 3190.0, 2580.0, 2470.0, 2360.0], \
        				 [3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3130.0, 3140.0, 3160.0, 3180.0, 2600.0, 2480.0, 2380.0], \
        				 [3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3130.0, 3130.0, 3160.0, 3170.0, 2620.0, 2500.0, 2390.0], \
        				 [3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3130.0, 3150.0, 3170.0, 2650.0, 2510.0, 2400.0], \
        				 [3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3130.0, 3150.0, 3160.0, 2700.0, 2520.0, 2420.0], \
        				 [3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3130.0, 3130.0, 3100.0, 2590.0, 2470.0], \
        				 [3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3100.0, 2690.0, 2530.0], \
        				 [3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3110.0, 3110.0, 3100.0, 3030.0, 2810.0], \
        				 [3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3110.0, 3110.0, 3090.0, 3010.0], \
        				 [3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3130.0, 3140.0], \
        				 [3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3130.0, 3140.0, 3160.0], \
        				 [3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3130.0, 3150.0], \
        				 [3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3130.0, 3140.0], \
        				 [3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3130.0, 3140.0], \
        				 [3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3130.0], \
        				 [3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0], \
        				 [3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0], \
        				 [3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0], \
        				 [3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0], \
        				 [3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0], \
        				 [3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0], \
        				 [3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0], \
        				 [3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0, 3120.0]]
            

    ################## FUNCTION ###############################################
    
    function = scipy.interpolate.RectBivariateSpline(data_temperature, data_pressure, data)

    result = function(temperature,pressure)[0][0]
    
    if unit == 'kg':
        return result
    
    if unit == 'mol':
        return result*molar_mass()

#%% 
def specific_volume(temperature,pressure):
    
    """
    ========== DESCRIPTION ==========

    This function return the specific volume of pure Helium 4

    ========== VALIDITY ==========

    <temperature> : [0.8 -> 400]
    <pressure> : [1 -> 1e6] 

    ========== FROM ==========

    HEPAK was written by Vincent Arp, Bob McCarty, and Jeff Fox, formerly of 
    NIST and later of Cryodata, using code from Brian Hands while at the 
    Oxford University Cryogenics Laboratory.


    ========== INPUT ==========

    <temperature>
        -- float --
        The temperature of pure helium 4
        [K]

    <pressure>
        -- float --
        The pressure of pure helium 4
        [Pa]

    ========== OUTPUT ==========

    <specific_volume>
        -- float --
        The specific volume of pure helium 4
        [m]**3.[kg]**(-1)

    ========== STATUS ==========

    Status : Checked 2024-02-27
    
    ========== UPDATE ==========
    

    """
    
    ################## PACKAGES ###############################################
    
    ################## CONDITIONS #############################################
    
    ################## INITIALISATION #########################################
    
    ################## FUNCTION ###############################################
    
    result = 1/density(temperature,pressure)
    
    return result

#%% 
def thermal_conductivity(temperature,pressure):
    
    """
    ========== DESCRIPTION ==========

    This function return the thermal conductivity of pure Helium 4

    ========== VALIDITY ==========

    <temperature> : [0.8 -> 400]
    <pressure> : [1 -> 1e6] 

    ========== FROM ==========

    HEPAK was written by Vincent Arp, Bob McCarty, and Jeff Fox, formerly of 
    NIST and later of Cryodata, using code from Brian Hands while at the 
    Oxford University Cryogenics Laboratory.


    ========== INPUT ==========

    <temperature>
        -- float --
        The temperature of pure helium 4
        [K]

    <pressure>
        -- float --
        The pressure of pure helium 4
        [Pa]

    ========== OUTPUT ==========

    <thermal_conductivity>
        -- float --
        The thermal conductivity of pure helium 4
        [W].[m]**(-1).[K]**(-1)

    ========== STATUS ==========

    Status : Checked 2024-02-27
    
    ========== UPDATE ==========
    

    """
    
    ################## PACKAGES ###############################################
    
    import scipy.interpolate
    import numpy
    
    ################## CONDITIONS #############################################
    
    assert temperature >= 0.8 and temperature <= 400 , 'The function helium4.thermal_conductivity is not valid for T = ' + str(temperature) + ' K'
    assert pressure >= 1 and pressure <=  1e6, 'The function helium4.thermal_conductivity  is not valid for P = ' + str(pressure) + ' Pa'
    
    ################## INITIALISATION #########################################
    
    data_temperature = numpy.array([0.8,0.9,1,1.1,1.2,1.3,1.4,1.5,1.6,1.7,1.8,1.9,2,2.1,2.2,2.3,2.4,2.5,2.6,2.7,2.8,2.9,3,3.1,3.2,3.3,3.4,3.5,3.6,3.7,3.8,3.9,4,4.1,4.2,4.3,4.4,4.5,4.6,4.7,4.8,4.9,5,5.5,6,8,10,15,20,30,40,50,70,100,120,150,200,250,300,350,400])
    data_pressure = numpy.array([1, 2, 5, 1e1, 2e1, 5e1, 1e2, 2e2, 5e2, 1e3, 2e3, 5e3, 1e4, 2e4, 5e4, 1e5, 2e5, 5e5, 1e6])
    data =		[[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], \
				 [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], \
				 [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], \
				 [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], \
				 [0.0023, 0.0023, 0.0023, 0.0023, 0.0023, 0.0023, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], \
				 [0.00249, 0.00249, 0.00249, 0.00249, 0.00249, 0.00249, 0.00249, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], \
				 [0.00268, 0.00268, 0.00268, 0.00268, 0.00268, 0.00268, 0.00268, 0.00269, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], \
				 [0.00287, 0.00287, 0.00287, 0.00287, 0.00287, 0.00288, 0.00288, 0.00288, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], \
				 [0.00307, 0.00307, 0.00307, 0.00307, 0.00307, 0.00307, 0.00307, 0.00307, 0.00307, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], \
				 [0.00326, 0.00326, 0.00326, 0.00326, 0.00326, 0.00326, 0.00326, 0.00326, 0.00326, 0.00327, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], \
				 [0.00345, 0.00345, 0.00345, 0.00345, 0.00345, 0.00345, 0.00345, 0.00345, 0.00346, 0.00346, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], \
				 [0.00364, 0.00364, 0.00364, 0.00364, 0.00364, 0.00364, 0.00364, 0.00364, 0.00365, 0.00365, 0.00367, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], \
				 [0.00383, 0.00383, 0.00383, 0.00383, 0.00383, 0.00383, 0.00383, 0.00384, 0.00384, 0.00384, 0.00386, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], \
				 [0.00402, 0.00402, 0.00402, 0.00402, 0.00402, 0.00402, 0.00403, 0.00403, 0.00403, 0.00404, 0.00405, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], \
				 [0.00422, 0.00422, 0.00422, 0.00422, 0.00422, 0.00422, 0.00422, 0.00422, 0.00422, 0.00423, 0.00424, 0.00427, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], \
				 [0.00441, 0.00441, 0.00441, 0.00441, 0.00441, 0.00441, 0.00441, 0.00441, 0.00441, 0.00442, 0.00443, 0.00446, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], \
				 [0.0046, 0.0046, 0.0046, 0.0046, 0.0046, 0.0046, 0.0046, 0.0046, 0.0046, 0.00461, 0.00462, 0.00465, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], \
				 [0.00479, 0.00479, 0.00479, 0.00479, 0.00479, 0.00479, 0.00479, 0.00479, 0.0048, 0.0048, 0.00481, 0.00484, 0.00489, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], \
				 [0.00498, 0.00498, 0.00498, 0.00498, 0.00498, 0.00498, 0.00498, 0.00498, 0.00499, 0.00499, 0.005, 0.00503, 0.00508, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], \
				 [0.00517, 0.00517, 0.00517, 0.00517, 0.00517, 0.00517, 0.00518, 0.00518, 0.00518, 0.00518, 0.00519, 0.00522, 0.00526, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], \
				 [0.00537, 0.00537, 0.00537, 0.00537, 0.00537, 0.00537, 0.00537, 0.00537, 0.00537, 0.00537, 0.00538, 0.00541, 0.00545, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], \
				 [0.00556, 0.00556, 0.00556, 0.00556, 0.00556, 0.00556, 0.00556, 0.00556, 0.00556, 0.00557, 0.00557, 0.0056, 0.00564, 0.00573, 0.0, 0.0, 0.0, 0.0, 0.0], \
				 [0.00575, 0.00575, 0.00575, 0.00575, 0.00575, 0.00575, 0.00575, 0.00575, 0.00575, 0.00576, 0.00576, 0.00579, 0.00583, 0.00592, 0.0, 0.0, 0.0, 0.0, 0.0], \
				 [0.00594, 0.00594, 0.00594, 0.00594, 0.00594, 0.00594, 0.00594, 0.00594, 0.00594, 0.00595, 0.00596, 0.00598, 0.00602, 0.0061, 0.0, 0.0, 0.0, 0.0, 0.0], \
				 [0.00613, 0.00613, 0.00613, 0.00613, 0.00613, 0.00613, 0.00613, 0.00613, 0.00614, 0.00614, 0.00615, 0.00617, 0.00621, 0.00629, 0.0, 0.0, 0.0, 0.0, 0.0], \
				 [0.00632, 0.00632, 0.00632, 0.00632, 0.00632, 0.00632, 0.00632, 0.00633, 0.00633, 0.00633, 0.00634, 0.00636, 0.0064, 0.00647, 0.0, 0.0, 0.0, 0.0, 0.0], \
				 [0.00652, 0.00652, 0.00652, 0.00652, 0.00652, 0.00652, 0.00652, 0.00652, 0.00652, 0.00652, 0.00653, 0.00655, 0.00658, 0.00666, 0.0, 0.0, 0.0, 0.0, 0.0], \
				 [0.0067, 0.0067, 0.0067, 0.0067, 0.0067, 0.0067, 0.0067, 0.0067, 0.00671, 0.00671, 0.00671, 0.00673, 0.00676, 0.00683, 0.0178, 0.018, 0.0185, 0.0197, 0.0212], \
				 [0.0069, 0.0069, 0.0069, 0.0069, 0.0069, 0.0069, 0.0069, 0.0069, 0.0069, 0.00691, 0.00691, 0.00693, 0.00696, 0.00703, 0.00728, 0.0182, 0.0187, 0.0199, 0.0215], \
				 [0.0071, 0.0071, 0.0071, 0.0071, 0.0071, 0.0071, 0.0071, 0.0071, 0.0071, 0.0071, 0.00711, 0.00713, 0.00716, 0.00722, 0.00746, 0.0183, 0.0189, 0.0202, 0.0218], \
				 [0.0073, 0.0073, 0.0073, 0.0073, 0.0073, 0.0073, 0.0073, 0.0073, 0.0073, 0.0073, 0.00731, 0.00732, 0.00735, 0.00741, 0.00765, 0.0185, 0.0191, 0.0204, 0.0221], \
				 [0.00749, 0.00749, 0.00749, 0.00749, 0.00749, 0.00749, 0.00749, 0.00749, 0.00749, 0.0075, 0.0075, 0.00752, 0.00755, 0.00761, 0.00783, 0.0186, 0.0192, 0.0206, 0.0224], \
				 [0.00769, 0.00769, 0.00769, 0.00769, 0.00769, 0.00769, 0.00769, 0.00769, 0.00769, 0.00769, 0.0077, 0.00771, 0.00774, 0.0078, 0.00801, 0.0186, 0.0193, 0.0208, 0.0227], \
				 [0.00788, 0.00788, 0.00788, 0.00788, 0.00788, 0.00788, 0.00788, 0.00788, 0.00788, 0.00788, 0.00789, 0.0079, 0.00793, 0.00799, 0.0082, 0.0187, 0.0194, 0.021, 0.023], \
				 [0.00807, 0.00807, 0.00807, 0.00807, 0.00807, 0.00807, 0.00807, 0.00807, 0.00807, 0.00808, 0.00808, 0.0081, 0.00812, 0.00818, 0.00838, 0.0187, 0.0195, 0.0212, 0.0232], \
				 [0.00826, 0.00826, 0.00826, 0.00826, 0.00826, 0.00826, 0.00826, 0.00826, 0.00826, 0.00827, 0.00827, 0.00829, 0.00831, 0.00836, 0.00856, 0.00912, 0.0195, 0.0213, 0.0234], \
				 [0.00845, 0.00845, 0.00845, 0.00845, 0.00845, 0.00845, 0.00845, 0.00845, 0.00845, 0.00846, 0.00846, 0.00847, 0.0085, 0.00855, 0.00874, 0.00928, 0.0195, 0.0215, 0.0236], \
				 [0.00864, 0.00864, 0.00864, 0.00864, 0.00864, 0.00864, 0.00864, 0.00864, 0.00864, 0.00864, 0.00865, 0.00866, 0.00868, 0.00873, 0.00892, 0.00943, 0.0195, 0.0216, 0.0238], \
				 [0.00882, 0.00882, 0.00882, 0.00882, 0.00882, 0.00882, 0.00882, 0.00883, 0.00883, 0.00883, 0.00883, 0.00885, 0.00887, 0.00892, 0.0091, 0.00959, 0.0195, 0.0217, 0.024], \
				 [0.00901, 0.00901, 0.00901, 0.00901, 0.00901, 0.00901, 0.00901, 0.00901, 0.00901, 0.00901, 0.00902, 0.00903, 0.00905, 0.0091, 0.00928, 0.00974, 0.0194, 0.0217, 0.0242], \
				 [0.00919, 0.00919, 0.00919, 0.00919, 0.00919, 0.00919, 0.00919, 0.00919, 0.00919, 0.00919, 0.0092, 0.00921, 0.00923, 0.00928, 0.00945, 0.0099, 0.0194, 0.0218, 0.0244], \
				 [0.00937, 0.00937, 0.00937, 0.00937, 0.00937, 0.00937, 0.00937, 0.00937, 0.00937, 0.00938, 0.00938, 0.00939, 0.00941, 0.00946, 0.00963, 0.0101, 0.0193, 0.0218, 0.0245], \
				 [0.00955, 0.00955, 0.00955, 0.00955, 0.00955, 0.00955, 0.00955, 0.00955, 0.00955, 0.00955, 0.00956, 0.00957, 0.00959, 0.00963, 0.0098, 0.0102, 0.0193, 0.0219, 0.0246], \
				 [0.0104, 0.0104, 0.0104, 0.0104, 0.0104, 0.0104, 0.0104, 0.0104, 0.0104, 0.0104, 0.0104, 0.0104, 0.0105, 0.0105, 0.0106, 0.011, 0.0125, 0.0218, 0.0251], \
				 [0.0112, 0.0112, 0.0112, 0.0112, 0.0112, 0.0112, 0.0112, 0.0112, 0.0112, 0.0112, 0.0112, 0.0113, 0.0113, 0.0113, 0.0114, 0.0117, 0.0128, 0.0212, 0.0252], \
				 [0.0142, 0.0142, 0.0142, 0.0142, 0.0142, 0.0142, 0.0142, 0.0142, 0.0142, 0.0142, 0.0142, 0.0142, 0.0142, 0.0142, 0.0143, 0.0145, 0.015, 0.0177, 0.0235], \
				 [0.0166, 0.0166, 0.0166, 0.0166, 0.0166, 0.0166, 0.0166, 0.0166, 0.0166, 0.0166, 0.0166, 0.0166, 0.0166, 0.0167, 0.0167, 0.0169, 0.0173, 0.0191, 0.0229], \
				 [0.0217, 0.0217, 0.0217, 0.0217, 0.0217, 0.0217, 0.0217, 0.0217, 0.0217, 0.0217, 0.0217, 0.0217, 0.0218, 0.0218, 0.0218, 0.0219, 0.0222, 0.0233, 0.0256], \
				 [0.0261, 0.0261, 0.0261, 0.0261, 0.0261, 0.0261, 0.0261, 0.0261, 0.0261, 0.0261, 0.0261, 0.0261, 0.0261, 0.0261, 0.0261, 0.0262, 0.0264, 0.0273, 0.029], \
				 [0.0336, 0.0336, 0.0336, 0.0336, 0.0336, 0.0336, 0.0336, 0.0336, 0.0336, 0.0336, 0.0336, 0.0336, 0.0336, 0.0336, 0.0337, 0.0337, 0.0339, 0.0345, 0.0357], \
				 [0.0404, 0.0404, 0.0404, 0.0404, 0.0404, 0.0404, 0.0404, 0.0404, 0.0404, 0.0404, 0.0404, 0.0404, 0.0404, 0.0404, 0.0404, 0.0404, 0.0406, 0.041, 0.042], \
				 [0.0466, 0.0466, 0.0466, 0.0466, 0.0466, 0.0466, 0.0466, 0.0466, 0.0466, 0.0466, 0.0466, 0.0466, 0.0466, 0.0466, 0.0466, 0.0467, 0.0468, 0.0472, 0.048], \
				 [0.0581, 0.0581, 0.0581, 0.0581, 0.0581, 0.0581, 0.0581, 0.0581, 0.0581, 0.0581, 0.0581, 0.0581, 0.0581, 0.0581, 0.0581, 0.0581, 0.0582, 0.0586, 0.0592], \
				 [0.0736, 0.0736, 0.0736, 0.0736, 0.0736, 0.0736, 0.0736, 0.0736, 0.0736, 0.0736, 0.0736, 0.0736, 0.0736, 0.0736, 0.0737, 0.0737, 0.0738, 0.0741, 0.0746], \
				 [0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0834, 0.0837, 0.0842], \
				 [0.0969, 0.0969, 0.0969, 0.0969, 0.0969, 0.0969, 0.0969, 0.0969, 0.0969, 0.0969, 0.0969, 0.0969, 0.0969, 0.0969, 0.0969, 0.0969, 0.097, 0.0973, 0.0977], \
				 [0.118, 0.118, 0.118, 0.118, 0.118, 0.118, 0.118, 0.118, 0.118, 0.118, 0.118, 0.118, 0.118, 0.118, 0.118, 0.118, 0.118, 0.118, 0.119], \
				 [0.137, 0.137, 0.137, 0.137, 0.137, 0.137, 0.137, 0.137, 0.137, 0.137, 0.137, 0.137, 0.137, 0.137, 0.137, 0.138, 0.138, 0.138, 0.138], \
				 [0.156, 0.156, 0.156, 0.156, 0.156, 0.156, 0.156, 0.156, 0.156, 0.156, 0.156, 0.156, 0.156, 0.156, 0.156, 0.156, 0.156, 0.156, 0.157], \
				 [0.173, 0.173, 0.173, 0.173, 0.173, 0.173, 0.173, 0.173, 0.173, 0.173, 0.173, 0.173, 0.173, 0.173, 0.173, 0.174, 0.174, 0.174, 0.174], \
				 [0.19, 0.19, 0.19, 0.19, 0.19, 0.19, 0.19, 0.19, 0.19, 0.19, 0.19, 0.19, 0.19, 0.19, 0.19, 0.19, 0.19, 0.191, 0.191]]
    
    
    
    
    
    
    
    
    ################## FUNCTION ###############################################
    
    function = scipy.interpolate.RectBivariateSpline(data_temperature, data_pressure, data)

    result = function(temperature,pressure)[0][0]
    
    return result

#%% 
def dynamic_viscosity(temperature,pressure,):
    
    """
    ========== DESCRIPTION ==========

    This function return the dynamic viscosity of pure Helium 4

    ========== VALIDITY ==========

    <temperature> : [0.8 -> 400]
    <pressure> : [1 -> 1e6] 

    ========== FROM ==========

    HEPAK was written by Vincent Arp, Bob McCarty, and Jeff Fox, formerly of 
    NIST and later of Cryodata, using code from Brian Hands while at the 
    Oxford University Cryogenics Laboratory.


    ========== INPUT ==========

    <temperature>
        -- float --
        The temperature of pure helium 4
        [K]

    <pressure>
        -- float --
        The pressure of pure helium 4
        [Pa]

    ========== OUTPUT ==========

    <dynamic_viscosity>
        -- float --
        The dynamic viscosity of pure helium 4
        [Pa].[s]

    ========== STATUS ==========

    Status : Checked 2024-02-27
    
    ========== UPDATE ==========
    

    """
    
    ################## PACKAGES ###############################################
    
    import scipy.interpolate
    import numpy
    
    ################## CONDITIONS #############################################
    
    assert temperature >= 0.8 and temperature <= 400 , 'The function helium4.dynamic_viscosity is not valid for T = ' + str(temperature) + ' K'
    assert pressure >= 1 and pressure <=  1e6, 'The function helium4.dynamic_viscosity  is not valid for P = ' + str(pressure) + ' Pa'
    
    ################## INITIALISATION #########################################
    
    data_temperature = numpy.array([0.8,0.9,1,1.1,1.2,1.3,1.4,1.5,1.6,1.7,1.8,1.9,2,2.1,2.2,2.3,2.4,2.5,2.6,2.7,2.8,2.9,3,3.1,3.2,3.3,3.4,3.5,3.6,3.7,3.8,3.9,4,4.1,4.2,4.3,4.4,4.5,4.6,4.7,4.8,4.9,5,5.5,6,8,10,15,20,30,40,50,70,100,120,150,200,250,300,350,400])
    data_pressure = numpy.array([1, 2, 5, 1e1, 2e1, 5e1, 1e2, 2e2, 5e2, 1e3, 2e3, 5e3, 1e4, 2e4, 5e4, 1e5, 2e5, 5e5, 1e6])
    data =		[[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], \
				 [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], \
				 [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], \
				 [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], \
				 [3.05e-07, 3.05e-07, 3.05e-07, 3.05e-07, 3.05e-07, 3.05e-07, 2.14e-06, 2.14e-06, 2.14e-06, 2.14e-06, 2.14e-06, 2.14e-06, 2.14e-06, 2.15e-06, 2.18e-06, 2.22e-06, 2.3e-06, 2.5e-06, 2.72e-06], \
				 [3.3e-07, 3.3e-07, 3.3e-07, 3.3e-07, 3.3e-07, 3.3e-07, 3.3e-07, 1.74e-06, 1.74e-06, 1.74e-06, 1.74e-06, 1.74e-06, 1.74e-06, 1.74e-06, 1.76e-06, 1.78e-06, 1.83e-06, 1.95e-06, 2.11e-06], \
				 [3.55e-07, 3.55e-07, 3.55e-07, 3.56e-07, 3.56e-07, 3.56e-07, 3.56e-07, 3.56e-07, 1.52e-06, 1.52e-06, 1.52e-06, 1.52e-06, 1.53e-06, 1.53e-06, 1.54e-06, 1.56e-06, 1.59e-06, 1.69e-06, 1.82e-06], \
				 [3.81e-07, 3.81e-07, 3.81e-07, 3.81e-07, 3.81e-07, 3.81e-07, 3.81e-07, 3.82e-07, 1.41e-06, 1.41e-06, 1.41e-06, 1.41e-06, 1.42e-06, 1.42e-06, 1.43e-06, 1.45e-06, 1.48e-06, 1.57e-06, 1.72e-06], \
				 [4.06e-07, 4.06e-07, 4.06e-07, 4.06e-07, 4.06e-07, 4.06e-07, 4.07e-07, 4.07e-07, 4.08e-07, 1.35e-06, 1.35e-06, 1.36e-06, 1.36e-06, 1.36e-06, 1.37e-06, 1.39e-06, 1.43e-06, 1.53e-06, 1.69e-06], \
				 [4.32e-07, 4.32e-07, 4.32e-07, 4.32e-07, 4.32e-07, 4.32e-07, 4.32e-07, 4.32e-07, 4.33e-07, 4.35e-07, 1.32e-06, 1.32e-06, 1.32e-06, 1.32e-06, 1.34e-06, 1.36e-06, 1.4e-06, 1.52e-06, 1.72e-06], \
				 [4.57e-07, 4.57e-07, 4.57e-07, 4.57e-07, 4.57e-07, 4.57e-07, 4.57e-07, 4.58e-07, 4.58e-07, 4.6e-07, 1.3e-06, 1.3e-06, 1.3e-06, 1.31e-06, 1.32e-06, 1.35e-06, 1.39e-06, 1.54e-06, 1.81e-06], \
				 [4.82e-07, 4.82e-07, 4.82e-07, 4.82e-07, 4.82e-07, 4.83e-07, 4.83e-07, 4.83e-07, 4.84e-07, 4.85e-07, 4.88e-07, 1.34e-06, 1.34e-06, 1.35e-06, 1.36e-06, 1.39e-06, 1.45e-06, 1.63e-06, 2.06e-06], \
				 [5.08e-07, 5.08e-07, 5.08e-07, 5.08e-07, 5.08e-07, 5.08e-07, 5.08e-07, 5.08e-07, 5.09e-07, 5.1e-07, 5.13e-07, 1.49e-06, 1.49e-06, 1.5e-06, 1.52e-06, 1.55e-06, 1.63e-06, 1.92e-06, 2.68e-06], \
				 [5.33e-07, 5.33e-07, 5.33e-07, 5.33e-07, 5.33e-07, 5.33e-07, 5.33e-07, 5.34e-07, 5.34e-07, 5.36e-07, 5.38e-07, 1.87e-06, 1.87e-06, 1.88e-06, 1.91e-06, 1.97e-06, 2.1e-06, 2.63e-06, 3.87e-06], \
				 [5.59e-07, 5.59e-07, 5.59e-07, 5.59e-07, 5.59e-07, 5.59e-07, 5.59e-07, 5.59e-07, 5.6e-07, 5.61e-07, 5.63e-07, 5.71e-07, 2.61e-06, 2.62e-06, 2.65e-06, 2.71e-06, 2.85e-06, 3.31e-06, 4.21e-06], \
				 [5.84e-07, 5.84e-07, 5.84e-07, 5.84e-07, 5.84e-07, 5.84e-07, 5.84e-07, 5.84e-07, 5.85e-07, 5.86e-07, 5.88e-07, 5.95e-07, 2.87e-06, 2.88e-06, 2.91e-06, 2.97e-06, 3.09e-06, 3.54e-06, 4.4e-06], \
				 [6.09e-07, 6.09e-07, 6.09e-07, 6.09e-07, 6.09e-07, 6.09e-07, 6.1e-07, 6.1e-07, 6.1e-07, 6.11e-07, 6.14e-07, 6.2e-07, 3.05e-06, 3.05e-06, 3.09e-06, 3.14e-06, 3.26e-06, 3.68e-06, 4.5e-06], \
				 [6.35e-07, 6.35e-07, 6.35e-07, 6.35e-07, 6.35e-07, 6.35e-07, 6.35e-07, 6.35e-07, 6.36e-07, 6.37e-07, 6.39e-07, 6.45e-07, 6.56e-07, 3.19e-06, 3.22e-06, 3.27e-06, 3.38e-06, 3.78e-06, 4.55e-06], \
				 [6.6e-07, 6.6e-07, 6.6e-07, 6.6e-07, 6.6e-07, 6.6e-07, 6.6e-07, 6.61e-07, 6.61e-07, 6.62e-07, 6.64e-07, 6.7e-07, 6.81e-07, 3.29e-06, 3.32e-06, 3.36e-06, 3.47e-06, 3.85e-06, 4.57e-06], \
				 [6.86e-07, 6.86e-07, 6.86e-07, 6.86e-07, 6.86e-07, 6.86e-07, 6.86e-07, 6.86e-07, 6.86e-07, 6.87e-07, 6.89e-07, 6.95e-07, 7.05e-07, 3.38e-06, 3.4e-06, 3.45e-06, 3.55e-06, 3.91e-06, 4.58e-06], \
				 [7.11e-07, 7.11e-07, 7.11e-07, 7.11e-07, 7.11e-07, 7.11e-07, 7.11e-07, 7.11e-07, 7.12e-07, 7.13e-07, 7.15e-07, 7.2e-07, 7.3e-07, 3.45e-06, 3.47e-06, 3.52e-06, 3.61e-06, 3.96e-06, 4.61e-06], \
				 [7.36e-07, 7.36e-07, 7.36e-07, 7.36e-07, 7.36e-07, 7.36e-07, 7.37e-07, 7.37e-07, 7.37e-07, 7.38e-07, 7.4e-07, 7.45e-07, 7.54e-07, 7.75e-07, 3.54e-06, 3.58e-06, 3.67e-06, 4.02e-06, 4.64e-06], \
				 [7.62e-07, 7.62e-07, 7.62e-07, 7.62e-07, 7.62e-07, 7.62e-07, 7.62e-07, 7.62e-07, 7.63e-07, 7.63e-07, 7.65e-07, 7.7e-07, 7.79e-07, 7.99e-07, 3.59e-06, 3.63e-06, 3.73e-06, 4.08e-06, 4.69e-06], \
				 [7.87e-07, 7.87e-07, 7.87e-07, 7.87e-07, 7.87e-07, 7.87e-07, 7.87e-07, 7.87e-07, 7.88e-07, 7.89e-07, 7.9e-07, 7.95e-07, 8.04e-07, 8.23e-07, 3.63e-06, 3.68e-06, 3.79e-06, 4.14e-06, 4.76e-06], \
				 [8.13e-07, 8.13e-07, 8.13e-07, 8.13e-07, 8.13e-07, 8.13e-07, 8.13e-07, 8.13e-07, 8.13e-07, 8.14e-07, 8.16e-07, 8.2e-07, 8.29e-07, 8.47e-07, 3.66e-06, 3.72e-06, 3.83e-06, 4.21e-06, 4.84e-06], \
				 [8.38e-07, 8.38e-07, 8.38e-07, 8.38e-07, 8.38e-07, 8.38e-07, 8.38e-07, 8.38e-07, 8.39e-07, 8.39e-07, 8.41e-07, 8.46e-07, 8.54e-07, 8.71e-07, 3.66e-06, 3.73e-06, 3.87e-06, 4.28e-06, 4.94e-06], \
				 [8.63e-07, 8.63e-07, 8.63e-07, 8.63e-07, 8.63e-07, 8.63e-07, 8.63e-07, 8.64e-07, 8.64e-07, 8.65e-07, 8.66e-07, 8.71e-07, 8.78e-07, 8.95e-07, 3.63e-06, 3.72e-06, 3.88e-06, 4.34e-06, 5.04e-06], \
				 [8.89e-07, 8.89e-07, 8.89e-07, 8.89e-07, 8.89e-07, 8.89e-07, 8.89e-07, 8.89e-07, 8.89e-07, 8.9e-07, 8.92e-07, 8.96e-07, 9.03e-07, 9.19e-07, 3.57e-06, 3.67e-06, 3.87e-06, 4.38e-06, 5.13e-06], \
				 [9.18e-07, 9.18e-07, 9.18e-07, 9.18e-07, 9.18e-07, 9.18e-07, 9.18e-07, 9.19e-07, 9.19e-07, 9.2e-07, 9.21e-07, 9.25e-07, 9.32e-07, 9.46e-07, 9.98e-07, 3.59e-06, 3.81e-06, 4.39e-06, 5.22e-06], \
				 [9.47e-07, 9.47e-07, 9.47e-07, 9.47e-07, 9.47e-07, 9.47e-07, 9.48e-07, 9.48e-07, 9.48e-07, 9.49e-07, 9.5e-07, 9.53e-07, 9.6e-07, 9.73e-07, 1.02e-06, 3.51e-06, 3.73e-06, 4.32e-06, 5.18e-06], \
				 [9.74e-07, 9.74e-07, 9.74e-07, 9.74e-07, 9.74e-07, 9.74e-07, 9.74e-07, 9.74e-07, 9.74e-07, 9.75e-07, 9.76e-07, 9.8e-07, 9.86e-07, 9.98e-07, 1.04e-06, 3.46e-06, 3.67e-06, 4.24e-06, 5.09e-06], \
				 [9.98e-07, 9.98e-07, 9.98e-07, 9.98e-07, 9.98e-07, 9.98e-07, 9.98e-07, 9.98e-07, 9.99e-07, 9.99e-07, 1e-06, 1e-06, 1.01e-06, 1.02e-06, 1.07e-06, 3.39e-06, 3.62e-06, 4.19e-06, 5.03e-06], \
				 [1.02e-06, 1.02e-06, 1.02e-06, 1.02e-06, 1.02e-06, 1.02e-06, 1.02e-06, 1.02e-06, 1.02e-06, 1.02e-06, 1.02e-06, 1.03e-06, 1.03e-06, 1.05e-06, 1.09e-06, 3.33e-06, 3.56e-06, 4.13e-06, 4.96e-06], \
				 [1.05e-06, 1.05e-06, 1.05e-06, 1.05e-06, 1.05e-06, 1.05e-06, 1.05e-06, 1.05e-06, 1.05e-06, 1.05e-06, 1.05e-06, 1.05e-06, 1.06e-06, 1.07e-06, 1.11e-06, 3.26e-06, 3.5e-06, 4.08e-06, 4.9e-06], \
				 [1.07e-06, 1.07e-06, 1.07e-06, 1.07e-06, 1.07e-06, 1.07e-06, 1.07e-06, 1.07e-06, 1.07e-06, 1.07e-06, 1.07e-06, 1.08e-06, 1.08e-06, 1.09e-06, 1.14e-06, 3.18e-06, 3.43e-06, 4.02e-06, 4.84e-06], \
				 [1.09e-06, 1.09e-06, 1.09e-06, 1.09e-06, 1.09e-06, 1.09e-06, 1.09e-06, 1.09e-06, 1.09e-06, 1.09e-06, 1.1e-06, 1.1e-06, 1.1e-06, 1.12e-06, 1.16e-06, 1.26e-06, 3.37e-06, 3.96e-06, 4.78e-06], \
				 [1.12e-06, 1.12e-06, 1.12e-06, 1.12e-06, 1.12e-06, 1.12e-06, 1.12e-06, 1.12e-06, 1.12e-06, 1.12e-06, 1.12e-06, 1.12e-06, 1.13e-06, 1.14e-06, 1.18e-06, 1.27e-06, 3.3e-06, 3.91e-06, 4.72e-06], \
				 [1.14e-06, 1.14e-06, 1.14e-06, 1.14e-06, 1.14e-06, 1.14e-06, 1.14e-06, 1.14e-06, 1.14e-06, 1.14e-06, 1.14e-06, 1.14e-06, 1.15e-06, 1.16e-06, 1.2e-06, 1.29e-06, 3.22e-06, 3.85e-06, 4.66e-06], \
				 [1.16e-06, 1.16e-06, 1.16e-06, 1.16e-06, 1.16e-06, 1.16e-06, 1.16e-06, 1.16e-06, 1.16e-06, 1.16e-06, 1.16e-06, 1.17e-06, 1.17e-06, 1.19e-06, 1.23e-06, 1.31e-06, 3.15e-06, 3.8e-06, 4.6e-06], \
				 [1.18e-06, 1.18e-06, 1.18e-06, 1.18e-06, 1.18e-06, 1.18e-06, 1.18e-06, 1.18e-06, 1.18e-06, 1.19e-06, 1.19e-06, 1.19e-06, 1.2e-06, 1.21e-06, 1.25e-06, 1.33e-06, 3.06e-06, 3.74e-06, 4.54e-06], \
				 [1.21e-06, 1.21e-06, 1.21e-06, 1.21e-06, 1.21e-06, 1.21e-06, 1.21e-06, 1.21e-06, 1.21e-06, 1.21e-06, 1.21e-06, 1.21e-06, 1.22e-06, 1.23e-06, 1.27e-06, 1.35e-06, 2.96e-06, 3.69e-06, 4.49e-06], \
				 [1.23e-06, 1.23e-06, 1.23e-06, 1.23e-06, 1.23e-06, 1.23e-06, 1.23e-06, 1.23e-06, 1.23e-06, 1.23e-06, 1.23e-06, 1.23e-06, 1.24e-06, 1.25e-06, 1.29e-06, 1.37e-06, 2.85e-06, 3.63e-06, 4.43e-06], \
				 [1.25e-06, 1.25e-06, 1.25e-06, 1.25e-06, 1.25e-06, 1.25e-06, 1.25e-06, 1.25e-06, 1.25e-06, 1.25e-06, 1.25e-06, 1.26e-06, 1.26e-06, 1.27e-06, 1.31e-06, 1.39e-06, 2.68e-06, 3.57e-06, 4.38e-06], \
				 [1.36e-06, 1.36e-06, 1.36e-06, 1.36e-06, 1.36e-06, 1.36e-06, 1.36e-06, 1.36e-06, 1.36e-06, 1.36e-06, 1.36e-06, 1.36e-06, 1.37e-06, 1.38e-06, 1.42e-06, 1.49e-06, 1.68e-06, 3.28e-06, 4.13e-06], \
				 [1.46e-06, 1.46e-06, 1.46e-06, 1.46e-06, 1.46e-06, 1.46e-06, 1.46e-06, 1.46e-06, 1.46e-06, 1.46e-06, 1.46e-06, 1.47e-06, 1.47e-06, 1.48e-06, 1.52e-06, 1.58e-06, 1.73e-06, 2.94e-06, 3.9e-06], \
				 [1.84e-06, 1.84e-06, 1.84e-06, 1.84e-06, 1.84e-06, 1.84e-06, 1.84e-06, 1.84e-06, 1.84e-06, 1.84e-06, 1.84e-06, 1.85e-06, 1.85e-06, 1.86e-06, 1.89e-06, 1.93e-06, 2.04e-06, 2.41e-06, 3.21e-06], \
				 [2.18e-06, 2.18e-06, 2.18e-06, 2.18e-06, 2.18e-06, 2.18e-06, 2.18e-06, 2.18e-06, 2.18e-06, 2.18e-06, 2.18e-06, 2.19e-06, 2.19e-06, 2.2e-06, 2.22e-06, 2.26e-06, 2.34e-06, 2.59e-06, 3.07e-06], \
				 [2.92e-06, 2.92e-06, 2.92e-06, 2.92e-06, 2.92e-06, 2.92e-06, 2.92e-06, 2.92e-06, 2.92e-06, 2.92e-06, 2.92e-06, 2.92e-06, 2.92e-06, 2.93e-06, 2.94e-06, 2.97e-06, 3.02e-06, 3.18e-06, 3.44e-06], \
				 [3.54e-06, 3.54e-06, 3.54e-06, 3.54e-06, 3.54e-06, 3.54e-06, 3.54e-06, 3.54e-06, 3.54e-06, 3.54e-06, 3.54e-06, 3.54e-06, 3.55e-06, 3.55e-06, 3.56e-06, 3.58e-06, 3.62e-06, 3.74e-06, 3.93e-06], \
				 [4.61e-06, 4.61e-06, 4.61e-06, 4.61e-06, 4.61e-06, 4.61e-06, 4.61e-06, 4.61e-06, 4.61e-06, 4.61e-06, 4.61e-06, 4.61e-06, 4.61e-06, 4.61e-06, 4.62e-06, 4.63e-06, 4.66e-06, 4.74e-06, 4.88e-06], \
				 [5.52e-06, 5.52e-06, 5.52e-06, 5.52e-06, 5.52e-06, 5.52e-06, 5.52e-06, 5.52e-06, 5.52e-06, 5.52e-06, 5.52e-06, 5.52e-06, 5.52e-06, 5.52e-06, 5.53e-06, 5.54e-06, 5.56e-06, 5.63e-06, 5.74e-06], \
				 [6.34e-06, 6.34e-06, 6.34e-06, 6.34e-06, 6.34e-06, 6.34e-06, 6.34e-06, 6.34e-06, 6.34e-06, 6.34e-06, 6.34e-06, 6.34e-06, 6.34e-06, 6.34e-06, 6.35e-06, 6.36e-06, 6.38e-06, 6.44e-06, 6.53e-06], \
				 [7.81e-06, 7.81e-06, 7.81e-06, 7.81e-06, 7.81e-06, 7.81e-06, 7.81e-06, 7.81e-06, 7.81e-06, 7.81e-06, 7.81e-06, 7.81e-06, 7.81e-06, 7.81e-06, 7.82e-06, 7.83e-06, 7.84e-06, 7.89e-06, 7.97e-06], \
				 [9.76e-06, 9.76e-06, 9.76e-06, 9.76e-06, 9.76e-06, 9.76e-06, 9.76e-06, 9.76e-06, 9.77e-06, 9.77e-06, 9.77e-06, 9.77e-06, 9.77e-06, 9.77e-06, 9.77e-06, 9.78e-06, 9.79e-06, 9.83e-06, 9.89e-06], \
				 [1.08e-05, 1.08e-05, 1.08e-05, 1.08e-05, 1.08e-05, 1.08e-05, 1.08e-05, 1.08e-05, 1.08e-05, 1.08e-05, 1.08e-05, 1.08e-05, 1.08e-05, 1.08e-05, 1.08e-05, 1.08e-05, 1.08e-05, 1.08e-05, 1.09e-05], \
				 [1.25e-05, 1.25e-05, 1.25e-05, 1.25e-05, 1.25e-05, 1.25e-05, 1.25e-05, 1.25e-05, 1.25e-05, 1.25e-05, 1.25e-05, 1.25e-05, 1.25e-05, 1.25e-05, 1.25e-05, 1.25e-05, 1.25e-05, 1.25e-05, 1.26e-05], \
				 [1.51e-05, 1.51e-05, 1.51e-05, 1.51e-05, 1.51e-05, 1.51e-05, 1.51e-05, 1.51e-05, 1.51e-05, 1.51e-05, 1.51e-05, 1.51e-05, 1.51e-05, 1.51e-05, 1.51e-05, 1.51e-05, 1.51e-05, 1.52e-05, 1.52e-05], \
				 [1.76e-05, 1.76e-05, 1.76e-05, 1.76e-05, 1.76e-05, 1.76e-05, 1.76e-05, 1.76e-05, 1.76e-05, 1.76e-05, 1.76e-05, 1.76e-05, 1.76e-05, 1.76e-05, 1.76e-05, 1.76e-05, 1.76e-05, 1.76e-05, 1.77e-05], \
				 [1.99e-05, 1.99e-05, 1.99e-05, 1.99e-05, 1.99e-05, 1.99e-05, 1.99e-05, 1.99e-05, 1.99e-05, 1.99e-05, 1.99e-05, 1.99e-05, 1.99e-05, 1.99e-05, 1.99e-05, 1.99e-05, 1.99e-05, 1.99e-05, 2e-05], \
				 [2.22e-05, 2.22e-05, 2.22e-05, 2.22e-05, 2.22e-05, 2.22e-05, 2.22e-05, 2.22e-05, 2.22e-05, 2.21e-05, 2.21e-05, 2.21e-05, 2.21e-05, 2.21e-05, 2.21e-05, 2.2e-05, 2.19e-05, 2.15e-05, 2.09e-05], \
				 [2.43e-05, 2.43e-05, 2.43e-05, 2.43e-05, 2.43e-05, 2.43e-05, 2.43e-05, 2.43e-05, 2.43e-05, 2.43e-05, 2.43e-05, 2.43e-05, 2.43e-05, 2.43e-05, 2.42e-05, 2.42e-05, 2.41e-05, 2.37e-05, 2.32e-05]]
    
    ################## FUNCTION ###############################################
    
    function = scipy.interpolate.RectBivariateSpline(data_temperature, data_pressure, data)

    result = function(temperature,pressure)[0][0]
    
    return result

#%%
def mass():
    """
    ========== DESCRIPTION ==========

    Return the constant mass of a single atom of helium 4

    ========== VALIDITY ==========

    ========== FROM ==========

    ========== OUTPUT ==========

    <mass>
        -- float --
    	The mass of a single atom of Helium 4
        [kg]

    ========== STATUS ==========

    Status : Checked

    """

    ################## MODULES ################################################
    
    from cryopy import constant

    ################## RETURN #################################################

    return molar_mass() / constant.avogadro()

#%%
def molar_mass():
    
    """
    ========== DESCRIPTION ==========

    Return the constant molar mass of a single mole of helium 4

    ========== VALIDITY ==========

    Always

    ========== FROM ==========

    P. J. Mohr, B. N. Taylor, and D. B. Newell, Rev. Mod. Phys. 84, 1531 (2012).

    ========== OUTPUT ==========

    <molar_mass>
        -- float --
        The molar mass of a single mole of helium 4
        [kg].[mol]**(-1)

    ========== STATUS ==========

    Status : Checked

    """

    ################## RETURN #################################################

    return 4.002602e-3

#%% 
def molar_volume(temperature,pressure):
    
    """
    ========== DESCRIPTION ==========

    This function return the molar volume of pure Helium 4

    ========== VALIDITY ==========

    <temperature> : [0.8 -> 400]
    <pressure> : [1 -> 1e6] 

    ========== FROM ==========

    HEPAK was written by Vincent Arp, Bob McCarty, and Jeff Fox, formerly of 
    NIST and later of Cryodata, using code from Brian Hands while at the 
    Oxford University Cryogenics Laboratory.


    ========== INPUT ==========

    <temperature>
        -- float --
        The temperature of pure helium 4
        [K]

    <pressure>
        -- float --
        The pressure of pure helium 4
        [Pa]

    ========== OUTPUT ==========

    <molar_volume>
        -- float --
        The specific volume of pure helium 4
        [m]**3.[mol]**(-1)

    ========== STATUS ==========

    Status : Checked 2024-02-27
    
    ========== UPDATE ==========
    

    """
    
    ################## PACKAGES ###############################################
    
    ################## CONDITIONS #############################################
    
    ################## INITIALISATION #########################################
    
    ################## FUNCTION ###############################################
    
    result = molar_mass()/density(temperature,pressure)
    
    return result




