(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[542],{96795:function(e,n,t){var r=t(36740)(function(e,n,t){e[t?0:1].push(n)},function(){return[[],[]]});e.exports=r},98012:function(e,n,t){"use strict";t.d(n,{_:function(){return o}});var r=t(73235),i=t(4760);function l(){let e=(0,r._)(["\n  query InstanceConfigHasInfo {\n    instance {\n      id\n      hasInfo\n    }\n  }\n"]);return l=function(){return e},e}let o=()=>{var e;return!!(null===(e=(0,i.aM)(s).data)||void 0===e?void 0:e.instance.hasInfo)},s=(0,i.Ps)(l())},60542:function(e,n,t){"use strict";t.r(n),t.d(n,{RunsRoot:function(){return Q},default:function(){return V}});var r=t(52322),i=t(57164),l=t(48177),o=t(8637),s=t(71018),u=t(18984),a=t(15997),d=t(54123),c=t(1026),h=t(96795),f=t.n(h),x=t(2784),p=t(73235),v=t(97077),j=t(47933),m=t(4760),g=t(283),C=t(98012);function y(){let e=(0,p._)(['\n  query QueueDaemonStatusQuery {\n    instance {\n      id\n      daemonHealth {\n        id\n        daemonStatus(daemonType: "QUEUED_RUN_COORDINATOR") {\n          id\n          daemonType\n          healthy\n          required\n        }\n      }\n    }\n  }\n']);return y=function(){return e},e}let w=()=>{let e=(0,C._)();return(0,r.jsxs)(l.x,{flex:{direction:"column",gap:8},style:{minWidth:"100%"},border:"bottom",children:[e&&(0,r.jsx)(v.b,{intent:"info",title:(0,r.jsx)(j.rU,{to:"/config#run_coordinator",children:"View queue configuration"})}),e&&(0,r.jsx)(_,{})]})},_=()=>{let{data:e}=(0,m.aM)(k),{pageTitle:n}=(0,x.useContext)(g.N),t=null==e?void 0:e.instance.daemonHealth.daemonStatus;return(null==t?void 0:t.required)&&!(null==t?void 0:t.healthy)?(0,r.jsx)(v.b,{intent:"warning",title:"The queued run coordinator is not healthy.",description:(0,r.jsxs)("div",{children:["View ",(0,r.jsx)(j.rU,{to:"/health",children:n})," for details."]})}):null},k=(0,m.Ps)(y());var b=t(51188),E=t(20913),q=t(87642),R=t(41349),N=t(53852),T=t(65496),I=t(54602),P=t(98933),A=t(96798),H=t(28316);function S(e){let{node:n}=e,t=x.useRef(null);return x.useLayoutEffect(()=>{let e=t.current;if(n.parentNode!==e){if(null!==n.parentNode&&n.parentNode!==e)throw Error("Cannot render the same node twice");return null==e||e.appendChild(n),()=>{null==e||e.removeChild(n)}}},[n]),(0,r.jsx)("div",{ref:t})}var U=t(16450),D=t(36872);let Q=()=>{(0,A.Px)();let[e,n]=(0,N.oD)(),t=(0,N.VH)(e),{queryResult:h,paginationProps:p}=(0,I.E)(t,25),v=(0,P.C4)(h,P.dT),j=(0,b.Qf)(e),m="all"!==j,[g,C]=f()(e,e=>"status"===e.token),y=(0,x.useCallback)(e=>{m?n([...g,...e]):n(e)},[n,m,g]),_=(0,x.useCallback)(e=>{let n=(0,i.HY)(e);C.some(e=>(0,i.HY)(e)===n)||y([...C,e])},[C,y]),k=(0,x.useMemo)(()=>{let e=["tag","snapshotId","id","job","pipeline","partition","backfill"];return m||e.push("status"),e},[m]),Q=(0,x.useMemo)(()=>m?e.filter(e=>"status"!==e.token):e,[e,m]),{tabs:V,queryResult:M}=(0,b.zc)(t),Y=(0,P.C4)(M,P.dT),F=(0,P.V5)(Y,v),{button:L,activeFiltersJsx:O}=(0,N.Vv)({tokens:Q,onChange:y,enabledFilters:k}),[z,B]=function(e){let[n,t]=x.useState(null);return x.useLayoutEffect(()=>{t(e=>null===e?document.createElement("div"):e)},[]),[n?(0,H.createPortal)(e,n):null,n?(0,r.jsx)(S,{node:n}):null]}(L);function W(){var e,n,i,o;return(0,r.jsxs)(l.x,{style:{width:"100%",marginRight:8},flex:{justifyContent:"space-between"},children:[(0,r.jsxs)(l.x,{flex:{direction:"row",alignItems:"center",gap:8},children:[V,B]}),"queued"===j?(0,r.jsx)(T.N,{refetch:F.refetch,filter:{...t,statuses:Array.from(E.sy)},disabled:(null===(e=M.data)||void 0===e?void 0:e.queuedCount.__typename)!=="Runs"||(null===(n=M.data)||void 0===n?void 0:n.queuedCount.count)===0}):"in-progress"===j?(0,r.jsx)(T.N,{refetch:F.refetch,filter:{...t,statuses:Array.from(E.Ys)},disabled:(null===(i=M.data)||void 0===i?void 0:i.inProgressCount.__typename)!=="Runs"||(null===(o=M.data)||void 0===o?void 0:o.inProgressCount.count)===0}):void 0]})}return(0,r.jsxs)(o.T,{children:[(0,r.jsx)(s.m,{title:(0,r.jsx)(u.X6,{children:"Runs"}),right:(0,r.jsx)(P.xi,{refreshState:F})}),z,(0,r.jsx)(R.Lw.Provider,{value:{refetch:h.refetch},children:(0,r.jsx)(U.g,{queryResult:h,allowStaleData:!0,renderError:e=>{let n=!!((null==e?void 0:e.networkError)&&"statusCode"in e.networkError&&400===e.networkError.statusCode);return(0,r.jsxs)(l.x,{flex:{direction:"column",gap:32},padding:{vertical:8,horizontal:24},children:[W(),(0,r.jsx)(a.t,{icon:"warning",title:n?"Invalid run filters":"Unexpected error",description:n?"The specified run filters are not valid. Please check the filters and try again.":"An unexpected error occurred. Check the console for details."})]})},children:e=>{let{pipelineRunsOrError:n}=e;return"Runs"!==n.__typename?(0,r.jsx)(l.x,{padding:{vertical:64},children:(0,r.jsx)(a.t,{icon:"error",title:"Query Error",description:n.message})}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(D.Y,{$top:0,children:(0,r.jsx)(q.A,{runs:n.results,onAddTag:_,filter:t,actionBarComponents:W(),belowActionBarComponents:"queued"===j||O.length?(0,r.jsxs)(r.Fragment,{children:["queued"===j&&(0,r.jsx)(w,{}),O.length>0&&(0,r.jsxs)(r.Fragment,{children:[O,(0,r.jsx)(d.Z,{onClick:()=>y([]),children:"Clear all"})]})]}):null})}),n.results.length>0?(0,r.jsx)("div",{style:{marginTop:"16px"},children:(0,r.jsx)(c.pI,{...p})}):null]})}})})]})};var V=Q}}]);
//# sourceMappingURL=542.0317e1abd8ab233a.js.map