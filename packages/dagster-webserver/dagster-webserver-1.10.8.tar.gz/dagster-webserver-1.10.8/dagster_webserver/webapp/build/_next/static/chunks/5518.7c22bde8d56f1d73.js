"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5518],{5242:function(e,t,i){i.d(t,{p:function(){return y}});var n=i(52322),s=i(3217),r=i(82422),o=i(18984),l=i(26834),a=i(12597),d=i(28879),c=i.n(d),u=i(77491),h=i.n(u),x=i(2784),p=i(35505),m=i(96586),g=i(47793),j=i(84991);c().extend(h());let v={[j.izS.SUCCESS]:s.fA(),[j.izS.FAILURE]:s.FY(),[j.izS.STARTED]:s.v4(),[j.izS.SKIPPED]:s.A8()},f={[j.izS.SUCCESS]:s.Lv(),[j.izS.FAILURE]:s.MP(),[j.izS.STARTED]:s.Jq(),[j.izS.SKIPPED]:s.$l()},y=e=>{let{ticks:t,tickResultType:i,onHoverTick:s,onSelectTick:a,exactRange:d,timeRange:c=3e5,tickGrid:u=6e4,timeAfter:h=6e4}=e,[p,j]=(0,x.useState)(Date.now()),[v,f]=(0,x.useState)(!1);(0,x.useEffect)(()=>{if(!v&&!d){let e=setInterval(()=>{j(Date.now())},100);return()=>clearInterval(e)}return()=>{}},[d,v]);let y=(null==d?void 0:d[1])?1e3*d[1]:p+h,A=(null==d?void 0:d[0])?1e3*d[0]:p-c,E=A<p&&p<y,R=y-A,{viewport:M,containerProps:P}=(0,r.S)(),L=(0,x.useMemo)(()=>t.filter(e=>!e.endTimestamp||1e3*e.endTimestamp>A).reverse(),[t,A]),N=(0,x.useMemo)(()=>L.map((e,t)=>{var i,n;let s=(i=1e3*e.timestamp,M.width*(i-A)/R),r=(n=(0,g.g6)(e,L.length-t-1)?e.timestamp:e.endTimestamp?1e3*e.endTimestamp:p,M.width*(n-A)/R);return{...e,width:Math.max(r-s,8),startX:s}}),[A,p,L,R,M.width]),q=Math.max((y-A)/25,u)/5,$=Math.ceil(A/q)*q,O=Math.ceil((y-$)/q),F=Math.ceil(O/5),U=(0,x.useMemo)(()=>{let e=[];for(let t=0;t<O;t++){let i=$+t*q;e.push({time:i,x:M.width*(i-A)/R,showLabel:t%F==0})}return e},[O,$,q,M.width,A,R,F]);return(0,n.jsx)("div",{style:{marginRight:"8px"},children:(0,n.jsxs)("div",{...P,children:[(0,n.jsxs)(S,{children:[U.map(e=>(0,n.jsxs)(k,{style:{transform:"translateX(".concat(e.x,"px)")},children:[(0,n.jsx)(T,{}),e.showLabel?(0,n.jsx)(z,{children:(0,n.jsx)(o.YS,{children:(0,n.jsx)(m.E,{timestamp:{ms:e.time},timeFormat:{showSeconds:!0}})})}):null]},e.time)),N.map(e=>{var t,r;let o=null!==(r="materializations"!==i&&"runIds"in e?null===(t=e.runIds)||void 0===t?void 0:t.length:e.requestedAssetMaterializationCount)&&void 0!==r?r:0;return(0,n.jsx)(C,{style:{transform:"translateX(".concat(e.startX,"px)"),width:"".concat(e.width,"px")},status:e.status,onMouseEnter:()=>{s(e),f(!0)},onMouseLeave:()=>{s(),f(!1)},onClick:()=>{a(e)},children:(0,n.jsx)(l.u,{content:(0,n.jsx)(w,{tick:e,tickResultType:i}),children:(0,n.jsx)("div",{style:{width:e.width+"px",height:"80px"},children:o>0?o:null})})},e.id)}),E?(0,n.jsx)(I,{style:{transform:"translateX(".concat(M.width*(p-A)/R,"px)")}}):null]}),(0,n.jsx)(b,{})]})})},w=(0,x.memo)(e=>{let{tick:t,tickResultType:i}=e,r=(0,x.useMemo)(()=>{var e,n;return t.status===j.izS.FAILURE?"Evaluation failed":t.status===j.izS.STARTED?"Evaluating…":"materializations"!==i&&"runs"in t?"".concat((null===(e=t.runs)||void 0===e?void 0:e.length)||0," run").concat((0,a.I)(null===(n=t.runs)||void 0===n?void 0:n.length,"","s")," requested"):"".concat(t.requestedAssetMaterializationCount," materialization").concat((0,a.I)(t.requestedAssetMaterializationCount,"","s")," requested")},[t,i]),l=c()(1e3*t.timestamp),d=c()(t.endTimestamp?1e3*t.endTimestamp:Date.now()),u=l.to(d,!0);return(0,n.jsxs)("div",{children:[(0,n.jsx)(o.YS,{as:"div",children:(0,n.jsx)(m.E,{timestamp:{unix:t.timestamp},timeFormat:{showSeconds:!0}})}),(0,n.jsxs)(o.YS,{as:"div",children:[r," (",u,")"]}),t.status===j.izS.STARTED?null:(0,n.jsx)(o.YS,{color:s.$(),children:"Click for details"})]})}),S=p.ZP.div.withConfig({componentId:"sc-93f8c965-0"})(["position:relative;height:100px;padding:10px 2px;border-bottom:1px solid ",";"],s.wL()),b=p.ZP.div.withConfig({componentId:"sc-93f8c965-1"})(["height:24px;"]),C=p.ZP.div.withConfig({componentId:"sc-93f8c965-2"})(["cursor:pointer;position:absolute;top:10px;height:80px;will-change:transform,width;border-radius:2px;div{place-content:center;display:grid;}color:",";",""],s.v8(),e=>{let{status:t}=e;return"\n    background: ".concat(v[t],";\n    &:hover {\n      background: ").concat(f[t],";\n    }\n  ")}),k=p.ZP.div.withConfig({componentId:"sc-93f8c965-3"})(["position:absolute;top:0;height:124px;will-change:transform;"]),T=p.ZP.div.withConfig({componentId:"sc-93f8c965-4"})(["position:absolute;top:0;height:108px;width:1px;background:",";"],s.wL()),z=p.ZP.div.withConfig({componentId:"sc-93f8c965-5"})(["height:16px;position:absolute;bottom:0;width:100px;margin-left:-24px;"]),I=p.ZP.div.withConfig({componentId:"sc-93f8c965-6"})(["position:absolute;top:0;height:126px;width:2px;background:",";&:after{content:'Now';position:absolute;left:0;background:",";color:",";bottom:0;font-size:12px;padding:3px 4px;}"],s.Bj(),s.Bj(),s.KH())},47793:function(e,t,i){i.d(t,{g6:function(){return s},sw:function(){return r}});var n=i(84991);function s(e,t){return!e.endTimestamp&&(0!==t&&e.status===n.izS.STARTED||1e3*e.timestamp<Date.now()-259200)}function r(e,t){return e.reduce((e,i)=>{if(i.type===t){var n;return e+((null===(n=i.partitionKeys)||void 0===n?void 0:n.length)||0)}return e},0)}},15518:function(e,t,i){i.r(t),i.d(t,{OverviewRoot:function(){return tm},default:function(){return tg}});var n,s,r=i(52322),o=i(7267),l=i(94466),a=i(48177),d=i(2784),c=i(74741),u=i(50683),h=i(97077),x=i(82422),p=i(27100),m=i(54854),g=i(3217),j=i(78401),v=i(60206),f=i(18984),y=i(88510),w=i(47933),S=i(35505),b=i(34515),C=i(98933),k=i(96798),T=i(43251),z=i(34970),I=i(9628),A=i(52027),E=i(47121),R=i(36386),M=i(55638),P=i(93781),L=i(22710),N=i(63385),q=i(97373),$=i(91987),O=i(18328);let F=e=>{let{Header:t,TabButton:i}=e;(0,k.Px)(),(0,P.j)("Overview | Assets");let{assets:n,query:s,error:o,loading:l}=(0,R.Zg)(),x=(0,C.bT)({refresh:s,intervalMs:C.dT,leading:!0}),p=d.useMemo(()=>n?function(e){let t={};return e.forEach(e=>{if(!e.definition)return;let i=e.definition.groupName,n=e.definition.repository.name,s="".concat(i,"||").concat(n),r=t[s]||{groupName:i,repositoryName:n,assets:[]};r.assets.push(e),t[s]=r}),Object.values(t)}(n):[],[n]),[m,g]=(0,L.q)({queryKey:"q",decode:e=>e.searchQuery?JSON.parse(e.searchQuery):"",encode:e=>({searchQuery:e?JSON.stringify(e):void 0})}),j=d.useMemo(()=>""===m?p:p.filter(e=>(e.groupName||D).toLowerCase().includes(m.toLowerCase())||e.repositoryName.toLowerCase().includes(m.toLowerCase())),[p,m]),v=d.useMemo(()=>{var e;return null!==(e=j.flatMap(e=>e.assets.map(e=>e.key)))&&void 0!==e?e:[]},[j]);(0,T.NY)(v,"OverviewAssetsRoot");let f=d.useRef(null),S=(0,y.MG)({count:j.length,getScrollElement:()=>f.current,estimateSize:()=>82,overscan:5}),z=S.getTotalSize(),I=S.getVirtualItems();return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{style:{position:"sticky",top:0,zIndex:1},children:[(0,r.jsx)(t,{refreshState:x}),(0,r.jsxs)(a.x,{padding:{horizontal:24,vertical:16},flex:{alignItems:"center",gap:12,grow:0},children:[(0,r.jsx)(i,{selected:"assets"}),(0,r.jsx)(u.oi,{value:m,onChange:e=>{g(e.target.value)},placeholder:"Filter asset groups…"})]}),(0,r.jsx)(a.x,{padding:{horizontal:24,vertical:16},border:"top",children:(0,r.jsx)(h.b,{intent:"info",title:"This Assets tab will be removed in an upcoming release.",description:(0,r.jsxs)(r.Fragment,{children:["Use the ",(0,r.jsx)(w.rU,{to:"/asset-groups",children:"global asset lineage page"})," to view grouped asset status details."]})})})]}),l?(0,r.jsx)(a.x,{flex:{alignItems:"center",justifyContent:"center",direction:"column",grow:1},style:{width:"100%"},children:(0,r.jsx)(c.$,{purpose:"page"})}):o?(0,r.jsx)(a.x,{flex:{alignItems:"center",justifyContent:"center",direction:"column",grow:1},style:{width:"100%"},children:(0,r.jsx)(b.T9,{error:o})}):(0,r.jsx)(a.x,{flex:{direction:"column"},style:{overflow:"hidden"},children:(0,r.jsxs)(q.W2,{ref:f,children:[(0,r.jsx)(_,{}),(0,r.jsx)(q.Nh,{$totalHeight:z,children:I.map(e=>{let{index:t,key:i,size:n,start:s}=e,o=j[t];return(0,r.jsx)(K,{start:s,height:n,group:o},i)})})]})})]})},U="5fr 1fr 1fr 1fr 1fr",_=()=>(0,r.jsxs)(q.VJ,{templateColumns:U,sticky:!0,children:[(0,r.jsx)(q.qN,{children:"Group name"}),(0,r.jsx)(q.qN,{children:"Missing"}),(0,r.jsx)(q.qN,{children:"Failed/Overdue"}),(0,r.jsx)(q.qN,{children:"In progress"}),(0,r.jsx)(q.qN,{children:"Materialized"})]}),D="Ungrouped Assets";function K(e){var t,i;let{height:n,start:s,group:o}=e,l=d.useMemo(()=>o.assets.map(e=>({path:e.key.path})),[o.assets]),{liveDataByNode:u}=(0,T.NY)(l),h=d.useMemo(()=>(0,A.s)(o.assets,u),[u,o.assets]),j=null===(i=o.assets.find(e=>{var t;return null===(t=e.definition)||void 0===t?void 0:t.repository}))||void 0===i?void 0:null===(t=i.definition)||void 0===t?void 0:t.repository,v=(0,$.kQ)((null==j?void 0:j.name)||"",(null==j?void 0:j.location.name)||""),{containerProps:f,viewport:y}=(0,x.S)(),S=l.length!==Object.keys(u).length,b=S?"":"0";return(0,r.jsx)(q.X2,{$height:n,$start:s,children:(0,r.jsxs)(B,{border:"bottom",children:[(0,r.jsx)(Z,{children:(0,r.jsxs)(a.x,{flex:{direction:"row",justifyContent:"space-between",grow:1},children:[(0,r.jsxs)(a.x,{flex:{direction:"column",gap:2,grow:1},children:[(0,r.jsxs)(a.x,{flex:{direction:"row",gap:8},children:[(0,r.jsx)(p.JO,{name:"asset_group"}),o.groupName?(0,r.jsx)(w.rU,{style:{fontWeight:700},to:(0,O.$U)(v,"/asset-groups/".concat(o.groupName)),children:o.groupName}):D]}),(0,r.jsx)("div",{...f,children:(0,r.jsx)(V,{maxWidth:y.width,children:(0,r.jsx)(N.b,{repoAddress:v,showRefresh:!1})})})]}),(0,r.jsx)(a.x,{flex:{direction:"column",justifyContent:"center"},children:S?(0,r.jsx)(c.$,{purpose:"body-text"}):null})]})}),(0,r.jsx)(Z,{children:h.missing.length?(0,r.jsx)(Q,{assets:h.missing,getCount:e=>{let{status:t}=e;return t.case===z.KB.PARTITIONS_MISSING&&t.numMissing||0},adjective:"missing",children:(0,r.jsx)(m.V,{intent:"none",children:(0,r.jsxs)(a.x,{flex:{direction:"row",alignItems:"center",gap:6},children:[(0,r.jsx)("div",{style:{width:"12px",height:"12px",border:"2px solid ".concat(g.im()),borderRadius:"50%"}}),h.missing.length]})})}):b}),(0,r.jsx)(Z,{children:h.failed.length?(0,r.jsx)(Q,{assets:h.failed,getCount:e=>{let{status:t}=e;return t.case===z.KB.PARTITIONS_FAILED&&t.numFailed||0},adjective:"failed",children:(0,r.jsx)(m.V,{intent:"danger",children:(0,r.jsxs)(a.x,{flex:{direction:"row",alignItems:"center",gap:6},children:[(0,r.jsx)("div",{style:{width:0,height:0,borderLeft:"6px solid transparent",borderRight:"6px solid transparent",borderBottom:"10px solid red",display:"inline-block"}}),h.failed.length]})})}):b}),(0,r.jsx)(Z,{children:h.inprogress.length?(0,r.jsx)(Q,{assets:h.inprogress,getCount:e=>{let{status:t}=e;return t.case===z.KB.MATERIALIZING&&t.numMaterializing||0},adjective:"materializing",children:(0,r.jsx)(m.V,{intent:"primary",icon:"spinner",children:h.inprogress.length})}):b}),(0,r.jsx)(Z,{children:h.successful.length?(0,r.jsx)(Q,{assets:h.successful,getCount:e=>{let{status:t}=e;return t.case===z.KB.PARTITIONS_MATERIALIZED&&t.numMaterialized||0},adjective:"materialized",children:(0,r.jsx)(m.V,{intent:"success",children:(0,r.jsxs)(a.x,{flex:{direction:"row",alignItems:"center",gap:6},children:[(0,r.jsx)("div",{style:{backgroundColor:g.fA(),width:"10px",height:"10px",borderRadius:"50%"}}),h.successful.length]})})}):b})]})})}let B=(0,S.ZP)(a.x).withConfig({componentId:"sc-9ca8ef04-0"})(["display:grid;grid-template-columns:",";height:100%;> *{vertical-align:middle;}"],U),Z=e=>{let{children:t}=e;return(0,r.jsx)(q.E5,{style:{color:g.Ep()},children:(0,r.jsx)(a.x,{flex:{direction:"row",alignItems:"center",grow:1},children:t})})},V=S.ZP.div.withConfig({componentId:"sc-9ca8ef04-1"})(["font-size:12px;pointer-events:none;a{color:",";pointer-events:none;max-width:",";}"],g.$(),e=>{let{maxWidth:t}=e;return t?"unset":"".concat(t,"px")});function Q(e){let{assets:t,children:i,getCount:n,adjective:s}=e;return(0,r.jsx)(W,{children:(0,r.jsx)(j.P,{items:t,itemPredicate:(e,t)=>(0,I.ll)(t.asset.key).toLocaleLowerCase().includes(e.toLocaleLowerCase()),itemRenderer:e=>{let t=n(e);return(0,r.jsx)(J,{to:(0,M.p)(e.asset.key),target:"_blank",children:(0,r.jsx)(v.sN,{text:(0,r.jsxs)(a.x,{flex:{direction:"row",alignItems:"center",gap:4},children:[(0,r.jsx)("div",{style:{paddingLeft:"4px"},children:(0,r.jsx)(p.JO,{name:"asset"})}),(0,r.jsx)("div",{style:{overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"},children:(0,I.ll)(e.asset.key)}),t&&t>0?(0,r.jsxs)(f.YS,{style:{color:g.$()},children:[(0,E._e)(t)," ",s]}):null]})},(0,I.ll)(e.asset.key))})},onItemSelect:()=>{},children:i})})}let W=S.ZP.div.withConfig({componentId:"sc-9ca8ef04-2"})(["cursor:pointer;&:hover{font-weight:600;}"]),J=(0,S.ZP)(w.rU).withConfig({componentId:"sc-9ca8ef04-3"})(["&:hover{text-decoration:none;}"]);var G=i(71018);let Y=()=>null;var H=i(44537),X=i(90025),ee=i(98828),et=i(73809),ei=i(74597);let en=e=>{let{refreshState:t,tab:i}=e,n=(0,et.dx)(),s=(0,ee.I)(),{enableAssetHealthOverviewPreview:o}=(0,d.useContext)(X.G);return(0,r.jsxs)(a.x,{flex:{direction:"row",justifyContent:"space-between",alignItems:"flex-end"},children:[(0,r.jsxs)(H.mQ,{selectedTabId:i,children:[(0,r.jsx)(ei.f,{id:"activity",title:"Timeline",to:"/overview/activity"}),o&&(0,r.jsx)(ei.f,{id:"asset-health",title:"Asset health",to:"/overview/asset-health"}),"has-global-amp"===s?(0,r.jsx)(ei.f,{id:"amp",title:(0,r.jsxs)(a.x,{flex:{direction:"row",gap:8,alignItems:"center"},children:[(0,r.jsx)("div",{children:"Auto-materialize"}),n.loading?(0,r.jsx)(c.$,{purpose:"body-text"}):(0,r.jsx)("div",{style:{width:"10px",height:"10px",borderRadius:"50%",backgroundColor:!1===n.paused?g.L$():g.md()}})]}),to:"/overview/automation"}):null,(0,r.jsx)(ei.f,{id:"resources",title:"Resources",to:"/overview/resources"})]}),t?(0,r.jsx)(a.x,{style:{alignSelf:"center"},children:(0,r.jsx)(C.xi,{refreshState:t})}):null]})},es=e=>{let{tab:t,queryData:i,refreshState:n,...s}=e;return(0,r.jsx)(G.m,{tabs:(0,r.jsxs)(a.x,{flex:{direction:"column",gap:8},children:[(0,r.jsx)(en,{tab:t,queryData:i,refreshState:n}),(0,r.jsx)(Y,{})]}),...s})};var er=i(87189),eo=i(98768),el=i(57595),ea=i(51188);let ed=()=>{(0,P.j)("Overview | Activity");let e=d.useCallback(e=>{let{refreshState:t}=e;return(0,r.jsx)(es,{tab:"activity",refreshState:t})},[]),[t,i]=(0,el.U)("overview-activity-tab",e=>["timeline","assets"].includes(e)?e:"timeline"),{enableAssetHealthOverviewPreview:n}=d.useContext(X.G),s=n?"timeline":t,c=d.useCallback(e=>{let{selected:t}=e;return n?null:(s!==t&&i(t),(0,r.jsxs)(l.zH,{children:[(0,r.jsx)(ea.Q1,{$active:"timeline"===t,to:"/overview/activity/timeline",children:"Timeline"}),(0,r.jsx)(ea.Q1,{$active:"assets"===t,to:"/overview/activity/assets",children:"Assets"})]}))},[s,i,n]);return(0,r.jsx)(a.x,{flex:{direction:"column"},style:{height:"100%",overflow:"hidden"},children:(0,r.jsxs)(o.rs,{children:[!n&&(0,r.jsx)(eo.A,{path:"/overview/activity/assets",children:(0,r.jsx)(F,{Header:e,TabButton:c})}),(0,r.jsx)(eo.A,{path:"/overview/activity/timeline",children:(0,r.jsx)(er.U,{Header:e,TabButton:c})}),(0,r.jsx)(eo.A,{path:"*",isNestingRoute:!0,render:d.useCallback(()=>"timeline"===s?(0,r.jsx)(o.l_,{to:"/overview/activity/timeline"}):(0,r.jsx)(o.l_,{to:"/overview/activity/assets"}),[s])})]})})};var ec=i(73235),eu=i(15997),eh=i(26834),ex=i(9774),ep=i(2636),em=i(41748);let eg="1.5fr 1fr 1fr",ej=e=>{let{name:t,description:i,repoAddress:n,start:s,height:o,resourceType:l,parentResources:d,jobsOpsUsing:c,assetKeysUsing:u,schedulesUsing:h,sensorsUsing:x}=e,m=(0,em.$)(l),j=d.length+c.length+u.length+h.length+x.length;return(0,r.jsx)(q.X2,{$height:o,$start:s,children:(0,r.jsxs)(ef,{border:"bottom",children:[(0,r.jsx)(q.E5,{children:(0,r.jsxs)(a.x,{flex:{direction:"column",gap:4},children:[(0,r.jsxs)(a.x,{flex:{direction:"row",gap:4,alignItems:"center"},children:[(0,r.jsx)(p.JO,{name:"resource",color:g.md()}),(0,r.jsx)("span",{style:{fontWeight:500},children:(0,r.jsx)(w.rU,{to:(0,O.$U)(n,"/resources/".concat(t)),children:(0,r.jsx)(ep.g,{text:t})})})]}),(0,r.jsx)("div",{style:{maxWidth:"100%",overflow:"hidden",textOverflow:"ellipsis"},children:(0,r.jsx)(f.YS,{style:{color:g.$(),whiteSpace:"nowrap"},children:i})})]})}),(0,r.jsx)(q.E5,{children:(0,r.jsx)(eh.u,{content:l,children:(0,r.jsx)(f.fv,{children:m})})}),(0,r.jsx)(q.E5,{children:(0,r.jsx)(w.rU,{to:(0,O.$U)(n,"/resources/".concat(t,"/uses")),children:j})})]})})},ev=()=>(0,r.jsxs)(q.VJ,{templateColumns:eg,sticky:!0,children:[(0,r.jsx)(q.qN,{children:"Name"}),(0,r.jsx)(q.qN,{children:"Type"}),(0,r.jsx)(q.qN,{children:"Uses"})]}),ef=(0,S.ZP)(a.x).withConfig({componentId:"sc-6af8490b-0"})(["display:grid;grid-template-columns:",";height:100%;"],eg);var ey=i(29134),ew=i(81942),eS=i(14500),eb=i(27450);let eC=e=>{let{repos:t}=e,i=(0,d.useRef)(null),n=(0,d.useMemo)(()=>t.map(e=>{let{repoAddress:t}=e;return(0,eb.Uz)(t)}),[t]),{expandedKeys:s,onToggle:o,onToggleAll:l}=(0,ew.N)(ex.y,n),a=(0,d.useMemo)(()=>{let e=[];return t.forEach(t=>{let{repoAddress:i,resources:n}=t;e.push({type:"header",repoAddress:i,resourceCount:n.length});let r=(0,eb.Uz)(i);s.includes(r)&&n.forEach(t=>{e.push({type:"resource",repoAddress:i,...t})})}),e},[t,s]),c=(0,ey.w)(t.map(e=>{let{repoAddress:t}=e;return t.name})),u=(0,y.MG)({count:a.length,getScrollElement:()=>i.current,estimateSize:e=>{let t=a[e];return(null==t?void 0:t.type)==="header"?32:64},overscan:10}),h=u.getTotalSize(),x=u.getVirtualItems();return(0,r.jsx)("div",{style:{overflow:"hidden"},children:(0,r.jsxs)(q.W2,{ref:i,children:[(0,r.jsx)(ev,{}),(0,r.jsx)(q.Nh,{$totalHeight:h,children:x.map(e=>{let{index:t,key:i,size:n,start:d}=e,u=a[t];return"header"===u.type?(0,r.jsx)(eS.vG,{repoAddress:u.repoAddress,height:n,start:d,onToggle:o,onToggleAll:l,expanded:s.includes((0,eb.Uz)(u.repoAddress)),showLocation:c.has(u.repoAddress.name),rightElement:(0,r.jsx)(eh.u,{content:1===u.resourceCount?"1 resource":"".concat(u.resourceCount," resources"),placement:"top",children:(0,r.jsx)(m.V,{children:u.resourceCount})})},i):(0,r.jsx)(ej,{height:n,start:d,...u},i)})})]})})};var ek=i(39916),eT=i(39282),ez=i(4760),eI=i(69752),eA=i(83891),eE=i(58926),eR=i(66135);let eM=e=>{let{tooltipContent:t}=e;return(0,eR.F)(2e3)?(0,r.jsx)(a.x,{margin:{top:1},children:(0,r.jsx)(eh.u,{placement:"top",canShow:!!t,content:t||"",children:(0,r.jsx)(c.$,{purpose:"body-text"})})}):null};var eP=i(8282);function eL(){let e=(0,ec._)(["\n  query OverviewResourcesQuery {\n    workspaceOrError {\n      ... on Workspace {\n        id\n        locationEntries {\n          id\n          locationOrLoadError {\n            ... on RepositoryLocation {\n              id\n              name\n              repositories {\n                id\n                name\n                allTopLevelResourceDetails {\n                  id\n                  ...ResourceEntryFragment\n                }\n              }\n            }\n            ...PythonErrorFragment\n          }\n        }\n      }\n      ...PythonErrorFragment\n    }\n  }\n\n  ","\n  ","\n"]);return eL=function(){return e},e}let eN=()=>{(0,k.Px)(),(0,P.j)("Overview | Resources");let{allRepos:e,visibleRepos:t,loading:i,data:n}=(0,d.useContext)(eP.C5),[s,o]=(0,L.q)({queryKey:"search",defaults:{search:""}}),l=e.length,h=(0,ez.aM)(e$,{fetchPolicy:"network-only",notifyOnNetworkStatusChange:!0}),{data:x,loading:p}=h,m=(0,C.C4)(h,C.dT),j=(0,d.useMemo)(()=>{let e=(0,eT.S)(t),i=Object.values(n).filter(e=>"WorkspaceLocationEntry"===e.__typename),s=null==x?void 0:x.workspaceOrError;return eq((null==s?void 0:s.__typename)==="Workspace"?s.locationEntries:i).filter(t=>{let{repoAddress:i}=t;return e.has((0,eb.Uz)(i))})},[n,x,t]),v=!x&&p&&i,f=s.trim().toLocaleLowerCase(),y=f.length>0,w=(0,d.useMemo)(()=>{let e=f.toLocaleLowerCase();return j.map(t=>{let{repoAddress:i,resources:n}=t;return{repoAddress:i,resources:n.filter(t=>{let{name:i}=t;return i.toLocaleLowerCase().includes(e)})}}).filter(e=>{let{resources:t}=e;return t.length>0})},[j,f]),S=p&&!x;return(0,r.jsxs)(a.x,{flex:{direction:"column"},style:{height:"100%",overflow:"hidden"},children:[(0,r.jsx)(es,{tab:"resources",refreshState:m}),(0,r.jsxs)(a.x,{padding:{horizontal:24,vertical:16},flex:{direction:"row",alignItems:"center",gap:12,grow:0},children:[l>1?(0,r.jsx)(eA.C,{}):null,(0,r.jsx)(u.oi,{icon:"search",value:s,rightElement:S?(0,r.jsx)(eM,{tooltipContent:"Loading resources…"}):void 0,onChange:e=>o(e.target.value),placeholder:"Filter by resource name…",style:{width:"340px"}})]}),v&&!l?(0,r.jsx)(a.x,{padding:64,children:(0,r.jsx)(c.$,{purpose:"page"})}):(()=>{if(v)return(0,r.jsx)(a.x,{flex:{direction:"row",justifyContent:"center"},style:{paddingTop:"100px"},children:(0,r.jsxs)(a.x,{flex:{direction:"row",alignItems:"center",gap:16},children:[(0,r.jsx)(c.$,{purpose:"body-text"}),(0,r.jsx)("div",{style:{color:g.$()},children:"Loading resources…"})]})});let i=e.length>t.length;return w.length?(0,r.jsx)(eC,{repos:w}):y?(0,r.jsx)(a.x,{padding:{top:20},children:(0,r.jsx)(eu.t,{icon:"search",title:"No matching resources",description:i?(0,r.jsxs)("div",{children:["No resources matching ",(0,r.jsx)("strong",{children:s})," were found in the selected code locations"]}):(0,r.jsxs)("div",{children:["No resources matching ",(0,r.jsx)("strong",{children:s})," were found in your definitions"]})})}):(0,r.jsx)(a.x,{padding:{top:20},children:(0,r.jsx)(eu.t,{icon:"search",title:"No resources",description:i?"No resources were found in the selected code locations":"No resources were found in your definitions"})})})()]})},eq=e=>{let t=e.map(e=>e.locationOrLoadError),i=[];for(let e of t)if((null==e?void 0:e.__typename)==="RepositoryLocation")for(let t of e.repositories){let{name:n,allTopLevelResourceDetails:s}=t,r=(0,$.kQ)(n,e.name);s.length>0&&i.push({repoAddress:r,resources:s})}return(0,ek.S)(i)},e$=(0,ez.Ps)(eL(),eI.B,eE.L);var eO=i(8637),eF=i(86587),eU=i(58351),e_=i(35025);function eD(){let e=(0,ec._)(["\n  fragment AssetDaemonTickFragment on InstigationTick {\n    id\n    timestamp\n    endTimestamp\n    status\n    instigationType\n    error {\n      ...PythonErrorFragment\n    }\n    requestedAssetKeys {\n      path\n    }\n    requestedAssetMaterializationCount\n    autoMaterializeAssetEvaluationId\n    requestedMaterializationsForAssets {\n      assetKey {\n        path\n      }\n      partitionKeys\n    }\n  }\n\n  ","\n"]);return eD=function(){return e},e}function eK(){let e=(0,ec._)(["\n  query AssetDaemonTicksQuery(\n    $dayRange: Int\n    $dayOffset: Int\n    $statuses: [InstigationTickStatus!]\n    $limit: Int\n    $cursor: String\n    $beforeTimestamp: Float\n    $afterTimestamp: Float\n  ) {\n    autoMaterializeTicks(\n      dayRange: $dayRange\n      dayOffset: $dayOffset\n      statuses: $statuses\n      limit: $limit\n      cursor: $cursor\n      beforeTimestamp: $beforeTimestamp\n      afterTimestamp: $afterTimestamp\n    ) {\n      id\n      ...AssetDaemonTickFragment\n    }\n  }\n\n  ","\n"]);return eK=function(){return e},e}let eB=(0,ez.Ps)(eD(),eI.B),eZ=(0,ez.Ps)(eK(),eB);var eV=i(39361),eQ=i(96586),eW=i(84991),eJ=i(45511),eG=i(6891),eY=i(1801);let eH=(0,d.memo)(e=>{let{tick:t,isOpen:i,close:n}=e;return(0,r.jsx)(eY.Vm,{isOpen:i,setIsOpen:n,height:400,header:(0,r.jsx)(eV.fK,{label:t?(0,r.jsx)("div",{children:(0,r.jsx)(eQ.E,{timestamp:{unix:t.timestamp},timeFormat:{showTimezone:!0}})}):""}),content:(0,r.jsxs)("div",{style:{display:"grid",gridTemplateRows:"auto auto minmax(0, 1fr)",height:"100%"},children:[(0,r.jsx)(a.x,{padding:{vertical:12,horizontal:24},border:"bottom",children:t?(0,r.jsx)(eJ.c,{tick:t,tickResultType:"materializations"}):null}),(null==t?void 0:t.status)===eW.izS.STARTED?null:(0,r.jsx)(eG.u,{tick:t})]})})});var eX=i(1026),e0=i(87642),e1=i(68313),e2=i(54602);let e8=e=>{var t;let{filterTags:i,setTableView:n}=e,{queryResult:s,paginationProps:o}=(0,e1.l)({nextCursorForResult:e=>{var t;if("Runs"===e.pipelineRunsOrError.__typename)return null===(t=e.pipelineRunsOrError.results[14])||void 0===t?void 0:t.id},getResultArray:e=>e&&"Runs"===e.pipelineRunsOrError.__typename?e.pipelineRunsOrError.results:[],variables:{filter:{tags:[...i||[],{key:"dagster/auto_materialize",value:"true"}]}},query:e2.z,pageSize:15});(0,C.C4)(s,15e3);let l=null===(t=s.data||s.previousData)||void 0===t?void 0:t.pipelineRunsOrError;return(0,r.jsxs)(a.x,{children:[(0,r.jsxs)(e4,{children:[(0,r.jsx)(a.x,{padding:{vertical:12,horizontal:24},margin:{top:32},border:"top",children:(0,r.jsx)(eF.h,{activeItems:new Set(["runs"]),buttons:[{id:"evaluations",label:"Evaluations"},{id:"runs",label:"Runs"}],onClick:e=>{n(e)}})}),(0,r.jsx)(e0.A,{runs:(null==l?void 0:l.__typename)==="Runs"?l.results:[]})]}),(0,r.jsx)("div",{style:{paddingBottom:"16px"},children:(0,r.jsx)(eX.pI,{...o})})]})},e4=S.ZP.div.withConfig({componentId:"sc-8fab7b65-0"})(["position:relative;> *:nth-child(2){position:absolute;right:0;top:0;}"]);var e5=i(54123),e3=i(69706),e9=i(88322);let e6=e=>{let{loading:t,ticks:i,tickStatus:n,setTickStatus:s,setSelectedTick:o,paginationProps:l,actionBarComponents:d}=e;return(0,r.jsxs)(a.x,{children:[(0,r.jsxs)(a.x,{flex:{justifyContent:"space-between",alignItems:"center"},padding:{vertical:12,horizontal:24},margin:{top:32},border:"top",children:[(0,r.jsxs)(a.x,{flex:{direction:"row",gap:8,alignItems:"center"},children:[d,!t||(null==i?void 0:i.length)?null:(0,r.jsx)(c.$,{purpose:"body-text"})]}),(0,r.jsx)(tt,{status:n,onChange:s})]}),(0,r.jsxs)(ti,{children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{style:{width:120},children:"Timestamp"}),(0,r.jsx)("th",{style:{width:90},children:"Status"}),(0,r.jsx)("th",{style:{width:90},children:"Duration"}),(0,r.jsx)("th",{style:{width:180},children:"Result"})]})}),(0,r.jsx)("tbody",{children:i.map((e,t)=>{let i=0!==t&&e.status===eW.izS.STARTED&&!l.hasPrevCursor;return(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{children:(0,r.jsx)(eQ.E,{timestamp:{unix:e.timestamp},timeFormat:{showTimezone:!0}})}),(0,r.jsx)("td",{children:(0,r.jsx)(e9.a,{tick:e,tickResultType:"materializations",isStuckStarted:i})}),(0,r.jsx)("td",{children:i?" - ":(0,r.jsx)(e3.Q,{startUnix:e.timestamp,endUnix:e.endTimestamp})}),(0,r.jsx)("td",{children:[eW.izS.SKIPPED,eW.izS.SUCCESS].includes(e.status)?(0,r.jsx)(e5.Z,{onClick:()=>{o(e)},children:(0,r.jsxs)(f.pN,{children:[e.requestedAssetMaterializationCount," materializations requested"]})}):" - "})]},e.id)})})]}),(0,r.jsx)("div",{style:{paddingBottom:"16px"},children:(0,r.jsx)(eX.pI,{...l})})]})};(n=s||(s={})).ALL="all",n.FAILED="failed",n.SUCCESS="success";let e7={all:[eW.izS.SUCCESS,eW.izS.FAILURE,eW.izS.STARTED,eW.izS.SKIPPED],failed:[eW.izS.FAILURE],success:[eW.izS.SUCCESS]},te=[{key:"all",label:"All ticks"},{key:"success",label:"Requested"},{key:"failed",label:"Failed"}],tt=e=>{let{status:t,onChange:i}=e,n=te.find(e=>{let{key:i}=e;return i===t});return(0,r.jsx)(j.P,{popoverProps:{position:"bottom-right"},filterable:!1,activeItem:n,items:te,itemRenderer:(e,t)=>(0,r.jsx)(v.sN,{active:t.modifiers.active,onClick:t.handleClick,text:e.label,style:{width:"300px"}},e.key),onItemSelect:e=>i(e.key),children:(0,r.jsx)(l.zx,{rightIcon:(0,r.jsx)(p.JO,{name:"arrow_drop_down"}),style:{minWidth:"200px",display:"flex",justifyContent:"space-between"},children:null==n?void 0:n.label})})},ti=(0,S.ZP)(eU.i).withConfig({componentId:"sc-1b725a66-0"})(["th,td{vertical-align:middle !important;}"]),tn=e=>{var t,i;let{setSelectedTick:n,setTimerange:o,setParentStatuses:l,actionBarComponents:a}=e,[c,u]=(0,L.q)({queryKey:"status",defaults:{status:s.ALL}}),h=(0,d.useMemo)(()=>e7[c]||e7[s.ALL],[c]),{queryResult:x,paginationProps:p}=(0,e1.l)({query:eZ,variables:{statuses:(0,d.useMemo)(()=>Array.from(h),[h])},nextCursorForResult:e=>{var t;let i=e.autoMaterializeTicks;if(i.length)return null===(t=i[14])||void 0===t?void 0:t.id},getResultArray:e=>(null==e?void 0:e.autoMaterializeTicks)?e.autoMaterializeTicks:[],pageSize:15});return(0,C.C4)(x,1e4,!p.hasPrevCursor),(0,d.useEffect)(()=>{if(p.hasPrevCursor){var e,t,i;let n=null===(e=x.data)||void 0===e?void 0:e.autoMaterializeTicks;if(n&&n.length){let e=null===(t=n[n.length-1])||void 0===t?void 0:t.timestamp,s=null===(i=n[0])||void 0===i?void 0:i.endTimestamp;e&&s&&o([e,s])}}else o(void 0)},[p.hasPrevCursor,null===(t=x.data)||void 0===t?void 0:t.autoMaterializeTicks,o]),(0,d.useEffect)(()=>{p.hasPrevCursor?l(Array.from(h)):l(void 0)},[p.hasPrevCursor,l,h]),(0,r.jsx)(e6,{loading:x.loading,ticks:(null===(i=x.data)||void 0===i?void 0:i.autoMaterializeTicks)||[],paginationProps:p,setSelectedTick:n,tickStatus:c,setTickStatus:u,actionBarComponents:a})};var ts=i(15103),tr=i(71498),to=i(1168),tl=i(5242),ta=i(47793),td=i(92237);let tc={tags:[{key:"dagster/auto_materialize",value:"true"}]},tu=()=>{var e;let t=(0,et.dx)(),{flagLegacyRunsPage:i}=(0,tr.gV)(),n=(0,ts.p)(),{permissions:{canToggleAutoMaterialize:s}={}}=(0,to.WB)(),[o,l]=(0,d.useState)(!1),[u,h]=(0,d.useState)(void 0),[x,p]=(0,d.useState)(void 0),m=(0,d.useCallback)(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Date.now();return x||u?{afterTimestamp:null==x?void 0:x[0],beforeTimestamp:null==x?void 0:x[1],statuses:u}:{afterTimestamp:(e-12e5)/1e3}},[u,x]),[j,v]=(0,ez.td)(eZ),y=(0,d.useCallback)(async()=>await j({variables:m()}),[j,m]);(0,d.useEffect)(()=>{y()},[y]),(0,C.bT)({refresh:y,enabled:!o&&!x&&!u,intervalMs:2e3,leading:!0});let[w,S]=(0,d.useState)(null),[b,k]=(0,L.q)((0,d.useMemo)(()=>({queryKey:"view",decode:e=>{let{view:t}=e;return"runs"===t?"runs":"evaluations"},encode:e=>({view:e,cursor:void 0,statuses:void 0})}),[])),T=null!==(e=v.data)&&void 0!==e?e:v.previousData,z=(0,d.useMemo)(()=>(null==T?void 0:T.autoMaterializeTicks)||[],[T]),I=(0,d.useMemo)(()=>{var e;return null!==(e=null==z?void 0:z.map((e,t)=>{let i=z[t-1];if(i&&(0,ta.g6)(e,t)){let t={...e};return t.endTimestamp=i.timestamp,t.status=eW.izS.FAILURE,t}return e}))&&void 0!==e?e:[]},[JSON.stringify(z.map(e=>"".concat(e.id,":").concat(e.status)))]),A=(0,d.useCallback)(e=>{l(!!e)},[l]),E=(0,r.jsx)(eF.h,{activeItems:new Set([b]),buttons:[{id:"evaluations",label:"Evaluations"},{id:"runs",label:"Runs"}],onClick:e=>{k(e)}});return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(eU.i,{children:(0,r.jsxs)("tbody",{children:[(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{children:"Running"}),(0,r.jsx)("td",{children:t.loading?(0,r.jsx)(c.$,{purpose:"body-text"}):(0,r.jsx)(e_.X,{format:"switch",checked:!t.paused,disabled:!s,onChange:async e=>{let i=e.target.checked;i||await n({title:"Pause Auto-materializing?",description:"Pausing Auto-materializing will prevent new materializations triggered by an Auto-materializing policy."}),t.setPaused(!i)}})})]}),(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{children:"Evaluation frequency"}),(0,r.jsx)("td",{children:"~30s"})]})]})}),(0,r.jsx)(a.x,{padding:{vertical:12,horizontal:24},border:"bottom",children:(0,r.jsx)(f.Tj,{children:"Evaluation timeline"})}),T?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(tl.p,{ticks:I,tickResultType:"materializations",onHoverTick:A,onSelectTick:S,exactRange:x,timeRange:12e5,tickGrid:3e5,timeAfter:18e4}),(0,r.jsx)(eH,{tick:w,isOpen:!!w,close:()=>{S(null)}}),"evaluations"===b?(0,r.jsx)(tn,{setSelectedTick:S,setParentStatuses:h,setTimerange:p,actionBarComponents:E}):i?(0,r.jsx)(e8,{setTableView:k}):(0,r.jsx)(a.x,{margin:{top:32},border:"top",children:(0,r.jsx)(td.g,{filter:tc,actionBarComponents:E,includeRunsFromBackfills:!0})})]}):(0,r.jsxs)(a.x,{padding:{vertical:48},flex:{direction:"row",justifyContent:"center",gap:12,alignItems:"center"},children:[(0,r.jsx)(c.$,{purpose:"body-text"}),(0,r.jsx)("div",{style:{color:g.$()},children:"Loading evaluations…"})]})]})};var th=i(6317);let tx=()=>{let e=(0,ee.I)();switch(e){case"unknown":return(0,r.jsx)("div",{});case"has-global-amp":return(0,r.jsx)(tp,{});case"has-sensor-amp":return(0,r.jsx)(o.l_,{to:"/automation"});default:(0,th.UT)(e)}},tp=()=>((0,k.Px)(),(0,P.j)("Overview | Auto-materialize"),(0,r.jsxs)(eO.T,{children:[(0,r.jsx)(es,{tab:"amp"}),(0,r.jsx)(tu,{})]})),tm=()=>(0,r.jsxs)(o.rs,{children:[(0,r.jsx)(eo.A,{path:"/overview/activity",isNestingRoute:!0,children:(0,r.jsx)(ed,{})}),(0,r.jsx)(eo.A,{path:"/overview/jobs",render:()=>(0,r.jsx)(o.l_,{to:"/jobs"})}),(0,r.jsx)(eo.A,{path:"/overview/schedules",render:()=>(0,r.jsx)(o.l_,{to:"/automation"})}),(0,r.jsx)(eo.A,{path:"/overview/sensors",render:()=>(0,r.jsx)(o.l_,{to:"/automation"})}),(0,r.jsx)(eo.A,{path:"/overview/automation",render:()=>(0,r.jsx)(tx,{})}),(0,r.jsx)(eo.A,{path:"/overview/backfills",exact:!0,render:()=>(0,r.jsx)(o.l_,{to:"/runs?view=backfills"})}),(0,r.jsx)(eo.A,{path:"/overview/resources",children:(0,r.jsx)(eN,{})}),(0,r.jsx)(eo.A,{path:"*",isNestingRoute:!0,render:()=>(0,r.jsx)(o.l_,{to:"/overview/activity"})})]});var tg=tm},39916:function(e,t,i){i.d(t,{S:function(){return s}});var n=i(27450);let s=e=>[...e].sort((e,t)=>{let i=(0,n.Uz)(e.repoAddress),s=(0,n.Uz)(t.repoAddress);return i.localeCompare(s)})},39282:function(e,t,i){i.d(t,{S:function(){return r}});var n=i(91987),s=i(27450);let r=e=>new Set(e.map(e=>(0,s.Uz)((0,n.kQ)(e.repository.name,e.repositoryLocation.name))))},88322:function(e,t,i){i.d(t,{a:function(){return g}});var n=i(52322),s=i(54854),r=i(38082),o=i(3217),l=i(26834),a=i(48177),d=i(54123),c=i(12597),u=i(39361),h=i(94466),x=i(2784),p=i(34515),m=i(84991);let g=e=>{let{tick:t,tickResultType:i,isStuckStarted:g}=e,[j,v]=(0,x.useState)(!1),f=(0,x.useMemo)(()=>{let e="materializations"===i?"materialization":"run";switch(t.status){case m.izS.STARTED:return(0,n.jsx)(s.V,{intent:"primary",icon:g?void 0:"spinner",children:g?"In progress":"Evaluating"});case m.izS.SKIPPED:let u=(0,n.jsx)(r.m,{fillColor:o.fk(),label:"materializations"===i?"0 materializations requested":"0 runs requested"});if("runKeys"in t&&t.runKeys.length){let e="".concat(t.runKeys.length," runs requested, but skipped because the runs already exist for the requested keys.");return(0,n.jsx)(l.u,{position:"right",content:e,children:u})}if("skipReason"in t&&t.skipReason)return(0,n.jsx)(l.u,{position:"right",content:t.skipReason,targetTagName:"div",children:u});return u;case m.izS.FAILURE:return(0,n.jsxs)(a.x,{flex:{direction:"row",alignItems:"center",gap:6},children:[(0,n.jsx)(s.V,{intent:"danger",children:"Failure"}),t.error?(0,n.jsx)(d.Z,{onClick:()=>{v(!0)},children:"View"}):null]});case m.izS.SUCCESS:let h="materializations"===i?t.requestedAssetMaterializationCount:t.runIds.length,x=(0,n.jsxs)(s.V,{intent:"success",children:[h," ",e,(0,c.I)(h,"","s")," requested"]});if("runKeys"in t&&t.runKeys.length>t.runIds.length){let e="".concat(t.runKeys.length," runs requested, but ").concat(t.runKeys.length-t.runIds.length," skipped because the runs already exist for those requested keys.");return(0,n.jsx)(l.u,{position:"right",content:e,children:x})}return x}},[g,t,i]);return(0,n.jsxs)(n.Fragment,{children:[f,t.error?(0,n.jsxs)(u.Vq,{isOpen:j,title:"Error",style:{width:"80vw"},children:[(0,n.jsx)(u.a7,{children:(0,n.jsx)(p.T9,{error:t.error})}),(0,n.jsx)(u.cN,{topBorder:!0,children:(0,n.jsx)(h.zx,{intent:"primary",onClick:()=>{v(!1)},children:"Close"})})]}):null]})}}}]);
//# sourceMappingURL=5518.7c22bde8d56f1d73.js.map