import{d as z,i as y,a as g,c as I,o as p,e as m,f as l,y as S,z as N,A as M,n as d,q as c,x as _,t as T,_ as $,j as W,ap as V,r as A,U as F,s as D,M as R,a6 as q,b as G,G as J,P as h,T as O}from"./index-DRQkzaGL.js";import{u as P}from"./useWorkflowRun-D2zjppUo.js";import{u as E}from"./floating-ui.vue-CZ60wBMe.js";import{B as K}from"./BaseTransitionSlideFade-BBIsMEkV.js";const L={class:"WorkflowToolbarBlocksDropdown"},U={class:"WorkflowToolbarBlocksDropdown__list"},H={class:"WorkflowToolbarBlocksDropdown__list__item__description"},Q={class:"WorkflowToolbarBlocksDropdown__list__item__title"},X=z({__name:"WorkflowToolbarBlocksDropdown",props:{components:{type:Array,required:!0}},emits:{jumpToComponent:u=>typeof u=="string",runBranch:u=>typeof u=="string"},setup(u){const f=u,r=y(g.core);function w(e){const t=r.getComponentDefinition(e.type);return(t==null?void 0:t.name)??e.type}function k(e){if(e.type!=="workflows_uieventtrigger"||!!e.content.defaultResult)return!0;const s=(e.outs??[]).map(n=>r.getComponentById(n.toNodeId)).flatMap(n=>Object.values(n.content??{}));return s.length===0?!0:!s.some(n=>n.includes("@{result}"))}const b=I(()=>f.components.map(e=>{var n;const t=r.getComponentDefinition(e.type),s=((n=e.content)==null?void 0:n.alias)||w(e),i=(t==null?void 0:t.name)??e.type;return{id:e.id,disabled:!k(e),title:s,description:i}}));return(e,t)=>(p(),m("div",L,[t[2]||(t[2]=l("p",{class:"WorkflowToolbarBlocksDropdown__header"},"Start workflow from",-1)),l("div",U,[(p(!0),m(S,null,N(b.value,s=>(p(),m("div",{key:s.id,class:M(["WorkflowToolbarBlocksDropdown__list__item",{"WorkflowToolbarBlocksDropdown__list__item--disabled":s.disabled}])},[d(_,{variant:"primary",size:"smallIcon","custom-size":"20px",disabled:s.disabled,"data-writer-tooltip":s.disabled?"Can not run without a default result. Go to this block to define a default result.":"Run the branch",onClick:i=>e.$emit("runBranch",s.id)},{default:c(()=>t[0]||(t[0]=[l("i",{class:"material-symbols-outlined"},"play_arrow",-1)])),_:2},1032,["disabled","data-writer-tooltip","onClick"]),l("div",null,[l("p",H,T(s.description),1),l("p",Q,T(s.title),1)]),d(_,{variant:"neutral",size:"smallIcon","custom-size":"20px","data-writer-tooltip":"Jump to the workflow",onClick:i=>e.$emit("jumpToComponent",s.id)},{default:c(()=>t[1]||(t[1]=[l("i",{class:"material-symbols-outlined"},"jump_to_element",-1)])),_:2},1032,["onClick"])],2))),128))])]))}}),Y=$(X,[["__scopeId","data-v-fbc1a85b"]]),Z={ref:"seeWorkflowsBtn",class:"WorkflowToolbar__btn"},oo={class:"material-symbols-outlined"},eo=z({__name:"WorkflowToolbar",emits:{autogenClick:()=>!0},setup(u){const f=y(g.core),r=y(g.builderManager),w=y(g.componentId),k=W("root"),b=W("dropdown"),{run:e,isRunning:t}=P(f,w),{floatingStyles:s}=E(k,b,{placement:"bottom-end",middleware:[V(12)]}),i=I(()=>f.getComponents(w).filter(a=>{var o;return((o=f.getComponentDefinition(a.type))==null?void 0:o.category)==="Triggers"})),n=A(!1),v=F([]);function j(){var a;if(n.value=!n.value,n.value)v.value=O(r.selection.value),r.setSelection(null);else if((a=v.value)!=null&&a.length){r.setSelection(null);for(const o of v.value)r.appendSelection(o.componentId,o.instancePath,o.source);v.value=[]}}function x(a){r.setSelection(a,void 0,"click"),n.value=!1}async function B(a){n.value=!1,await e(a)}return(a,o)=>(p(),m("div",{ref_key:"root",ref:k,class:"WorkflowToolbar","data-writer-unselectable":!0},[d(_,{variant:"secondary","data-automation-action":"run-autogen",onClick:o[0]||(o[0]=C=>a.$emit("autogenClick"))},{default:c(()=>o[3]||(o[3]=[l("i",{class:"material-symbols-outlined"},"bolt",-1),D(" Autogen ")])),_:1}),l("div",Z,[d(_,{variant:"secondary",size:"small","data-automation-action":"run-workflow",class:"WorkflowToolbar__btn__runWorkflow",onClick:o[1]||(o[1]=q(C=>B(),["stop"]))},{default:c(()=>[o[4]||(o[4]=l("i",{class:"material-symbols-outlined"},"play_arrow",-1)),D(" "+T(R(t)?"Running...":"Run blueprint"),1)]),_:1}),i.value.length>1?(p(),m(S,{key:0},[o[5]||(o[5]=l("hr",{class:"WorkflowToolbar__btn__divider"},null,-1)),d(_,{class:"WorkflowToolbar__btn__dropdownTrigger",variant:"secondary",size:"smallIcon","custom-size":"20px",onClickCapture:j},{default:c(()=>[l("i",oo,T(n.value?"arrow_drop_up":"arrow_drop_down"),1)]),_:1}),d(K,null,{default:c(()=>[n.value?(p(),G(Y,{key:0,ref_key:"dropdown",ref:b,style:J(R(s)),components:i.value,onJumpToComponent:x,onRunBranch:o[2]||(o[2]=C=>B(C))},null,8,["style","components"])):h("",!0)]),_:1})],64)):h("",!0)],512)],512))}}),ao=$(eo,[["__scopeId","data-v-3650dd70"]]);export{ao as default};
