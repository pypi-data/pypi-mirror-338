[project]
name = "nesso_cli"
description = "A CLI tool for managing data models."
readme = "README.md"
version = "0.11.5"
authors = [{ name = "MichaÅ‚ Zawadzki", email = "mzawadzki@dyvenia.com" }]
classifiers = []
keywords = ["cli", "dbt", "dyvenia", "data", "nesso", "models"]
requires-python = ">=3.10, <3.13"
dependencies = [
  "loguru==0.7.2",
  "python-dotenv==1.0.0",
  "ruamel.yaml==0.18.5",
  "pydantic>=1.10.11,<2",
  "typer>=0.9.0",
  # Below fork of the dbt-core-interface is vendored till https://github.com/z3z1ma/dbt-core-interface/pull/117 is merged.
  # "dbt-core-interface @ git+https://github.com/trymzet/dbt-core-interface",
]

[project.optional-dependencies]
test = [
  "pytest==7.4.3",
  "pytest-cov==4.1.0",
  "pytest-env==1.1.1",
  "coverage==7.3.2",
  "black==22.12.0",
  "mypy==1.7.0",
  "sqlalchemy==1.4.50",
  "faker==20.1.0",
  "getkey==0.6.5",
  "pandas>=1.5.3,<2.0.0",
  "mock==5.1.0",
  "genbadge[coverage]==1.1.0",
  "flake8==6.1.0",
  "Flake8-pyproject==1.2.3",
  "tomlkit==0.12.3",
  "interrogate[png]==1.5.0",
  "dbt-postgres==1.7.12",
  "numpy>=1.26.4,<2.0",
]
docs = [
  "mkdocs-material[imaging]>=9.4.3",
  "mkdocs-mermaid2-plugin>=1.1.0",
  "mkdocs-include-dir-to-nav>=1.2.0",
  "neoteroi-mkdocs>=1.0.4",
  "mkdocs-jupyter>=0.24.4",
  "mkdocstrings[python]>=0.23.0",
  "mkdocs>=1.5.3",
  "mike>=1.1.2",
  "mkdocs-table-reader-plugin>=2.0.3",
  "mkdocs-include-markdown-plugin>=5.1.0",
  "mkdocs-git-revision-date-plugin>=0.3.2",
  "mkdocs-glightbox>=0.4.0",
]
dev = [
  "nesso_cli[test]",
  "nesso_cli[docs]",
  "dbt-osmosis>=0.12.4",
  "sqlfluff>=2.3.5",
]

trino = ["dbt-trino==1.7.1"]
redshift = ["dbt-redshift==1.7.7"]
databricks = ["dbt-databricks==1.7.17"]
# Workaround till https://github.com/trymzet/dbt-sqlserver/tree/sql_header_and_option_clausle is merged to dbt-sqlserver 1.7.
sqlserver = ["dbt-sqlserver-dyvenia==1.7.4"]
postgres = ["dbt-postgres==1.7.12"]
duckdb = ["dbt-duckdb==1.7.4", "duckdb>=1.0.0"]

all = [
  "nesso_cli[trino]",
  "nesso_cli[redshift]",
  "nesso_cli[databricks]",
  "nesso_cli[sqlserver]",
  "nesso_cli[postgres]",
  "nesso_cli[duckdb]",
]

[project.scripts]
nesso = "nesso_cli.nesso_cli:cli"

[tool.setuptools]
packages = ["cli"]

[tool.black]
line-length = 88
exclude = '''
/(
    \.git
  | \.mypy_cache
  | \.tox
  | venv
  | \.venv
  | _build
  | buck-out
  | build
  | dist
)/
'''

[tool.isort]
# make it compatible with Black
profile = "black"

[tool.flake8]
extend-ignore = "F722"
exclude = "_vendored"

max-line-length = 88
[tool.interrogate]
fail-under = 40
quiet = false
exclude = ["src/nesso_cli/models/tests/"]
generate-badge = "coverage/docstring_coverage.svg"


[build-system]
build-backend = "flit_core.buildapi"
requires = ["flit_core>=3.8,<4"]
