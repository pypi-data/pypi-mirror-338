import"../chunks/Bg9kRutz.js";import{p as et,a as s,s as c,f as k,b as tt,c as _,d as t,g as e,e as ge,r as i,h as U,t as at}from"../chunks/AM9C8FsA.js";import{s as ae}from"../chunks/B6F1ZNoe.js";import{p as a,i as S}from"../chunks/D-bC_bvq.js";import{e as he,i as pe}from"../chunks/DtXDWrBL.js";import{t as y,a as n,c as W}from"../chunks/CmMFD2-g.js";import{d as ot}from"../chunks/DY_kk6CS.js";import{S as lt,c as fe,d as rt,f as nt,B as st}from"../chunks/CKOPQ9yJ.js";import{A as me}from"../chunks/B6QOD9Jc.js";import{R as ye}from"../chunks/CZs2-MWJ.js";var it=(ee,L)=>{L()},ct=y("<option> </option>"),dt=(ee,L)=>{L()},_t=y("<option> </option>"),vt=y('<h3>Technology Type</h3> <select class="form-select"></select> <!>',1),ut=(ee,L)=>{L()},gt=y("<option> </option>"),ht=y('<h3>Carrier</h3> <select class="form-select"><!> </select>',1),pt=y("<h3>Technology</h3> <!>",1),ft=y("<h3>Node</h3> <!>",1),mt=y('<div class="accordion-item"><h2 class="accordion-header"><button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseThree" aria-expanded="false" aria-controls="collapseThree">Data Selection</button></h2> <div id="collapseThree" class="accordion-collapse collapse show"><div class="accordion-body"><div class="row"><div class="col-6"><h3>Aggregation</h3> <!></div> <div class="col-6"><h3>Normalisation</h3> <!></div></div> <!> <h3>Year</h3> <!></div></div></div>'),yt=y('<div class="accordion-item variable-selection"><h2 class="accordion-header"><button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">Variable Selection</button></h2> <div id="collapseTwo" class="accordion-collapse collapse show"><div class="accordion-body"><h3>Variable</h3> <select class="form-select"></select> <!> <!></div></div></div> <!>',1),bt=y('<div class="text-center"><div class="spinner-border center" role="status"><span class="visually-hidden">Loading...</span></div></div>'),xt=y('<div class="text-center">No technologies with this selection.</div>'),wt=y('<div class="text-center">No carriers with this selection.</div>'),Tt=y('<div class="text-center">No solution selected.</div>'),Nt=y('<div class="text-center">No data with this selection.</div>'),St=y('<div class="text-center">No locations with this selection.</div>'),zt=y('<div class="text-center">No data with this selection.</div>'),kt=y('<h2>Capacity</h2> <div class="z-1 position-relative"><div class="filters"><div class="accordion" id="accordionExample"><div class="accordion-item solution-selection"><h2 class="accordion-header"><button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">Solution Selection</button></h2> <div id="collapseOne" class="accordion-collapse collapse show"><div class="accordion-body"><!></div></div></div> <!></div></div></div> <div class="mt-4"><!></div>',1);function Ft(ee,L){et(L,!0);let Ve=["conversion","storage","transport"],R=s(null),P=s(null),Ye=["capacity","capacity_addition"],A=s(a([])),V=s(a([])),X=s(a([])),E=s(a([])),g=s(null),De=a(["technology","node"]);const Fe=["not_normalized","normalized"],be=["energy","power"];let xe=s(a({})),Y=s(null),D=s(null),oe=s("energy"),K=s("technology"),N=s(null),q=s(a([])),Z=s(a([])),G=s(a([])),te=s("not_normalized"),C=s(!1),j=s(!1),we=s(""),le=s(a([])),Te=s(a([])),Le=ge(()=>({type:"bar",data:{datasets:e(le),labels:e(Te)},options:{responsive:!0,scales:{x:{stacked:!0,title:{display:!0,text:"Year"}},y:{stacked:!0,title:{display:!0,text:`${e(Y)} [${e(E).length>0?e(xe)[e(E)[0]]:""}]`}}}}}));function re(){t(te,"not_normalized"),t(G,a(e(V))),t(q,a(e(E))),t(Z,a(e(X))),t(K,"node")}async function Pe(){var l;if(t(j,!0),t(R,null),await at(),e(Y)===null){t(j,!1);return}const o=await rt(e(g).solution_name,e(Y),e(g).scenario_name,e(g).detail.system.reference_year,e(g).detail.system.interval_between_years);t(R,a(o.data)),(l=o.unit)!=null&&l.data&&t(xe,a(Object.fromEntries(o.unit.data.map(v=>[v.technology,v[0]||v.units])))),t(j,!1)}function qe(){t(R,null),t(Y,null),t(P,null),t(N,null),t(D,null)}function Ge(){Pe(),re(),t(N,null),t(D,null),t(P,null),t(le,a([]))}function Ne(){Ie(),ke(),Se(),re(),H()}function He(){ke(),Se(),re(),H()}function Ie(){if(t(A,a([])),e(R)===null||e(N)===null)return;let o=ze();e(R).data.forEach(l=>{let v=l.technology,z=e(g).detail.reference_carrier[v];!e(A).includes(z)&&o.includes(l.technology)&&e(A).push(z)}),e(A).length>0&&t(D,a(e(A)[0]))}function Se(){t(V,a([])),e(R).data.forEach(o=>{let l=o.technology,v=e(g).detail.reference_carrier[l];e(E).includes(o.technology)&&!e(V).includes(o.location)&&e(V).push(o.location),!e(A).includes(v)&&e(E).includes(o.technology)&&e(A).push(v)}),t(G,a(e(V)))}function ze(){if(!e(g)||!e(N))return[];switch(e(N)){case"conversion":return e(g).detail.system.set_conversion_technologies;case"storage":return e(g).detail.system.set_storage_technologies;case"transport":return e(g).detail.system.set_transport_technologies}return[]}function ke(){if(e(N)===null)return;let o=ze();t(E,a(o.filter(l=>{var v;return((v=e(g))==null?void 0:v.detail.reference_carrier[l])==e(D)}))),t(q,a(e(E)))}function H(){var I;if(e(K)=="technology"?t(G,a(e(V))):t(q,a(e(E))),e(Y)==null||e(G).length==0||e(Z).length==0||e(q).length==0||e(R)===null){t(P,null);return}let o={},l={};e(K)=="technology"?(o.location=e(G),l.technology=e(q)):(o.technology=e(q),l.location=e(G)),e(N)=="storage"?l.capacity_type=[e(oe)]:l.capacity_type=be;let v=e(X).filter(h=>!e(Z).includes(h));t(P,a(nt(e(R).data,o,l,v,e(te)=="normalized"))),t(le,a(e(P))),t(Te,a(e(Z).map(h=>h.toString())));let z=e(g).solution_name.split(".");t(we,a([z[(z==null?void 0:z.length)-1],(I=e(g))==null?void 0:I.scenario_name,e(Y),e(N),e(D)].join("_")))}var Ee=kt(),ne=c(k(Ee),2),Oe=_(ne),Ae=_(Oe),se=_(Ae),Ce=c(_(se),2),je=_(Ce),Je=_(je);const Ke=ge(()=>!e(j)&&!e(C));lt(Je,{solution_selected:qe,get enabled(){return e(Ke)},get years(){return e(X)},set years(o){t(X,a(o))},get selected_solution(){return e(g)},set selected_solution(o){t(g,a(o))},get loading(){return e(C)},set loading(o){t(C,a(o))}}),i(je),i(Ce),i(se);var Me=c(se,2);{var Qe=o=>{var l=yt(),v=k(l),z=c(_(v),2),I=_(z),h=c(_(I),2);h.__change=[it,Ge],he(h,21,()=>Ye,pe,(p,b)=>{var r=ct(),f={},w=_(r,!0);i(r),U(()=>{f!==(f=e(b))&&(r.value=(r.__value=e(b))==null?"":e(b)),ae(w,e(b))}),n(p,r)}),i(h);var J=c(h,2);{var ie=p=>{var b=vt(),r=c(k(b),2);r.__change=[dt,Ne],he(r,21,()=>Ve,pe,(m,x)=>{var u=_t(),T={},O=_(u,!0);i(u),U(()=>{T!==(T=e(x))&&(u.value=(u.__value=e(x))==null?"":e(x)),ae(O,e(x))}),n(m,u)}),i(r);var f=c(r,2);{var w=m=>{const x=ge(()=>!e(j)&&!e(C));ye(m,{options:be,selection_changed:Ne,get enabled(){return e(x)},get selected_option(){return e(oe)},set selected_option(u){t(oe,a(u))}})};S(f,m=>{e(N)=="storage"&&m(w)})}U(()=>r.disabled=e(j)||e(C)),fe(r,()=>e(N),m=>t(N,m)),n(p,b)};S(J,p=>{e(Y)!=null&&p(ie)})}var ce=c(J,2);{var de=p=>{var b=ht(),r=c(k(b),2);r.__change=[ut,He];var f=_(r);he(f,17,()=>e(A),pe,(m,x)=>{var u=gt(),T={},O=_(u,!0);i(u),U(()=>{T!==(T=e(x))&&(u.value=(u.__value=e(x))==null?"":e(x)),ae(O,e(x))}),n(m,u)});var w=c(f);i(r),U(()=>{r.disabled=e(j)||e(C),ae(w,` disabled=${(e(j)||e(C))??""}`)}),fe(r,()=>e(D),m=>t(D,m)),n(p,b)};S(ce,p=>{e(N)!=null&&e(A).length>0&&p(de)})}i(I),i(z),i(v);var F=c(v,2);{var M=p=>{var b=mt(),r=c(_(b),2),f=_(r),w=_(f),m=_(w),x=c(_(m),2);ye(x,{get options(){return De},selection_changed:d=>H(),get selected_option(){return e(K)},set selected_option(d){t(K,a(d))}}),i(m);var u=c(m,2),T=c(_(u),2);ye(T,{options:Fe,selection_changed:d=>H(),get selected_option(){return e(te)},set selected_option(d){t(te,a(d))}}),i(u),i(w);var O=c(w,2);{var _e=d=>{var B=pt(),$=c(k(B),2);me($,{get selected_elements(){return e(q)},get elements(){return e(E)},selection_changed:()=>{H()}}),n(d,B)},ve=d=>{var B=ft(),$=c(k(B),2);me($,{get selected_elements(){return e(G)},get elements(){return e(V)},selection_changed:Re=>{H()}}),n(d,B)};S(O,d=>{e(K)=="technology"?d(_e):d(ve,!1)})}var ue=c(O,4);me(ue,{get selected_elements(){return e(Z)},get elements(){return e(X)},selection_changed:d=>{H()}}),i(f),i(r),i(b),n(p,b)};S(F,p=>{e(R)&&e(N)&&e(D)&&e(E).length>0&&e(V).length>0&&p(M)})}U(()=>h.disabled=e(j)||e(C)),fe(h,()=>e(Y),p=>t(Y,p)),n(o,l)};S(Me,o=>{!e(C)&&e(g)&&o(Qe)})}i(Ae),i(Oe),i(ne);var Be=c(ne,2),Ue=_(Be);{var We=o=>{var l=bt();n(o,l)},Xe=o=>{var l=W(),v=k(l);{var z=h=>{var J=xt();n(h,J)},I=h=>{var J=W(),ie=k(J);{var ce=F=>{var M=wt();n(F,M)},de=F=>{var M=W(),p=k(M);{var b=f=>{var w=Tt();n(f,w)},r=f=>{var w=W(),m=k(w);{var x=T=>{var O=Nt();n(T,O)},u=T=>{var O=W(),_e=k(O);{var ve=d=>{var B=St();n(d,B)},ue=d=>{var B=W(),$=k(B);{var Re=Q=>{var $e=zt();n(Q,$e)},Ze=Q=>{st(Q,{get config(){return e(Le)},get plot_name(){return e(we)}})};S($,Q=>{e(P).length==0?Q(Re):Q(Ze,!1)},!0)}n(d,B)};S(_e,d=>{e(V).length==0?d(ve):d(ue,!1)},!0)}n(T,O)};S(m,T=>{e(P)==null?T(x):T(u,!1)},!0)}n(f,w)};S(p,f=>{e(g)==null?f(b):f(r,!1)},!0)}n(F,M)};S(ie,F=>{e(A).length==0?F(ce):F(de,!1)},!0)}n(h,J)};S(v,h=>{e(E).length==0?h(z):h(I,!1)},!0)}n(o,l)};S(Ue,o=>{e(C)||e(j)?o(We):o(Xe,!1)})}i(Be),n(ee,Ee),tt()}ot(["change"]);export{Ft as component};
