import"../chunks/Bg9kRutz.js";import{p as ua,a as f,s as c,f as O,b as pa,c as m,d as o,g as e,e as ke,t as Fe,r as p,h as ha}from"../chunks/AM9C8FsA.js";import{s as ma}from"../chunks/B6F1ZNoe.js";import{p as a,i as E}from"../chunks/D-bC_bvq.js";import{e as ga,i as ba}from"../chunks/Bbpm7MqF.js";import{t as S,a as w,c as Ne}from"../chunks/CmMFD2-g.js";import{S as ya,d as M,r as Y,f as Q,B as xa}from"../chunks/WCHrdp7r.js";import{A as B}from"../chunks/C0g7NPoM.js";import{R as wa}from"../chunks/BsIw7lIP.js";import{T as Pe}from"../chunks/_IZlJ5Y-.js";import{g as U}from"../chunks/CqS7hfz2.js";var Ca=S("Subdivision <!>",1),Sa=S('<div class="d-flex"><h4> </h4> <!> <!></div>'),Ta=S("<h4>Transport</h4> <!>",1),Oa=S("<h4>Storage</h4> <!>",1),Ea=S("<h4>Conversion</h4> <!>",1),ja=S("<h3>Cost of Carrier</h3> <!>",1),za=S("<h3>Shed Demand</h3> <!>",1),Aa=S("<h3>Location</h3> <!>",1),Da=S("<h3>Year</h3> <!>",1),Ba=S('<div class="accordion-item"><h2 class="accordion-header"><button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseCost" aria-expanded="false" aria-controls="collapseCost">Cost selection</button></h2> <div id="collapseCost" class="accordion-collapse collapse" data-bs-parent="#accordionExample"><div class="accordion-body"></div></div></div> <div class="accordion-item"><h2 class="accordion-header"><button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">Technology and Carrier Selection</button></h2> <div id="collapseTwo" class="accordion-collapse collapse" data-bs-parent="#accordionExample"><div class="accordion-body"><h3>Technologies (for Capex/Opex)</h3> <!> <!> <!> <!> <!></div></div></div> <div class="accordion-item"><h2 class="accordion-header"><button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseThree" aria-expanded="false" aria-controls="collapseThree">Data Selection</button></h2> <div id="collapseThree" class="accordion-collapse collapse" data-bs-parent="#accordionExample"><div class="accordion-body"><div class="accordion-body"><div class="row"><div class="col-6"><h3>Aggregation</h3> <!></div></div> <!> <!></div></div></div></div>',1),La=S('<div class="text-center"><div class="spinner-border center" role="status"><span class="visually-hidden">Loading...</span></div></div>'),Ra=S('<div class="text-center">No data with this selection.</div>'),Ya=S('<h2>Costs</h2> <div class="z-1 position-relative"><div class="filters"><div class="accordion" id="accordionExample"><div class="accordion-item solution-selection"><h2 class="accordion-header"><button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">Solution Selection</button></h2> <div id="collapseOne" class="accordion-collapse collapse show" data-bs-parent="#accordionExample"><div class="accordion-body"><!></div></div></div> <!></div></div></div> <div class="mt-4"><!></div>',1);function Qa(qe,Ge){ua(Ge,!0);let le=f(a([])),de=f(a([])),k=f(a([])),V=f(a([])),z=f(a([])),s=f(null),F=f(a([])),He="not_normalized",N=f(a([])),P=f(a([])),q=f(!1),T=f(!1),W=f(a([])),X=f(a([])),Z=f(a([])),$=f(a([])),L=f(a([])),ee=f(a([])),b,ce,G,C=f(void 0),A,H,ae=f(a([])),te=f(a([]));const v="Techology / Carrier",se=[v,"Location"];let oe=f(a(se[1])),ue=f(a({})),h=a({capex:{title:"Capex",show:!0,subdivision:!1},opex:{title:"Opex",show:!0,subdivision:!1},carrier:{title:"Carrier",show:!0,subdivision:!1},shed_demand:{title:"Shed Demand",show:!0,subdivision:!1},carbon_emission:{title:"Carbon Emissions",show:!0,subdivision:!1}});const I=" (Capex)",J=" (Opex)",pe="Capex",he="Opex",me="Carrier",ge="Shed Demand";let be=f("plot"),R=f(a([])),Ie=ke(()=>({type:"line",data:{datasets:e(R)},options:{responsive:!0,scales:{x:{stacked:!0,title:{display:!0,text:"Year"}},y:{stacked:!0,title:{display:!0,text:`Costs [${e(L).length>0?e(ue)[e(L)[0]]:""}]`}}}}}));async function Je(){var r;if(e(s)!=null){o(T,!0),await Fe(),o(C,a(await M(e(s).solution_name,U("capex_yearly",e(s).version),e(s).scenario_name,e(s).detail.system.reference_year,e(s).detail.system.interval_between_years))),A=await M(e(s).solution_name,U("opex_yearly",e(s).version),e(s).scenario_name,e(s).detail.system.reference_year,e(s).detail.system.interval_between_years),ce=await M(e(s).solution_name,U("cost_carbon_emissions_total",e(s).version),e(s).scenario_name,e(s).detail.system.reference_year,e(s).detail.system.interval_between_years),G=await M(e(s).solution_name,U("cost_carrier",e(s).version),e(s).scenario_name,e(s).detail.system.reference_year,e(s).detail.system.interval_between_years),H=await M(e(s).solution_name,U("cost_shed_demand",e(s).version),e(s).scenario_name,e(s).detail.system.reference_year,e(s).detail.system.interval_between_years),Y(G.data,"node","location"),Y(H.data,"node","location"),Y(A.data,"technology",v),Y(e(C).data,"technology",v),Y(G.data,"carrier",v),Y(H.data,"carrier",v);for(let l in e(C).data.data)e(C).data.data[l][v]=e(C).data.data[l][v]+I;for(let l in A.data.data)A.data.data[l][v]=A.data.data[l][v]+J;(r=e(C).unit)!=null&&r.data&&o(ue,a(Object.fromEntries(e(C).unit.data.map(l=>[l.technology,l[0]||l.units])))),o(V,a(Object.keys(e(s).detail.edges).concat(e(s).detail.system.set_nodes))),o(T,!1)}}function Ke(r){o(T,!0),b=new Array;let l=structuredClone(G.data);l.data=l.data.filter(t=>e(N).includes(t[v]));let u=structuredClone(H.data);if(u.data=u.data.filter(t=>e(P).includes(t[v])),e(C)!=null&&h.capex.show)if(h.capex.subdivision)b=b.concat(e(C).data.data);else{let t=Q(e(C).data.data,{location:e(z)},{[v]:r},[],!1);for(let n in t)t[n].data.location=t[n].label,t[n].data[v]=pe,b.push(t[n].data)}if(h.opex.show)if(h.opex.subdivision)b=b.concat(A.data.data);else{let t=Q(A.data.data,{location:e(z)},{[v]:r},[],!1);for(let n in t)t[n].data.location=t[n].label,t[n].data[v]=he,b.push(t[n].data)}if(h.carrier.show)if(h.carrier.subdivision)b=b.concat(l.data);else{let t=Q(l.data,{location:e(z)},{[v]:r},[],!1);for(let n in t)t[n].data.location=t[n].label,t[n].data[v]=me,b.push(t[n].data)}if(h.shed_demand.show)if(h.shed_demand.subdivision)b=b.concat(u.data);else{let t=Q(u.data,{location:e(z)},{[v]:r},[],!1);for(let n in t)t[n].data.location=t[n].label,t[n].data[v]=ge,b.push(t[n].data)}if(b.length==0){b=void 0,o(T,!1);return}o(T,!1)}function j(){o(T,!0);let r={},l={},u=[];for(const x of e(ee))u.push(x+I),u.push(x+J);for(const x of e($))u.push(x+I),u.push(x+J);for(const x of e(X))u.push(x+I),u.push(x+J);let t=[...u,...e(N),...e(P)];Ke(t),h.capex.subdivision||t.push(pe),h.opex.subdivision||t.push(he),h.carrier.subdivision||t.push(me),h.shed_demand.subdivision||t.push(ge),e(oe)==se[0]?(r.location=e(V),l[v]=t):(r[v]=t,l.location=e(z));let n=e(k).filter(x=>!e(F).includes(x)),_=He=="normalized";o(R,a([])),b&&o(R,a(Q(b,r,l,n,_))),ce.data.data.length>0&&h.carbon_emission.show&&e(R).push({label:"Total Carbon Costs",data:ce.data.data[0],type:"bar"}),o(T,!1)}async function Me(){var n;if(e(s)==null)return;await Je(),await Fe(),o(T,!0);let r=new Set;if(e(C)!=null)for(const _ of e(C).data.data)r.add(_[v].replace(I,""));for(const _ of A.data.data)r.add(_[v].replace(J,""));o(W,a(e(s).detail.system.set_transport_technologies.filter(_=>r.has(_)))),o(L,a(e(s).detail.system.set_conversion_technologies.filter(_=>r.has(_)))),o(Z,a(e(s).detail.system.set_storage_technologies.filter(_=>r.has(_)))),o(X,a(e(W))),o(ee,a(e(L))),o($,a(e(Z)));let l=new Set;for(const _ of G.data.data)l.add(_[v]);o(le,a(e(s).detail.system.set_carriers.slice())),o(ae,a(e(s).detail.carriers_import.concat(e(s).detail.carriers_export).filter(_=>l.has(_)))),o(N,a(e(ae)));let u=new Set;for(const _ of H.data.data)u.add(_[v]);o(te,a(e(s).detail.carriers_demand.filter(_=>u.has(_)))),o(P,a(e(te))),o(de,a(e(s).detail.system.set_nodes)),o(F,a(e(k))),o(z,a(e(V))),j(),o(T,!1);let t=e(s).solution_name.split(".");o(be,a([t[(t==null?void 0:t.length)-1],(n=e(s))==null?void 0:n.scenario_name,"costs"].join("_")))}var ye=Ya(),_e=c(O(ye),2),xe=m(_e),we=m(xe),ve=m(we),Ce=c(m(ve),2),Se=m(Ce),Qe=m(Se);const Ue=ke(()=>!e(q)&&!e(T));ya(Qe,{solution_selected:Me,get enabled(){return e(Ue)},get carriers(){return e(le)},set carriers(r){o(le,a(r))},get nodes(){return e(de)},set nodes(r){o(de,a(r))},get years(){return e(k)},set years(r){o(k,a(r))},get selected_solution(){return e(s)},set selected_solution(r){o(s,a(r))},get loading(){return e(q)},set loading(r){o(q,a(r))}}),p(Se),p(Ce),p(ve);var Ve=c(ve,2);{var We=r=>{var l=Ba(),u=O(l),t=c(m(u),2),n=m(t);ga(n,21,()=>Object.keys(h),ba,(i,d)=>{var y=Sa(),g=m(y),da=m(g);p(g);var Re=c(g,2);Pe(Re,{change:j,get value(){return h[e(d)].show},set value(K){h[e(d)].show=K}});var ca=c(Re,2);{var _a=K=>{var Ye=Ca(),va=c(O(Ye));Pe(va,{change:j,get value(){return h[e(d)].subdivision},set value(fa){h[e(d)].subdivision=fa}}),w(K,Ye)};E(ca,K=>{h[e(d)].show&&e(d)!="carbon_emission"&&K(_a)})}p(y),ha(()=>ma(da,`${h[e(d)].title??""} :`)),w(i,y)}),p(n),p(t),p(u);var _=c(u,2),x=c(m(_),2),re=m(x),ie=c(m(re),2);{var D=i=>{var d=Ta(),y=c(O(d),2);B(y,{get elements(){return e(W)},selection_changed:()=>{j()},get selected_elements(){return e(X)},set selected_elements(g){o(X,a(g))}}),w(i,d)};E(ie,i=>{e(W).length>0&&i(D)})}var ne=c(ie,2);{var ea=i=>{var d=Oa(),y=c(O(d),2);B(y,{get elements(){return e(Z)},selection_changed:()=>{j()},get selected_elements(){return e($)},set selected_elements(g){o($,a(g))}}),w(i,d)};E(ne,i=>{e(Z).length>0&&i(ea)})}var Oe=c(ne,2);{var aa=i=>{var d=Ea(),y=c(O(d),2);B(y,{get elements(){return e(L)},selection_changed:()=>{j()},get selected_elements(){return e(ee)},set selected_elements(g){o(ee,a(g))}}),w(i,d)};E(Oe,i=>{e(L).length>0&&i(aa)})}var Ee=c(Oe,2);{var ta=i=>{var d=ja(),y=c(O(d),2);B(y,{get elements(){return e(ae)},selection_changed:()=>{j()},get selected_elements(){return e(N)},set selected_elements(g){o(N,a(g))}}),w(i,d)};E(Ee,i=>{e(ae).length>0&&i(ta)})}var sa=c(Ee,2);{var oa=i=>{var d=za(),y=c(O(d),2);B(y,{get elements(){return e(te)},selection_changed:()=>{j()},get selected_elements(){return e(P)},set selected_elements(g){o(P,a(g))}}),w(i,d)};E(sa,i=>{e(te).length>0&&i(oa)})}p(re),p(x),p(_);var je=c(_,2),ze=c(m(je),2),Ae=m(ze),De=m(Ae),fe=m(De),Be=m(fe),ra=c(m(Be),2);wa(ra,{options:se,selection_changed:i=>j(),get selected_option(){return e(oe)},set selected_option(i){o(oe,a(i))}}),p(Be),p(fe);var Le=c(fe,2);{var ia=i=>{var d=Aa(),y=c(O(d),2);B(y,{get elements(){return e(V)},selection_changed:g=>j(),get selected_elements(){return e(z)},set selected_elements(g){o(z,a(g))}}),w(i,d)};E(Le,i=>{e(oe)==se[1]&&i(ia)})}var na=c(Le,2);{var la=i=>{var d=Da(),y=c(O(d),2);B(y,{get elements(){return e(k)},selection_changed:g=>j(),get selected_elements(){return e(F)},set selected_elements(g){o(F,a(g))}}),w(i,d)};E(na,i=>{e(F)&&i(la)})}p(De),p(Ae),p(ze),p(je),w(r,l)};E(Ve,r=>{!e(T)&&!e(q)&&e(C)&&e(s)!=null&&r(We)})}p(we),p(xe),p(_e);var Te=c(_e,2),Xe=m(Te);{var Ze=r=>{var l=La();w(r,l)},$e=r=>{var l=Ne(),u=O(l);{var t=n=>{var _=Ne(),x=O(_);{var re=D=>{var ne=Ra();w(D,ne)},ie=D=>{xa(D,{get config(){return e(Ie)},get plot_name(){return e(be)}})};E(x,D=>{e(R).length==0||e(R)[0].data.length==0?D(re):D(ie,!1)})}w(n,_)};E(u,n=>{e(s)!=null&&n(t)},!0)}w(r,l)};E(Xe,r=>{e(q)||e(T)?r(Ze):r($e,!1)})}p(Te),w(qe,ye),pa()}export{Qa as component};
