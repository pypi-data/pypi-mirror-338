import"../chunks/Bg9kRutz.js";import{p as me,a as i,s as c,f as ye,b as we,c as s,d as r,g as e,e as z,r as n,t as ae}from"../chunks/AM9C8FsA.js";import{t as P,a as H}from"../chunks/CmMFD2-g.js";import{p as l,i as R}from"../chunks/D-bC_bvq.js";import{S as ke,g as xe,a as ze,f as Se,B as Ce}from"../chunks/WCHrdp7r.js";import{D as I}from"../chunks/DMh-KTMq.js";import{g as b}from"../chunks/CqS7hfz2.js";var De=P('<div class="accordion-item"><h2 class="accordion-header"><button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">Data selection</button></h2> <div id="collapseTwo" class="accordion-collapse collapse show"><div class="accordion-body"><div class="row"><div class="col-6"><h3>Year</h3> <!></div></div> <div class="row"><div class="col-6"><h3>Node</h3> <!></div></div> <div class="row"><div class="col-6"><h3>Carrier</h3> <!></div></div> <div class="row"><div class="col-6"><h3>Smoothing Window Size</h3> <!></div></div></div></div></div>'),Oe=P('<div class="text-center"><div class="spinner-border center" role="status"><span class="visually-hidden">Loading...</span></div></div>'),je=P('<div style="position: relative;"><!></div>'),Te=P('<h2>The Energy Balance</h2> <div class="position-relative"><div class="filters"><div class="accordion" id="accordionExample"><div class="accordion-item solution-selection"><h2 class="accordion-header"><button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">Solution Selection</button></h2> <div id="collapseOne" class="accordion-collapse collapse show"><div class="accordion-body"><!></div></div></div> <!></div></div></div> <div class="mt-4"><!> <!></div>',1);function Ae(oe,re){me(re,!0);var D=["rgb(75, 192, 192)","rgb(54, 162, 235)","rgb(255, 206, 86)","rgb(153, 102, 255)","rgb(255, 159, 64)","rgb(255, 99, 132)","rgb(201, 203, 207)","rgb(220,20,60)","rgb(255,99,71)","rgb(255,69,0)","rgb(154,205,50)","rgb(0,100,0)","rgb(50,205,50)","rgb(0,139,139)","rgb(153,50,204)","rgb(255,105,180)"];let o=i(null),A=i(!1),p=i(!1),_=i(!1),O=i(l([])),f=i(null),j=i(l([])),w=i(null),T=i(l([])),k=i(null),F=i(""),Y=i("");const le=["Hourly","Daily","Weekly","Monthly"];let K=i("Hourly"),W=i(l([])),Z=i(l([]));const se=z(()=>({type:"line",data:{datasets:e(W),labels:e(Z)},options:{animation:!1,normalized:!0,elements:{point:{radius:0}},responsive:!0,scales:{x:{stacked:!0,title:{display:!0,text:"Time"}},y:{stacked:!0,beginAtZero:!0,title:{display:!0,text:`Power [${e(F)}]`}}},borderWidth:1,plugins:{zoom:{pan:{enabled:!0,modifierKey:"ctrl",mode:"x"},zoom:{drag:{enabled:!0},wheel:{enabled:!0},mode:"x"}}}}}));async function ne(){e(o)&&(r(f,l(e(O)[0])),r(w,l(e(j)[0])),r(k,l(e(T)[0])),r(A,!1),await S())}async function S(){var M;if(r(_,!0),ae(),e(f)==null||e(w)==null||e(k)==null||e(o)==null){r(_,!1);return}let a=Math.floor((e(k)-e(o).detail.system.reference_year)/e(o).detail.system.interval_between_years),d=1;switch(e(K)){case"Daily":d=24;break;case"Weekly":d=168;break;case"Monthly":d=720;break}let v=await xe(e(o).solution_name,e(f),e(w),e(o).scenario_name,a,d),C=await ze(e(o).solution_name,b("flow_export",e(o).version),e(o).scenario_name);C===null?r(F,""):r(F,l(C.data[0][0])),r(W,l([]));let h=0;for(const g in v){let x={node:[e(f)]};if(v[g]==null||v[g].data.length==0)continue;if("technology"in v[g].data[0]){let t=[];for(const u of v[g].data)t.push(u.technology);x={technology:t}}let B={},E=Se(v[g].data,x,B);if(E.length!=0)for(let t of E){if(Object.keys(t.data).length==0)continue;switch(g){case b("flow_storage_discharge",e(o).version):t.label=t.label+" (discharge)";break;case b("flow_transport_in",e(o).version):t.label=t.label+" (transport in)";break;case b("flow_import",e(o).version):t.label="Import",e(o).version;break;case b("shed_demand",e(o).version):t.label="Shed Demand";break;case b("flow_storage_charge",e(o).version):t.label=t.label+" (charge)";break;case b("flow_transport_out",e(o).version):t.label=t.label+" (transport out)";break;case b("flow_export",e(o).version):t.label="Export";break}let u="line";Object.keys(t.data).length==1&&(u="bar"),g=="demand"?(t.label="Demand",t.type="line",t.stack="ownCustomStack",t.fill=!1,t.borderColor="black",t.backgroundColor="white",t.borderWidth=2,t.stepped=!0,Object.keys(t.data).length==1&&(t.pointRadius=2)):(t.type=u,t.fill="origin",t.borderColor=D[h%D.length],t.backgroundColor=D[h%D.length].replace(")",", 1)"),t.stepped=!0,t.cubicInterpolationMode="monotone"),e(W).push(t),h++}}r(Z,l(Object.keys(e(W)[0].data))),r(_,!1),r(A,!0),await ae();let m=e(o).solution_name.split(".");r(Y,l([m[(m==null?void 0:m.length)-1],(M=e(o))==null?void 0:M.scenario_name,"balance",e(w),e(f),e(k)].join("_")))}var $=Te(),L=c(ye($),2),q=s(L),G=s(q),N=s(G),J=c(s(N),2),Q=s(J),ie=s(Q);const de=z(()=>!e(p)&&!e(_));ke(ie,{solution_selected:ne,get enabled(){return e(de)},get carriers(){return e(j)},set carriers(a){r(j,l(a))},get nodes(){return e(O)},set nodes(a){r(O,l(a))},get years(){return e(T)},set years(a){r(T,l(a))},get selected_solution(){return e(o)},set selected_solution(a){r(o,l(a))},get loading(){return e(p)},set loading(a){r(p,l(a))}}),n(Q),n(J),n(N);var ce=c(N,2);{var ve=a=>{var d=De(),v=c(s(d),2),C=s(v),h=s(C),m=s(h),M=c(s(m),2);const g=z(()=>!e(_)&&!e(p));I(M,{get options(){return e(T)},selection_changed:S,get enabled(){return e(g)},get selected_option(){return e(k)},set selected_option(y){r(k,l(y))}}),n(m),n(h);var x=c(h,2),B=s(x),E=c(s(B),2);const t=z(()=>!e(_)&&!e(p));I(E,{get options(){return e(O)},selection_changed:S,get enabled(){return e(t)},get selected_option(){return e(f)},set selected_option(y){r(f,l(y))}}),n(B),n(x);var u=c(x,2),X=s(u),ue=c(s(X),2);const be=z(()=>!e(_)&&!e(p));I(ue,{get options(){return e(j)},selection_changed:S,get enabled(){return e(be)},get selected_option(){return e(w)},set selected_option(y){r(w,l(y))}}),n(X),n(u);var ee=c(u,2),te=s(ee),fe=c(s(te),2);const he=z(()=>!e(_)&&!e(p));I(fe,{options:le,selection_changed:S,get enabled(){return e(he)},get selected_option(){return e(K)},set selected_option(y){r(K,l(y))}}),n(te),n(ee),n(C),n(v),n(d),H(a,d)};R(ce,a=>{!e(p)&&e(o)&&a(ve)})}n(G),n(q),n(L);var U=c(L,2),V=s(U);{var _e=a=>{var d=Oe();H(a,d)};R(V,a=>{e(_)&&a(_e)})}var ge=c(V,2);{var pe=a=>{var d=je(),v=s(d);Ce(v,{get config(){return e(se)},get plot_name(){return e(Y)},zoom:!0}),n(d),H(a,d)};R(ge,a=>{!e(_)&&e(A)&&a(pe)})}n(U),H(oe,$),we()}export{Ae as component};
