import"../chunks/Bg9kRutz.js";import{p as $e,a as l,s as c,f as y,b as et,c as _,d as a,g as e,e as ue,r as v,h as tt,t as at}from"../chunks/AM9C8FsA.js";import{s as ot}from"../chunks/B6F1ZNoe.js";import{p as t,i as w}from"../chunks/D-bC_bvq.js";import{t as h,a as g,c as Te}from"../chunks/CmMFD2-g.js";import{r as rt}from"../chunks/C6Ut6Zxy.js";import{d as nt}from"../chunks/DY_kk6CS.js";import{b as st,A as oe}from"../chunks/Rklybz_u.js";import{S as it,d as I,e as lt,f as ze,B as ct}from"../chunks/B0llF2z6.js";import{R as me}from"../chunks/CrHIdHvl.js";import{g as z}from"../chunks/CqS7hfz2.js";var dt=h("<h3>Cumulation</h3> <!>",1),_t=h("<h3>Technology</h3> <!>",1),vt=h("<h3>Carrier</h3> <!>",1),ut=h("<!> <!>",1),mt=h("<h3>Location</h3> <!>",1),gt=h('<div class="row"><div class="col-6"><h3>Aggregation</h3> <!></div> <div class="col-6"><h3>Normalisation</h3> <!></div></div> <!>',1),ft=h('<div class="accordion-item"><h2 class="accordion-header"><button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseThree" aria-expanded="false" aria-controls="collapseThree">Data Selection</button></h2> <div id="collapseThree" class="accordion-collapse collapse show"><div class="accordion-body"><!> <h3>Year</h3> <!></div></div></div>'),pt=h('<div class="accordion-item"><h2 class="accordion-header"><button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">Variable Selection</button></h2> <div id="collapseTwo" class="accordion-collapse collapse show"><div class="accordion-body"><h3>Subdivision</h3> <input type="checkbox" class="btn-check" id="btn-check-outlined" autocomplete="off"> <label class="btn btn-outline-primary" for="btn-check-outlined"> </label><br> <!></div></div></div> <!>',1),ht=h('<div class="text-center"><div class="spinner-border center" role="status"><span class="visually-hidden">Loading...</span></div></div>'),bt=h('<div class="text-center">No data with this selection.</div>'),yt=h('<h2>Emissions</h2> <div class="z-1 position-relative"><div class="filters"><div class="accordion" id="accordionExample"><div class="accordion-item solution-selection"><h2 class="accordion-header"><button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">Solution Selection</button></h2> <div id="collapseOne" class="accordion-collapse collapse show"><div class="accordion-body"><!></div></div></div> <!></div></div></div> <div class="mt-4"><!></div>',1);function Bt(Ae,Ce){$e(Ce,!0);let J,K,A=l(t([])),ge=l(t([])),C=l(t([])),M=l(t([])),re=t(["Annual","Cumulative"]),o=l(null),Q=l(t([]));const Ee=["not_normalized","normalized"];let U=l("not_normalized"),ne=l(t([])),W=l(t([])),S=null,p=l(t([])),L=l(null),R=l(null),x=l(!0),Y=l(t([])),F=l(t([])),V=l("technology"),q=l(t([])),E=l(!1),b=l(!1),fe=l("plot"),je=ue(()=>({type:"bar",data:{datasets:e(p)},options:{responsive:!0,scales:{x:{stacked:!0,title:{display:!0,text:"Year"}},y:{stacked:!0,title:{display:!0,text:"Emissions ["+Be()+"]"}}}}}));function Be(){return(S==null?void 0:S.data[0][0])||(S==null?void 0:S.data[0].units)||""}function pe(){a(L,null),a(R,null),a(p,t([])),a(Y,t([])),a(F,t([])),e(x)&&(a(R,"technology_carrier"),Le())}function se(){var r,n,d;return e(x)?z("carbon_emissions_carrier",(r=e(o))==null?void 0:r.version):e(L)==re[0]?z("carbon_emissions_annual",(n=e(o))==null?void 0:n.version):z("carbon_emissions_cumulative",(d=e(o))==null?void 0:d.version)}async function Le(){var i,O;if(!e(o))return;a(b,!0);let r=await I(e(o).solution_name,z("carbon_emissions_technology",(i=e(o))==null?void 0:i.version),e(o).scenario_name,e(o).detail.system.reference_year,e(o).detail.system.interval_between_years),n=await I(e(o).solution_name,z("carbon_emissions_carrier",(O=e(o))==null?void 0:O.version),e(o).scenario_name,e(o).detail.system.reference_year,e(o).detail.system.interval_between_years),d=new Set,u=new Set,s=new Set;for(let m of r.data.data)u.add(m.technology),s.add(m.location);for(let m of n.data.data){if(d.add(m.carrier),s.add(m.node),Object.hasOwn(m,"node")){let P=Object.getOwnPropertyDescriptor(m,"node");if(P===void 0)continue;Object.defineProperty(m,"location",P)}delete m.node}J=lt("technology_carrier",[["carrier",n.data],["technology",r.data]]),a(q,t([...u])),a(A,t([...d])),a(M,t([...s])),S=n.unit,a(b,!1),De()}async function Pe(){var n,d,u;a(b,!0),await at();let r=se();if(r!==null){if(r==z("carbon_emissions_annual",(n=e(o))==null?void 0:n.version))K=(await I(e(o).solution_name,z("carbon_emissions_annual_limit",(d=e(o))==null?void 0:d.version),e(o).scenario_name,e(o).detail.system.reference_year,e(o).detail.system.interval_between_years)).data;else{let s=await I(e(o).solution_name,z("carbon_emissions_budget",(u=e(o))==null?void 0:u.version),e(o).scenario_name,e(o).detail.system.reference_year,e(o).detail.system.interval_between_years);if(s.data)for(const i of e(C))s.data.data[0][i]=s.data.data[0][e(C)[0]];K=s.data}I(e(o).solution_name,r,e(o).scenario_name,e(o).detail.system.reference_year,e(o).detail.system.interval_between_years).then(s=>{J=s.data,S=s.unit,a(b,!1)})}}function De(){a(ne,t(["location"])),e(R)&&a(ne,t(["location",e(R)])),a(Y,t(e(A))),a(F,t(e(q))),a(W,t(e(M))),a(V,"location"),a(b,!1),j()}function j(){var s;if(!J)return;let r={},n={};e(x)&&(e(V)!="location"?(r.location=e(M),n.technology_carrier=e(F).concat(e(Y))):(r.technology_carrier=e(q).concat(e(A)),n.location=e(W)));let d=e(C).filter(i=>!e(Q).includes(i));if(a(p,t(ze(J.data,r,n,d,e(U)=="normalized"))),e(p).length==0)return;if(e(p).length==1&&!e(x)&&(e(p)[0].label=se()),K){let i=ze(K.data,r,n,d,e(U)=="normalized");i.length>0&&(i[0].label=e(L)==re[0]?"Annual Emissions Limit":"Carbon Emissions Budget",i[0].type="line",a(p,t(e(p).concat(i))))}let u=e(o).solution_name.split(".");a(fe,t([u[(u==null?void 0:u.length)-1],(s=e(o))==null?void 0:s.scenario_name,se()].join("_")))}var he=yt(),ie=c(y(he),2),be=_(ie),ye=_(be),le=_(ye),we=c(_(le),2),xe=_(we),Ne=_(xe);const Re=ue(()=>!e(E)&&!e(b));it(Ne,{solution_selected:()=>{pe(),a(Q,t(e(C)))},get enabled(){return e(Re)},get carriers(){return e(A)},set carriers(r){a(A,t(r))},get nodes(){return e(ge)},set nodes(r){a(ge,t(r))},get years(){return e(C)},set years(r){a(C,t(r))},get selected_solution(){return e(o)},set selected_solution(r){a(o,t(r))},get loading(){return e(E)},set loading(r){a(E,t(r))}}),v(xe),v(we),v(le);var Ye=c(le,2);{var Fe=r=>{var n=pt(),d=y(n),u=c(_(d),2),s=_(u),i=c(_(s),2);rt(i),i.__change=pe;var O=c(i,2),m=_(O,!0);v(O);var P=c(O,3);{var T=k=>{var D=dt(),X=c(y(D),2);const Z=ue(()=>!e(b)&&!e(E));me(X,{get options(){return re},selection_changed:Pe,get enabled(){return e(Z)},get selected_option(){return e(L)},set selected_option($){a(L,t($))}}),g(k,D)};w(P,k=>{e(x)||k(T)})}v(s),v(u),v(d);var ce=c(d,2);{var He=k=>{var D=ft(),X=c(_(D),2),Z=_(X),$=_(Z);{var Ie=N=>{var Se=gt(),de=y(Se),_e=_(de),Ke=c(_(_e),2);me(Ke,{get options(){return e(ne)},selection_changed:f=>j(),get selected_option(){return e(V)},set selected_option(f){a(V,t(f))}}),v(_e);var Oe=c(_e,2),Me=c(_(Oe),2);me(Me,{options:Ee,selection_changed:f=>j(),get selected_option(){return e(U)},set selected_option(f){a(U,t(f))}}),v(Oe),v(de);var Qe=c(de,2);{var Ue=f=>{var G=ut(),ee=y(G);{var te=B=>{var H=_t(),ve=c(y(H),2);oe(ve,{get elements(){return e(q)},selection_changed:()=>{j()},get selected_elements(){return e(F)},set selected_elements(ae){a(F,t(ae))}}),g(B,H)};w(ee,B=>{e(q).length>0&&B(te)})}var Xe=c(ee,2);{var Ze=B=>{var H=vt(),ve=c(y(H),2);oe(ve,{get elements(){return e(A)},selection_changed:ae=>{j()},get selected_elements(){return e(Y)},set selected_elements(ae){a(Y,t(ae))}}),g(B,H)};w(Xe,B=>{e(A).length>0&&B(Ze)})}g(f,G)},We=f=>{var G=mt(),ee=c(y(G),2);oe(ee,{get elements(){return e(M)},selection_changed:te=>{j()},get selected_elements(){return e(W)},set selected_elements(te){a(W,t(te))}}),g(f,G)};w(Qe,f=>{e(V)!="location"?f(Ue):f(We,!1)})}g(N,Se)};w($,N=>{e(x)&&N(Ie)})}var Je=c($,4);oe(Je,{get elements(){return e(C)},selection_changed:N=>{j()},get selected_elements(){return e(Q)},set selected_elements(N){a(Q,t(N))}}),v(Z),v(X),v(D),g(k,D)};w(ce,k=>{!e(b)&&(e(L)||e(R))&&k(He)})}tt(()=>{i.disabled=e(b)||e(E),ot(m,e(x)?"on":"off")}),st(i,()=>e(x),k=>a(x,k)),g(r,n)};w(Ye,r=>{!e(E)&&e(o)&&r(Fe)})}v(ye),v(be),v(ie);var ke=c(ie,2),Ve=_(ke);{var qe=r=>{var n=ht();g(r,n)},Ge=r=>{var n=Te(),d=y(n);{var u=s=>{var i=Te(),O=y(i);{var m=T=>{var ce=bt();g(T,ce)},P=T=>{ct(T,{get config(){return e(je)},get plot_name(){return e(fe)}})};w(O,T=>{e(p).length==0||e(p)[0].data.length==0?T(m):T(P,!1)})}g(s,i)};w(d,s=>{e(p)!=null&&e(o)!=null&&s(u)},!0)}g(r,n)};w(Ve,r=>{e(E)||e(b)?r(qe):r(Ge,!1)})}v(ke),g(Ae,he),et()}nt(["change"]);export{Bt as component};
