import"../chunks/Bg9kRutz.js";import{p as et,a as s,s as c,f as k,b as tt,c as _,d as t,g as e,e as ve,r as i,h as U,t as at}from"../chunks/AM9C8FsA.js";import{s as ae}from"../chunks/B6F1ZNoe.js";import{p as o,i as N}from"../chunks/D-bC_bvq.js";import{e as ue,i as ge}from"../chunks/Bbpm7MqF.js";import{t as y,a as n,c as W}from"../chunks/CmMFD2-g.js";import{d as ot}from"../chunks/DY_kk6CS.js";import{S as lt,c as he,d as rt,f as nt,B as st}from"../chunks/WCHrdp7r.js";import{A as pe}from"../chunks/C0g7NPoM.js";import{R as fe}from"../chunks/BsIw7lIP.js";var it=(ee,F)=>{F()},ct=y("<option> </option>"),dt=(ee,F)=>{F()},_t=y("<option> </option>"),vt=y('<h3>Technology Type</h3> <select class="form-select"></select> <!>',1),ut=(ee,F)=>{F()},gt=y("<option> </option>"),ht=y('<h3>Carrier</h3> <select class="form-select"><!> </select>',1),pt=y("<h3>Technology</h3> <!>",1),ft=y("<h3>Node</h3> <!>",1),mt=y('<div class="accordion-item"><h2 class="accordion-header"><button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseThree" aria-expanded="false" aria-controls="collapseThree">Data Selection</button></h2> <div id="collapseThree" class="accordion-collapse collapse show"><div class="accordion-body"><div class="row"><div class="col-6"><h3>Aggregation</h3> <!></div> <div class="col-6"><h3>Normalisation</h3> <!></div></div> <!> <h3>Year</h3> <!></div></div></div>'),yt=y('<div class="accordion-item variable-selection"><h2 class="accordion-header"><button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">Variable Selection</button></h2> <div id="collapseTwo" class="accordion-collapse collapse show"><div class="accordion-body"><h3>Variable</h3> <select class="form-select"></select> <!> <!></div></div></div> <!>',1),bt=y('<div class="text-center"><div class="spinner-border center" role="status"><span class="visually-hidden">Loading...</span></div></div>'),xt=y('<div class="text-center">No technologies with this selection.</div>'),wt=y('<div class="text-center">No carriers with this selection.</div>'),Tt=y('<div class="text-center">No solution selected.</div>'),Nt=y('<div class="text-center">No data with this selection.</div>'),St=y('<div class="text-center">No locations with this selection.</div>'),zt=y('<div class="text-center">No data with this selection.</div>'),kt=y('<h2>Capacity</h2> <div class="z-1 position-relative"><div class="filters"><div class="accordion" id="accordionExample"><div class="accordion-item solution-selection"><h2 class="accordion-header"><button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">Solution Selection</button></h2> <div id="collapseOne" class="accordion-collapse collapse show"><div class="accordion-body"><!></div></div></div> <!></div></div></div> <div class="mt-4"><!></div>',1);function Ft(ee,F){et(F,!0);let Ve=["conversion","storage","transport"],R=s(null),J=s(null),Ye=["capacity","capacity_addition"],A=s(o([])),V=s(o([])),X=s(o([])),E=s(o([])),g=s(null),De=o(["technology","node"]);const Fe=["not_normalized","normalized"],me=["energy","power"];let ye=s(o({})),Y=s(null),L=s(null),oe=s("energy"),K=s("technology"),S=s(null),P=s(o([])),Z=s(o([])),q=s(o([])),te=s("not_normalized"),C=s(!1),j=s(!1),be=s(""),xe=s(o([])),we=s(o([])),Le=ve(()=>({type:"bar",data:{datasets:e(xe),labels:e(we)},options:{responsive:!0,scales:{x:{stacked:!0,title:{display:!0,text:"Year"}},y:{stacked:!0,title:{display:!0,text:`${e(Y)} [${e(E).length>0?e(ye)[e(E)[0]]:""}]`}}}}}));function Te(){t(te,"not_normalized"),t(q,o(e(V))),t(P,o(e(E))),t(Z,o(e(X))),t(K,"node")}async function Pe(){var l;if(t(j,!0),t(R,null),await at(),e(Y)===null){t(j,!1);return}const a=await rt(e(g).solution_name,e(Y),e(g).scenario_name,e(g).detail.system.reference_year,e(g).detail.system.interval_between_years);t(R,o(a.data)),(l=a.unit)!=null&&l.data&&t(ye,o(Object.fromEntries(a.unit.data.map(v=>[v.technology,v[0]||v.units])))),t(j,!1)}function qe(){t(R,null),t(Y,null),t(J,null),t(S,null),t(L,null)}function Ge(){Pe()}function Ne(){Ie(),ke(),Se(),Te(),G()}function He(){ke(),Se(),Te(),G()}function Ie(){if(t(A,o([])),e(R)===null||e(S)===null)return;let a=ze();e(R).data.forEach(l=>{let v=l.technology,z=e(g).detail.reference_carrier[v];!e(A).includes(z)&&a.includes(l.technology)&&e(A).push(z)}),e(A).length>0&&t(L,o(e(A)[0]))}function Se(){t(V,o([])),e(R).data.forEach(a=>{let l=a.technology,v=e(g).detail.reference_carrier[l];e(E).includes(a.technology)&&!e(V).includes(a.location)&&e(V).push(a.location),!e(A).includes(v)&&e(E).includes(a.technology)&&e(A).push(v)}),t(q,o(e(V)))}function ze(){if(!e(g)||!e(S))return[];switch(e(S)){case"conversion":return e(g).detail.system.set_conversion_technologies;case"storage":return e(g).detail.system.set_storage_technologies;case"transport":return e(g).detail.system.set_transport_technologies}return[]}function ke(){if(e(S)===null)return;let a=ze();t(E,o(a.filter(l=>{var v;return((v=e(g))==null?void 0:v.detail.reference_carrier[l])==e(L)}))),t(P,o(e(E)))}function G(){var H;if(e(K)=="technology"?t(q,o(e(V))):t(P,o(e(E))),e(Y)==null||e(q).length==0||e(Z).length==0||e(P).length==0||e(R)===null){t(J,null);return}let a={},l={};e(K)=="technology"?(a.location=e(q),l.technology=e(P)):(a.technology=e(P),l.location=e(q)),e(S)=="storage"?l.capacity_type=[e(oe)]:l.capacity_type=me;let v=e(X).filter(h=>!e(Z).includes(h));t(J,o(nt(e(R).data,a,l,v,e(te)=="normalized"))),t(xe,o(e(J))),t(we,o(e(Z).map(h=>h.toString())));let z=e(g).solution_name.split(".");t(be,o([z[(z==null?void 0:z.length)-1],(H=e(g))==null?void 0:H.scenario_name,e(Y),e(S),e(L)].join("_")))}var Ee=kt(),le=c(k(Ee),2),Oe=_(le),Ae=_(Oe),re=_(Ae),Ce=c(_(re),2),je=_(Ce),Je=_(je);const Ke=ve(()=>!e(j)&&!e(C));lt(Je,{solution_selected:qe,get enabled(){return e(Ke)},get years(){return e(X)},set years(a){t(X,o(a))},get selected_solution(){return e(g)},set selected_solution(a){t(g,o(a))},get loading(){return e(C)},set loading(a){t(C,o(a))}}),i(je),i(Ce),i(re);var Me=c(re,2);{var Qe=a=>{var l=yt(),v=k(l),z=c(_(v),2),H=_(z),h=c(_(H),2);h.__change=[it,Ge],ue(h,21,()=>Ye,ge,(p,b)=>{var r=ct(),f={},w=_(r,!0);i(r),U(()=>{f!==(f=e(b))&&(r.value=(r.__value=e(b))==null?"":e(b)),ae(w,e(b))}),n(p,r)}),i(h);var I=c(h,2);{var ne=p=>{var b=vt(),r=c(k(b),2);r.__change=[dt,Ne],ue(r,21,()=>Ve,ge,(m,x)=>{var u=_t(),T={},O=_(u,!0);i(u),U(()=>{T!==(T=e(x))&&(u.value=(u.__value=e(x))==null?"":e(x)),ae(O,e(x))}),n(m,u)}),i(r);var f=c(r,2);{var w=m=>{const x=ve(()=>!e(j)&&!e(C));fe(m,{options:me,selection_changed:Ne,get enabled(){return e(x)},get selected_option(){return e(oe)},set selected_option(u){t(oe,o(u))}})};N(f,m=>{e(S)=="storage"&&m(w)})}U(()=>r.disabled=e(j)||e(C)),he(r,()=>e(S),m=>t(S,m)),n(p,b)};N(I,p=>{e(Y)!=null&&p(ne)})}var se=c(I,2);{var ie=p=>{var b=ht(),r=c(k(b),2);r.__change=[ut,He];var f=_(r);ue(f,17,()=>e(A),ge,(m,x)=>{var u=gt(),T={},O=_(u,!0);i(u),U(()=>{T!==(T=e(x))&&(u.value=(u.__value=e(x))==null?"":e(x)),ae(O,e(x))}),n(m,u)});var w=c(f);i(r),U(()=>{r.disabled=e(j)||e(C),ae(w,` disabled=${(e(j)||e(C))??""}`)}),he(r,()=>e(L),m=>t(L,m)),n(p,b)};N(se,p=>{e(S)!=null&&e(A).length>0&&p(ie)})}i(H),i(z),i(v);var D=c(v,2);{var M=p=>{var b=mt(),r=c(_(b),2),f=_(r),w=_(f),m=_(w),x=c(_(m),2);fe(x,{get options(){return De},selection_changed:d=>G(),get selected_option(){return e(K)},set selected_option(d){t(K,o(d))}}),i(m);var u=c(m,2),T=c(_(u),2);fe(T,{options:Fe,selection_changed:d=>G(),get selected_option(){return e(te)},set selected_option(d){t(te,o(d))}}),i(u),i(w);var O=c(w,2);{var ce=d=>{var B=pt(),$=c(k(B),2);pe($,{get selected_elements(){return e(P)},get elements(){return e(E)},selection_changed:()=>{G()}}),n(d,B)},de=d=>{var B=ft(),$=c(k(B),2);pe($,{get selected_elements(){return e(q)},get elements(){return e(V)},selection_changed:Re=>{G()}}),n(d,B)};N(O,d=>{e(K)=="technology"?d(ce):d(de,!1)})}var _e=c(O,4);pe(_e,{get selected_elements(){return e(Z)},get elements(){return e(X)},selection_changed:d=>{G()}}),i(f),i(r),i(b),n(p,b)};N(D,p=>{e(R)&&e(S)&&e(L)&&e(E).length>0&&e(V).length>0&&p(M)})}U(()=>h.disabled=e(j)||e(C)),he(h,()=>e(Y),p=>t(Y,p)),n(a,l)};N(Me,a=>{!e(C)&&e(g)&&a(Qe)})}i(Ae),i(Oe),i(le);var Be=c(le,2),Ue=_(Be);{var We=a=>{var l=bt();n(a,l)},Xe=a=>{var l=W(),v=k(l);{var z=h=>{var I=xt();n(h,I)},H=h=>{var I=W(),ne=k(I);{var se=D=>{var M=wt();n(D,M)},ie=D=>{var M=W(),p=k(M);{var b=f=>{var w=Tt();n(f,w)},r=f=>{var w=W(),m=k(w);{var x=T=>{var O=Nt();n(T,O)},u=T=>{var O=W(),ce=k(O);{var de=d=>{var B=St();n(d,B)},_e=d=>{var B=W(),$=k(B);{var Re=Q=>{var $e=zt();n(Q,$e)},Ze=Q=>{st(Q,{get config(){return e(Le)},get plot_name(){return e(be)}})};N($,Q=>{e(J).length==0?Q(Re):Q(Ze,!1)},!0)}n(d,B)};N(ce,d=>{e(V).length==0?d(de):d(_e,!1)},!0)}n(T,O)};N(m,T=>{e(J)==null?T(x):T(u,!1)},!0)}n(f,w)};N(p,f=>{e(g)==null?f(b):f(r,!1)},!0)}n(D,M)};N(ne,D=>{e(A).length==0?D(se):D(ie,!1)},!0)}n(h,I)};N(v,h=>{e(E).length==0?h(z):h(H,!1)},!0)}n(a,l)};N(Ue,a=>{e(C)||e(j)?a(We):a(Xe,!1)})}i(Be),n(ee,Ee),tt()}ot(["change"]);export{Ft as component};
