import"../chunks/Bg9kRutz.js";import{p as fa,a as v,s as d,f as O,b as pa,c as h,d as r,g as e,e as Ye,t as ke,r as f,h as ha}from"../chunks/AM9C8FsA.js";import{s as ma}from"../chunks/B6F1ZNoe.js";import{p as a,i as E}from"../chunks/D-bC_bvq.js";import{e as ga,i as ba}from"../chunks/C3oA2Kkp.js";import{t as S,a as C,c as Fe}from"../chunks/CmMFD2-g.js";import{S as ya,d as K,r as R,f as M,B as xa}from"../chunks/B0llF2z6.js";import{A as B}from"../chunks/Rklybz_u.js";import{R as wa}from"../chunks/CrHIdHvl.js";import{T as Ne}from"../chunks/CiahgOPt.js";import{g as Q}from"../chunks/CqS7hfz2.js";var Ca=S("Subdivision <!>",1),Sa=S('<div class="d-flex"><h4> </h4> <!> <!></div>'),Ta=S("<h4>Transport</h4> <!>",1),Oa=S("<h4>Storage</h4> <!>",1),Ea=S("<h4>Conversion</h4> <!>",1),za=S("<h3>Cost of Carrier</h3> <!>",1),Aa=S("<h3>Shed Demand</h3> <!>",1),Da=S("<h3>Location</h3> <!>",1),ja=S("<h3>Year</h3> <!>",1),Ba=S('<div class="accordion-item"><h2 class="accordion-header"><button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseCost" aria-expanded="false" aria-controls="collapseCost">Cost selection</button></h2> <div id="collapseCost" class="accordion-collapse collapse" data-bs-parent="#accordionExample"><div class="accordion-body"></div></div></div> <div class="accordion-item"><h2 class="accordion-header"><button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">Technology and Carrier Selection</button></h2> <div id="collapseTwo" class="accordion-collapse collapse" data-bs-parent="#accordionExample"><div class="accordion-body"><h3>Technologies (for Capex/Opex)</h3> <!> <!> <!> <!> <!></div></div></div> <div class="accordion-item"><h2 class="accordion-header"><button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseThree" aria-expanded="false" aria-controls="collapseThree">Data Selection</button></h2> <div id="collapseThree" class="accordion-collapse collapse" data-bs-parent="#accordionExample"><div class="accordion-body"><div class="accordion-body"><div class="row"><div class="col-6"><h3>Aggregation</h3> <!></div></div> <!> <!></div></div></div></div>',1),La=S('<div class="text-center"><div class="spinner-border center" role="status"><span class="visually-hidden">Loading...</span></div></div>'),Ra=S('<div class="text-center">No data with this selection.</div>'),Ya=S('<h2>Costs</h2> <div class="z-1 position-relative"><div class="filters"><div class="accordion" id="accordionExample"><div class="accordion-item solution-selection"><h2 class="accordion-header"><button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">Solution Selection</button></h2> <div id="collapseOne" class="accordion-collapse collapse show" data-bs-parent="#accordionExample"><div class="accordion-body"><!></div></div></div> <!></div></div></div> <div class="mt-4"><!></div>',1);function Qa(Pe,qe){fa(qe,!0);let le=v(a([])),de=v(a([])),Y=v(a([])),U=v(a([])),A=v(a([])),s=v(null),k=v(a([])),Ge="not_normalized",F=v(a([])),N=v(a([])),P=v(!1),T=v(!1),V=v(a([])),W=v(a([])),X=v(a([])),Z=v(a([])),$=v(a([])),ee=v(a([])),b,ce,q,x=v(void 0),D,G,ae=v(a([])),te=v(a([]));const _="Techology / Carrier",se=[_,"Location"];let oe=v(a(se[1])),p=a({capex:{title:"Capex",show:!0,subdivision:!1},opex:{title:"Opex",show:!0,subdivision:!1},carrier:{title:"Carrier",show:!0,subdivision:!1},shed_demand:{title:"Shed Demand",show:!0,subdivision:!1},carbon_emission:{title:"Carbon Emissions",show:!0,subdivision:!1}});const H=" (Capex)",I=" (Opex)",fe="Capex",pe="Opex",he="Carrier",me="Shed Demand";let ge=v("plot"),L=v(a([])),He=Ye(()=>({type:"line",data:{datasets:e(L)},options:{responsive:!0,scales:{x:{stacked:!0,title:{display:!0,text:"Year"}},y:{stacked:!0,title:{display:!0,text:"Costs ["+Ke()+"]"}}}}}));async function Ie(){if(e(s)!=null){r(T,!0),await ke(),r(x,a(await K(e(s).solution_name,Q("capex_yearly",e(s).version),e(s).scenario_name,e(s).detail.system.reference_year,e(s).detail.system.interval_between_years))),D=await K(e(s).solution_name,Q("opex_yearly",e(s).version),e(s).scenario_name,e(s).detail.system.reference_year,e(s).detail.system.interval_between_years),ce=await K(e(s).solution_name,Q("cost_carbon_emissions_total",e(s).version),e(s).scenario_name,e(s).detail.system.reference_year,e(s).detail.system.interval_between_years),q=await K(e(s).solution_name,Q("cost_carrier",e(s).version),e(s).scenario_name,e(s).detail.system.reference_year,e(s).detail.system.interval_between_years),G=await K(e(s).solution_name,Q("cost_shed_demand",e(s).version),e(s).scenario_name,e(s).detail.system.reference_year,e(s).detail.system.interval_between_years),R(q.data,"node","location"),R(G.data,"node","location"),R(D.data,"technology",_),R(e(x).data,"technology",_),R(q.data,"carrier",_),R(G.data,"carrier",_);for(let o in e(x).data.data)e(x).data.data[o][_]=e(x).data.data[o][_]+H;for(let o in D.data.data)D.data.data[o][_]=D.data.data[o][_]+I;r(U,a(Object.keys(e(s).detail.edges).concat(e(s).detail.system.set_nodes))),r(T,!1)}}function Je(o){r(T,!0),b=new Array;let m=structuredClone(q.data);m.data=m.data.filter(t=>e(F).includes(t[_]));let u=structuredClone(G.data);if(u.data=u.data.filter(t=>e(N).includes(t[_])),e(x)!=null&&p.capex.show)if(p.capex.subdivision)b=b.concat(e(x).data.data);else{let t=M(e(x).data.data,{location:e(A)},{[_]:o},[],!1);for(let n in t)t[n].data.location=t[n].label,t[n].data[_]=fe,b.push(t[n].data)}if(p.opex.show)if(p.opex.subdivision)b=b.concat(D.data.data);else{let t=M(D.data.data,{location:e(A)},{[_]:o},[],!1);for(let n in t)t[n].data.location=t[n].label,t[n].data[_]=pe,b.push(t[n].data)}if(p.carrier.show)if(p.carrier.subdivision)b=b.concat(m.data);else{let t=M(m.data,{location:e(A)},{[_]:o},[],!1);for(let n in t)t[n].data.location=t[n].label,t[n].data[_]=he,b.push(t[n].data)}if(p.shed_demand.show)if(p.shed_demand.subdivision)b=b.concat(u.data);else{let t=M(u.data,{location:e(A)},{[_]:o},[],!1);for(let n in t)t[n].data.location=t[n].label,t[n].data[_]=me,b.push(t[n].data)}if(b.length==0){b=void 0,r(T,!1);return}r(T,!1)}function Ke(){return!e(x)||e(x).unit===null?"":e(x).unit.data[0][0]||e(x).unit.data[0].units||""}function z(){r(T,!0);let o={},m={},u=[];for(const w of e(ee))u.push(w+H),u.push(w+I);for(const w of e(Z))u.push(w+H),u.push(w+I);for(const w of e(W))u.push(w+H),u.push(w+I);let t=[...u,...e(F),...e(N)];Je(t),p.capex.subdivision||t.push(fe),p.opex.subdivision||t.push(pe),p.carrier.subdivision||t.push(he),p.shed_demand.subdivision||t.push(me),e(oe)==se[0]?(o.location=e(U),m[_]=t):(o[_]=t,m.location=e(A));let n=e(Y).filter(w=>!e(k).includes(w)),c=Ge=="normalized";r(L,a([])),b&&r(L,a(M(b,o,m,n,c))),ce.data.data.length>0&&p.carbon_emission.show&&e(L).push({label:"Total Carbon Costs",data:ce.data.data[0],type:"bar"}),r(T,!1)}async function Me(){var n;if(e(s)==null)return;await Ie(),await ke(),r(T,!0);let o=new Set;if(e(x)!=null)for(const c of e(x).data.data)o.add(c[_].replace(H,""));for(const c of D.data.data)o.add(c[_].replace(I,""));r(V,a(e(s).detail.system.set_transport_technologies.filter(c=>o.has(c)))),r($,a(e(s).detail.system.set_conversion_technologies.filter(c=>o.has(c)))),r(X,a(e(s).detail.system.set_storage_technologies.filter(c=>o.has(c)))),r(W,a(e(V))),r(ee,a(e($))),r(Z,a(e(X)));let m=new Set;for(const c of q.data.data)m.add(c[_]);r(le,a(e(s).detail.system.set_carriers.slice())),r(ae,a(e(s).detail.carriers_import.concat(e(s).detail.carriers_export).filter(c=>m.has(c)))),r(F,a(e(ae)));let u=new Set;for(const c of G.data.data)u.add(c[_]);r(te,a(e(s).detail.carriers_demand.filter(c=>u.has(c)))),r(N,a(e(te))),r(de,a(e(s).detail.system.set_nodes)),r(k,a(e(Y))),r(A,a(e(U))),z(),r(T,!1);let t=e(s).solution_name.split(".");r(ge,a([t[(t==null?void 0:t.length)-1],(n=e(s))==null?void 0:n.scenario_name,"costs"].join("_")))}var be=Ya(),_e=d(O(be),2),ye=h(_e),xe=h(ye),ve=h(xe),we=d(h(ve),2),Ce=h(we),Qe=h(Ce);const Ue=Ye(()=>!e(P)&&!e(T));ya(Qe,{solution_selected:Me,get enabled(){return e(Ue)},get carriers(){return e(le)},set carriers(o){r(le,a(o))},get nodes(){return e(de)},set nodes(o){r(de,a(o))},get years(){return e(Y)},set years(o){r(Y,a(o))},get selected_solution(){return e(s)},set selected_solution(o){r(s,a(o))},get loading(){return e(P)},set loading(o){r(P,a(o))}}),f(Ce),f(we),f(ve);var Ve=d(ve,2);{var We=o=>{var m=Ba(),u=O(m),t=d(h(u),2),n=h(t);ga(n,21,()=>Object.keys(p),ba,(i,l)=>{var y=Sa(),g=h(y),da=h(g);f(g);var Le=d(g,2);Ne(Le,{change:z,get value(){return p[e(l)].show},set value(J){p[e(l)].show=J}});var ca=d(Le,2);{var _a=J=>{var Re=Ca(),va=d(O(Re));Ne(va,{change:z,get value(){return p[e(l)].subdivision},set value(ua){p[e(l)].subdivision=ua}}),C(J,Re)};E(ca,J=>{p[e(l)].show&&e(l)!="carbon_emission"&&J(_a)})}f(y),ha(()=>ma(da,`${p[e(l)].title??""} :`)),C(i,y)}),f(n),f(t),f(u);var c=d(u,2),w=d(h(c),2),re=h(w),ie=d(h(re),2);{var j=i=>{var l=Ta(),y=d(O(l),2);B(y,{get elements(){return e(V)},selection_changed:()=>{z()},get selected_elements(){return e(W)},set selected_elements(g){r(W,a(g))}}),C(i,l)};E(ie,i=>{e(V).length>0&&i(j)})}var ne=d(ie,2);{var ea=i=>{var l=Oa(),y=d(O(l),2);B(y,{get elements(){return e(X)},selection_changed:()=>{z()},get selected_elements(){return e(Z)},set selected_elements(g){r(Z,a(g))}}),C(i,l)};E(ne,i=>{e(X).length>0&&i(ea)})}var Te=d(ne,2);{var aa=i=>{var l=Ea(),y=d(O(l),2);B(y,{get elements(){return e($)},selection_changed:()=>{z()},get selected_elements(){return e(ee)},set selected_elements(g){r(ee,a(g))}}),C(i,l)};E(Te,i=>{e($).length>0&&i(aa)})}var Oe=d(Te,2);{var ta=i=>{var l=za(),y=d(O(l),2);B(y,{get elements(){return e(ae)},selection_changed:()=>{z()},get selected_elements(){return e(F)},set selected_elements(g){r(F,a(g))}}),C(i,l)};E(Oe,i=>{e(ae).length>0&&i(ta)})}var sa=d(Oe,2);{var oa=i=>{var l=Aa(),y=d(O(l),2);B(y,{get elements(){return e(te)},selection_changed:()=>{z()},get selected_elements(){return e(N)},set selected_elements(g){r(N,a(g))}}),C(i,l)};E(sa,i=>{e(te).length>0&&i(oa)})}f(re),f(w),f(c);var Ee=d(c,2),ze=d(h(Ee),2),Ae=h(ze),De=h(Ae),ue=h(De),je=h(ue),ra=d(h(je),2);wa(ra,{options:se,selection_changed:i=>z(),get selected_option(){return e(oe)},set selected_option(i){r(oe,a(i))}}),f(je),f(ue);var Be=d(ue,2);{var ia=i=>{var l=Da(),y=d(O(l),2);B(y,{get elements(){return e(U)},selection_changed:g=>z(),get selected_elements(){return e(A)},set selected_elements(g){r(A,a(g))}}),C(i,l)};E(Be,i=>{e(oe)==se[1]&&i(ia)})}var na=d(Be,2);{var la=i=>{var l=ja(),y=d(O(l),2);B(y,{get elements(){return e(Y)},selection_changed:g=>z(),get selected_elements(){return e(k)},set selected_elements(g){r(k,a(g))}}),C(i,l)};E(na,i=>{e(k)&&i(la)})}f(De),f(Ae),f(ze),f(Ee),C(o,m)};E(Ve,o=>{!e(T)&&!e(P)&&e(x)&&e(s)!=null&&o(We)})}f(xe),f(ye),f(_e);var Se=d(_e,2),Xe=h(Se);{var Ze=o=>{var m=La();C(o,m)},$e=o=>{var m=Fe(),u=O(m);{var t=n=>{var c=Fe(),w=O(c);{var re=j=>{var ne=Ra();C(j,ne)},ie=j=>{xa(j,{get config(){return e(He)},get plot_name(){return e(ge)}})};E(w,j=>{e(L).length==0||e(L)[0].data.length==0?j(re):j(ie,!1)})}C(n,c)};E(u,n=>{e(s)!=null&&n(t)},!0)}C(o,m)};E(Xe,o=>{e(P)||e(T)?o(Ze):o($e,!1)})}f(Se),C(Pe,be),pa()}export{Qa as component};
