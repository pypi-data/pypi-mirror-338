(()=>{"use strict";var e,t,r,n={7040:(e,t,r)=>{var n=r(750),a=r(641),o=r(953),l=r(33),i=r(136),u=r(296),c=r(467),s=r(4756),p=r.n(s),f=(r(2696),r(6935)),d=r.n(f),v=r(7659),m=r.n(v);const h=r.p+"5a6cdb62371f4bc880e3e24e76589b1f.css";var b={};b.insert=m().bind(null,"head"),d()(h,b);var _=r(3481),g=r.n(_),y=r(8061),k=r(6902),C=r(5979),F=r(5467),A=r(4365),R=r(7546),w={key:0};const E={__name:"TextWithBr",props:{text:{type:String,required:!0}},setup:function(e){var t=e,r=(0,a.EW)((function(){return t.text.split("\n")}));return function(e,t){return(0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(r.value,(function(e,t,n){return(0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.eW)((0,l.v_)(e)+" ",1),n<r.value.length?((0,a.uX)(),(0,a.CE)("br",w)):(0,a.Q3)("v-if",!0)],64)})),256)}}};var L={key:0},x={style:{width:"100%",height:"70vh"},class:"toggle"},S={key:0},O={class:"contacts"},X={key:0},j=["href"],P={key:1},T={key:0},W={key:1},I={class:"contacts"},K={key:0},q=["href"],U={key:1},Q=["href"],B={key:2},M=["href"],N={class:"users"},$={key:0,class:"user_avatar photo"},D=["src","alt"],G={key:1,class:"user_avatar"};const Y={__name:"CompanyMap",props:{companiesUrl:{type:String,required:!0},extraPlacesUrl:{type:String,required:!0}},setup:function(e){return(0,c.A)(p().mark((function t(){var r,n,i,s,f,d,v,m,h,b,_,w,Y,z,H;return p().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return v=e,m=(0,o.KR)(!0),h=(0,o.KR)({}),b=(0,o.KR)(new(g().Bounds)),_=(0,F.i)(),w=(0,o.KR)(),Y=(0,o.KR)(),z=(0,o.KR)(),H=function(e){var t=e.getBounds();b.value.isValid()?b.value.extend(t):b.value=t},r=(0,a.E)((function(){return _.loadConst("config")})),n=(0,u.A)(r,2),f=n[0],d=n[1],t.next=12,f;case 12:return f=t.sent,d(),h.value=f,i=(0,a.E)((function(){return Promise.allSettled([A.A.get(v.companiesUrl),A.A.get(v.extraPlacesUrl)]).then((function(e){var t=(0,u.A)(e,2),r=t[0],n=t[1];"fulfilled"==r.status&&r.value&&(w.value=r.value),"fulfilled"==n.status&&n.value&&(Y.value=n.value),m.value=!1}))})),s=(0,u.A)(i,2),f=s[0],d=s[1],t.next=18,f;case 18:return d(),(0,a.nT)((0,c.A)(p().mark((function e(){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A.A.get(v.companiesUrl);case 2:w.value=e.sent;case 3:case"end":return e.stop()}}),e)})))),t.abrupt("return",(function(e,t){return(0,a.uX)(),(0,a.CE)(a.FK,null,[m.value?((0,a.uX)(),(0,a.CE)("div",L,"Chargement…")):(0,a.Q3)("v-if",!0),(0,a.Lk)("div",x,[(0,a.bF)((0,o.R1)(y.Do),{ref:"map",center:[47.21297,-1.55104],zoom:18,bounds:b.value},{default:(0,a.k6)((function(){return[(0,a.bF)((0,o.R1)(y.qh),{position:"topright",collapsed:!1}),(0,a.bF)((0,o.R1)(y.a),{url:h.value.leaflet_layer_url,attribution:'© Contributeur·ices <a target="_blank" href="http://osm.org/copyright">OpenStreetMap</a>'},null,8,["url"]),(0,a.bF)((0,o.R1)(y.qR),{name:"Lieux ressources",key:"places","layer-type":"overlay",onReady:H},{default:(0,a.k6)((function(){return[Y.value?((0,a.uX)(!0),(0,a.CE)(a.FK,{key:0},(0,a.pI)(Y.value.features,(function(e){return(0,a.uX)(),(0,a.Wv)((0,o.R1)(y.li),{"lat-lng":(0,o.R1)(g()).GeoJSON.coordsToLatLng(e.geometry.coordinates)},{default:(0,a.k6)((function(){return[(0,a.bF)((0,o.R1)(y.up),null,{default:(0,a.k6)((function(){return[(0,a.bF)(C.A,{name:"location-star","css-class":"map_location favourite",alt:e.properties.name},null,8,["alt"])]})),_:2},1024),(0,a.bF)((0,o.R1)(y.nA),null,{default:(0,a.k6)((function(){return[(0,a.Lk)("div",null,[(0,a.Lk)("p",null,[(0,a.Lk)("strong",null,(0,l.v_)(e.properties.name),1)]),e.properties.description?((0,a.uX)(),(0,a.CE)("p",S,[(0,a.bF)(E,{text:e.properties.description},null,8,["text"])])):(0,a.Q3)("v-if",!0),(0,a.Lk)("ul",O,[e.properties.website?((0,a.uX)(),(0,a.CE)("li",X,[(0,a.Lk)("a",{href:e.properties.website},[(0,a.bF)(C.A,{name:"globe",alt:"Site web",title:"Site web"}),(0,a.eW)(" "+(0,l.v_)(e.properties.website),1)],8,j)])):(0,a.Q3)("v-if",!0),e.properties.contact?((0,a.uX)(),(0,a.CE)("li",P,[(0,a.bF)(C.A,{name:"user",alt:""}),(0,a.eW)(" Contact : "+(0,l.v_)(e.properties.contact),1)])):(0,a.Q3)("v-if",!0)])])]})),_:2},1024)]})),_:2},1032,["lat-lng"])})),256)):(0,a.Q3)("v-if",!0)]})),_:1}),(0,a.bF)((0,o.R1)(k._),{name:"Enseignes et entrepreneur·euses",key:"companies","layer-type":"overlay",onReady:H},{default:(0,a.k6)((function(){return[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(w.value.features,(function(e){return(0,a.uX)(),(0,a.Wv)((0,o.R1)(y.li),{"lat-lng":(0,o.R1)(g()).GeoJSON.coordsToLatLng(e.geometry.coordinates),onPopupopen:function(t){return z.value=e.properties.id}},{default:(0,a.k6)((function(){return[(0,a.bF)((0,o.R1)(y.up),null,{default:(0,a.k6)((function(){return[(0,a.bF)(C.A,{name:"location-dot","css-class":"map_location",alt:e.properties.name},null,8,["alt"])]})),_:2},1024),(0,a.bF)((0,o.R1)(y.nA),null,{default:(0,a.k6)((function(){return[(0,a.Lk)("div",null,[(0,a.Lk)("p",null,[(0,a.Lk)("strong",null,(0,l.v_)(e.properties.name),1)]),e.properties.goal?((0,a.uX)(),(0,a.CE)("p",T,[(0,a.Lk)("em",null,(0,l.v_)(e.properties.goal),1)])):(0,a.Q3)("v-if",!0),e.properties.activities_labels.length>0?((0,a.uX)(),(0,a.CE)("p",W,(0,l.v_)(e.properties.activities_labels.join(", ")),1)):(0,a.Q3)("v-if",!0),(0,a.Lk)("ul",I,[e.properties.phone?((0,a.uX)(),(0,a.CE)("li",K,[(0,a.Lk)("a",{href:"tel:".concat(e.properties.phone)},[(0,a.bF)(C.A,{name:"phone",alt:"Téléphone",title:"Téléphone"}),(0,a.eW)(" "+(0,l.v_)(e.properties.phone),1)],8,q)])):(0,a.Q3)("v-if",!0),e.properties.mobile?((0,a.uX)(),(0,a.CE)("li",U,[(0,a.Lk)("a",{href:"tel:".concat(e.properties.mobile)},[(0,a.bF)(C.A,{name:"mobile-alt",title:"Téléphone portable",alt:"Téléphone portable"}),(0,a.eW)(" "+(0,l.v_)(e.properties.mobile),1)],8,Q)])):(0,a.Q3)("v-if",!0),e.properties.email?((0,a.uX)(),(0,a.CE)("li",B,[(0,a.Lk)("a",{href:"mailto:".concat(e.properties.email)},[(0,a.bF)(C.A,{name:"envelope",title:"E-mail",alt:"E-mail"}),(0,a.eW)(" "+(0,l.v_)(e.properties.email),1)],8,M)])):(0,a.Q3)("v-if",!0)]),(0,a.Lk)("ul",N,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.properties.users_gallery,(function(t){return(0,a.uX)(),(0,a.CE)("li",null,[(0,a.Q3)("\n                         Renders only if the API gives us a logo\n                         + lazy-loading of logos to avoid mass-loading them on page startup.\n                    "),t.logo_url&&z.value===e.properties.id?((0,a.uX)(),(0,a.CE)("span",$,[(0,a.Lk)("img",{src:t.logo_url,alt:t.fullname,width:"48",height:"48"},null,8,D)])):((0,a.uX)(),(0,a.CE)("span",G,[(0,a.bF)(R.A,{name:"user"})])),(0,a.Lk)("span",null,(0,l.v_)(t.fullname),1)])})),256))])])]})),_:2},1024)]})),_:2},1032,["lat-lng","onPopupopen"])})),256))]})),_:1})]})),_:1},8,["bounds"])])],64)}));case 21:case"end":return t.stop()}}),t)})))()}};var z={class:"nav nav-tabs",role:"tablist"},H={class:"tab-content content"},J={id:"list-container",class:"tab-pane fade in active",role:"tabpanel"},V=["href"];const Z={__name:"TabHeader",props:{href:{type:String,default:"#"},active:{type:Boolean,default:!1}},setup:function(e){return function(t,r){return(0,a.uX)(),(0,a.CE)("li",{role:"presentation",class:(0,l.C4)(e.active?"active":"")},[(0,a.Lk)("a",{href:e.href,role:"tab"},[(0,a.RG)(t.$slots,"default")],8,V)],2)}}},ee=(0,a.pM)({components:{IconSpan:C.A,TabHeader:Z,Icon:R.A}}),te=(0,r(6262).A)(ee,[["render",function(e,t,r,n,o,l){return(0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.Lk)("ul",z,[(0,a.RG)(e.$slots,"headers")]),(0,a.Lk)("div",H,[(0,a.Lk)("div",J,[(0,a.RG)(e.$slots,"panels")])])],64)}]]);var re=r(5220);const ne={__name:"App",setup:function(e){var t=(0,i.Dn)(),r=((0,re.rd)(),(0,re.lq)()),n="/api/v1/companies.geojson?"+["id","name","phone","email","mobile","goal","activities_labels","logo_id","users_gallery"].map((function(e){return"fields=".concat(e)})).join("&"),u=(0,o.KR)(n);return(0,a.wB)((function(){return r.query}),(function(e){var t=new URLSearchParams(e).toString();u.value="".concat(n,"&").concat(t)})),function(e,r){var n=(0,a.g2)("RouterView");return(0,a.uX)(),(0,a.CE)(a.FK,null,[((0,a.uX)(),(0,a.Wv)(a.tY,null,{fallback:(0,a.k6)((function(){return[(0,a.eW)("Chargement…")]})),default:(0,a.k6)((function(){return[(0,a.bF)(n,{name:"CompanyURLSearchFilters"},{default:(0,a.k6)((function(e){var t=e.Component;return[((0,a.uX)(),(0,a.Wv)((0,a.$y)(t)))]})),_:1})]})),_:1})),((0,a.uX)(),(0,a.Wv)(a.tY,null,{fallback:(0,a.k6)((function(){return[(0,a.eW)(" Chargement...")]})),default:(0,a.k6)((function(){return[(0,a.bF)(te,null,{headers:(0,a.k6)((function(){return[(0,a.bF)(Z,{href:(0,o.R1)(t).tab_url},{default:(0,a.k6)((function(){return[(0,a.bF)(C.A,{name:"list",alt:""}),(0,a.eW)(" "+(0,l.v_)((0,o.R1)(t).tab_title),1)]})),_:1},8,["href"]),(0,a.bF)(Z,{active:""},{default:(0,a.k6)((function(){return[(0,a.bF)(C.A,{name:"map-location-dot",alt:""}),(0,a.eW)(" Carte des enseignes ")]})),_:1})]})),panels:(0,a.k6)((function(){return[(0,a.bF)(Y,{companiesUrl:u.value,extraPlacesUrl:"/public/cae_places.geojson"},null,8,["companiesUrl"])]})),_:1})]})),_:1}))],64)}}},ae=ne;var oe=r(320),le=r(4142),ie=r(4456),ue={class:"collapsible search_filters expanded"},ce={class:"collapse_title"},se=["id","aria-expanded","title","aria-label"],pe=["id","aria-labelledby","hidden"];const fe={__name:"CollapsibleSearchFilters",props:{title:{required:!0,type:String},initialCollapsedState:{type:Boolean,default:!1},initialFilters:{type:Object,default:{}}},emits:["applyFilters"],setup:function(e,t){var r=t.emit,i=e,u=(0,o.KR)(i.initialCollapsedState),c=(0,n.NF)("accordionPanel"),s=(0,n.NF)("accordionTitle"),p=function(){return u.value=!u.value},f=(0,a.EW)((function(){return u.value?"Afficher les champs de recherche":"Masquer les champs de recherche"})),d=Object.assign({},i.initialFilters),v=function(e){return d[e.target.name]=e.target.value},m=function(e){e.preventDefault(),r("applyFilters",d)};return(0,a.wB)((function(){return i.initialFilters}),(function(){return Object.assign(d,i.initialFilters)})),function(t,r){return(0,a.uX)(),(0,a.CE)("div",ue,[(0,a.Lk)("h2",ce,[(0,a.Lk)("a",{href:"#",id:(0,o.R1)(s),"aria-expanded":!u.value,accesskey:"R",title:f.value,"aria-label":f.value,onClick:p},[(0,a.bF)(C.A,{name:"search",alt:""}),(0,a.eW)(" "+(0,l.v_)(e.title)+" ",1),(0,a.bF)(R.A,{class:"arrow",name:"chevron-down"})],8,se)]),(0,a.Lk)("div",{class:"collapse_content",id:(0,o.R1)(c),"aria-labelledby":(0,o.R1)(s),hidden:u.value},[(0,a.Lk)("div",null,[(0,a.Lk)("form",{id:"search_form",class:"form-search form-inline",onChange:v,onSubmit:m},[(0,a.RG)(t.$slots,"default"),(0,a.Lk)("div",null,[(0,a.bF)(ie.A,{css:"btn-primary",icon:"search",buttonType:"submit",title:"Lancer la recherche avec ces critères",label:"Lancer la recherche avec ces critères"})])],32)])],8,pe)])}}};var de=r(810),ve=r(3454),me=r(4590),he=r(9805),be=(0,ve.A)("company"),_e=["goal","name","activities","email","phone","mobile","address","zip_code","city","country","latitude","longitude","logo","logo_id","cgv","header","header_id","decimal_to_display","internal","code_compta","general_customer_account","general_expense_account","third_party_customer_account","general_supplier_account","third_party_supplier_account","internalgeneral_customer_account","internalthird_party_customer_account","internalgeneral_supplier_account","internalthird_party_supplier_account","contribution","internalcontribution","insurance","internalinsurance","RIB","IBAN","antenne_id","follower_id","use_margin_rate_in_catalog","margin_rate"];(0,de.nY)("company",{state:function(){return{loading:!0,error:!1,collection:[],collectionMetaData:{},companyId:null,item:{}}},actions:{setCurrentCompanyId:function(e){this.companyId=e},loadCompanies:function(e,t){var r=this;return(0,c.A)(p().mark((function n(){return p().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r.loading=!0,n.abrupt("return",he.A.companies.getCompanies(e,t).then((function(e){var n;return t.pageOptions&&2==e.length?(r.collectionMetaData=e[0],n=e[1]):n=e,r.loading=!1,r.error="",r.collection=n,n})).catch(r.handleError));case 2:case"end":return n.stop()}}),n)})))()},loadCompany:function(){var e=arguments,t=this;return(0,c.A)(p().mark((function r(){var n,a;return p().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(null===(a=e.length>1&&void 0!==e[1]?e[1]:null)&&(a=_e),n=(n=e.length>0&&void 0!==e[0]?e[0]:null)||t.companyId){r.next=6;break}throw Error("no Id provided");case 6:return t.loading=!0,r.abrupt("return",he.A.companies.load(n,a).then((function(e){return t.loading=!1,t.error=!1,t.item=e,e})).catch(t.handleError));case 8:case"end":return r.stop()}}),r)})))()},handleError:function(e){var t=this;return(0,c.A)(p().mark((function r(){return p().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return t.loading=!1,t.error=e,r.abrupt("return",Promise.reject(e));case 3:case"end":return r.stop()}}),r)})))()},saveCompany:function(e){var t=this;return(0,c.A)(p().mark((function r(){var n;return p().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!(n=t.companyId||e.id)){r.next=5;break}return r.abrupt("return",he.A.companies.update(e,n));case 5:return r.abrupt("return",t.createCompany(e));case 6:case"end":return r.stop()}}),r)})))()},createCompany:function(e){return(0,c.A)(p().mark((function t(){return p().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.id){t.next=2;break}throw Error("Company already exists (has an id)");case 2:return t.abrupt("return",he.A.companies.create(e));case 3:case"end":return t.stop()}}),t)})))()}},getters:(0,me.Q)("company")});var ge=[{path:"/companies_map",components:{CompanyURLSearchFilters:{__name:"CompanyUrlSearchFilters",setup:function(e){return(0,c.A)(p().mark((function e(){var t,r,n,l,i,c,s,f,d;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=(0,re.rd)(),c=(0,re.lq)(),s=be(),f=function(e){i.push({path:"/companies_map",query:e})},s.setUrl("/api/v1/companies.geojson?form_config=1"),t=(0,a.E)((function(){return s.loadConfig()})),r=(0,u.A)(t,2),n=r[0],l=r[1],e.next=8,n;case 8:return l(),d=s.getOptions("activities"),e.abrupt("return",(function(e,t){return(0,a.uX)(),(0,a.Wv)(fe,{title:"Recherche",onApplyFilters:f,initialFilters:(0,o.R1)(c).query},{default:(0,a.k6)((function(){return[(0,a.bF)(oe.A,{label:"Nom, enseigne, activité",name:"search",value:(0,o.R1)(c).query.search},null,8,["value"]),(0,a.bF)(le.A,{label:"Type d'activité",name:"activity_id",options:(0,o.R1)(d),value:(0,o.R1)(c).query.activity_id,"add-default":"","default-option":{id:"",label:"- Tous les types d'activité -"}},null,8,["options","value"]),(0,a.bF)(oe.A,{label:"Code postal",name:"postcode",value:(0,o.R1)(c).query.postcode},null,8,["value"])]})),_:1},8,["initialFilters"])}));case 11:case"end":return e.stop()}}),e)})))()}}}}];(0,n.Yk)(ae,"vue-app",ge)}},a={};function o(e){var t=a[e];if(void 0!==t)return t.exports;var r=a[e]={exports:{}};return n[e].call(r.exports,r,r.exports,o),r.exports}o.m=n,e=[],o.O=(t,r,n,a)=>{if(!r){var l=1/0;for(s=0;s<e.length;s++){for(var[r,n,a]=e[s],i=!0,u=0;u<r.length;u++)(!1&a||l>=a)&&Object.keys(o.O).every((e=>o.O[e](r[u])))?r.splice(u--,1):(i=!1,a<l&&(l=a));if(i){e.splice(s--,1);var c=n();void 0!==c&&(t=c)}}return t}a=a||0;for(var s=e.length;s>0&&e[s-1][2]>a;s--)e[s]=e[s-1];e[s]=[r,n,a]},o.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return o.d(t,{a:t}),t},r=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,o.t=function(e,n){if(1&n&&(e=this(e)),8&n)return e;if("object"==typeof e&&e){if(4&n&&e.__esModule)return e;if(16&n&&"function"==typeof e.then)return e}var a=Object.create(null);o.r(a);var l={};t=t||[null,r({}),r([]),r(r)];for(var i=2&n&&e;"object"==typeof i&&!~t.indexOf(i);i=r(i))Object.getOwnPropertyNames(i).forEach((t=>l[t]=()=>e[t]));return l.default=()=>e,o.d(a,l),a},o.d=(e,t)=>{for(var r in t)o.o(t,r)&&!o.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},o.e=()=>Promise.resolve(),o.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.j=503,(()=>{var e;o.g.importScripts&&(e=o.g.location+"");var t=o.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var r=t.getElementsByTagName("script");if(r.length)for(var n=r.length-1;n>-1&&(!e||!/^http(s?):/.test(e));)e=r[n--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),o.p=e})(),(()=>{var e={503:0};o.O.j=t=>0===e[t];var t=(t,r)=>{var n,a,[l,i,u]=r,c=0;if(l.some((t=>0!==e[t]))){for(n in i)o.o(i,n)&&(o.m[n]=i[n]);if(u)var s=u(o)}for(t&&t(r);c<l.length;c++)a=l[c],o.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return o.O(s)},r=self.webpackChunkenDI=self.webpackChunkenDI||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})(),o.nc=void 0;var l=o.O(void 0,[534],(()=>o(7040)));l=o.O(l)})();