
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../people/">
      
      
        <link rel="next" href="../utils/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.9">
    
    
      
        <title>Specimens - Snailz Docs</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.4af4bdda.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#snailz.specimens" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Snailz Docs" class="md-header__button md-logo" aria-label="Snailz Docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Snailz Docs
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Specimens
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Snailz Docs" class="md-nav__button md-logo" aria-label="Snailz Docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Snailz Docs
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Snailz
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../assays/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Assays
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../clui/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Clui
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../contributing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contributing
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../database/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Database
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../grid/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Grid
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../license/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MIT License
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../mangle/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mangle
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../people/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    People
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Specimens
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Specimens
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#snailz.specimens" class="md-nav__link">
    <span class="md-ellipsis">
      specimens
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#snailz.specimens.SpecimenParams" class="md-nav__link">
    <span class="md-ellipsis">
      SpecimenParams
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SpecimenParams">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#snailz.specimens.SpecimenParams.validate_fields" class="md-nav__link">
    <span class="md-ellipsis">
      validate_fields
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#snailz.specimens.Specimen" class="md-nav__link">
    <span class="md-ellipsis">
      Specimen
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#snailz.specimens.AllSpecimens" class="md-nav__link">
    <span class="md-ellipsis">
      AllSpecimens
    </span>
  </a>
  
    <nav class="md-nav" aria-label="AllSpecimens">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#snailz.specimens.AllSpecimens.to_csv" class="md-nav__link">
    <span class="md-ellipsis">
      to_csv
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#snailz.specimens.specimens_generate" class="md-nav__link">
    <span class="md-ellipsis">
      specimens_generate
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#snailz.specimens._adjust_masses_by_location" class="md-nav__link">
    <span class="md-ellipsis">
      _adjust_masses_by_location
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#snailz.specimens._choose_one" class="md-nav__link">
    <span class="md-ellipsis">
      _choose_one
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#snailz.specimens._choose_other" class="md-nav__link">
    <span class="md-ellipsis">
      _choose_other
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#snailz.specimens._make_collection_dates" class="md-nav__link">
    <span class="md-ellipsis">
      _make_collection_dates
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#snailz.specimens._make_genome" class="md-nav__link">
    <span class="md-ellipsis">
      _make_genome
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#snailz.specimens._make_idents" class="md-nav__link">
    <span class="md-ellipsis">
      _make_idents
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#snailz.specimens._make_initial_masses" class="md-nav__link">
    <span class="md-ellipsis">
      _make_initial_masses
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#snailz.specimens._make_locations" class="md-nav__link">
    <span class="md-ellipsis">
      _make_locations
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#snailz.specimens._make_loci" class="md-nav__link">
    <span class="md-ellipsis">
      _make_loci
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#snailz.specimens._make_reference_genome" class="md-nav__link">
    <span class="md-ellipsis">
      _make_reference_genome
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#snailz.specimens._mutate_mass" class="md-nav__link">
    <span class="md-ellipsis">
      _mutate_mass
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#snailz.specimens._place_specimens_on_grid" class="md-nav__link">
    <span class="md-ellipsis">
      _place_specimens_on_grid
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Utils
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#snailz.specimens" class="md-nav__link">
    <span class="md-ellipsis">
      specimens
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#snailz.specimens.SpecimenParams" class="md-nav__link">
    <span class="md-ellipsis">
      SpecimenParams
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SpecimenParams">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#snailz.specimens.SpecimenParams.validate_fields" class="md-nav__link">
    <span class="md-ellipsis">
      validate_fields
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#snailz.specimens.Specimen" class="md-nav__link">
    <span class="md-ellipsis">
      Specimen
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#snailz.specimens.AllSpecimens" class="md-nav__link">
    <span class="md-ellipsis">
      AllSpecimens
    </span>
  </a>
  
    <nav class="md-nav" aria-label="AllSpecimens">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#snailz.specimens.AllSpecimens.to_csv" class="md-nav__link">
    <span class="md-ellipsis">
      to_csv
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#snailz.specimens.specimens_generate" class="md-nav__link">
    <span class="md-ellipsis">
      specimens_generate
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#snailz.specimens._adjust_masses_by_location" class="md-nav__link">
    <span class="md-ellipsis">
      _adjust_masses_by_location
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#snailz.specimens._choose_one" class="md-nav__link">
    <span class="md-ellipsis">
      _choose_one
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#snailz.specimens._choose_other" class="md-nav__link">
    <span class="md-ellipsis">
      _choose_other
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#snailz.specimens._make_collection_dates" class="md-nav__link">
    <span class="md-ellipsis">
      _make_collection_dates
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#snailz.specimens._make_genome" class="md-nav__link">
    <span class="md-ellipsis">
      _make_genome
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#snailz.specimens._make_idents" class="md-nav__link">
    <span class="md-ellipsis">
      _make_idents
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#snailz.specimens._make_initial_masses" class="md-nav__link">
    <span class="md-ellipsis">
      _make_initial_masses
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#snailz.specimens._make_locations" class="md-nav__link">
    <span class="md-ellipsis">
      _make_locations
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#snailz.specimens._make_loci" class="md-nav__link">
    <span class="md-ellipsis">
      _make_loci
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#snailz.specimens._make_reference_genome" class="md-nav__link">
    <span class="md-ellipsis">
      _make_reference_genome
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#snailz.specimens._mutate_mass" class="md-nav__link">
    <span class="md-ellipsis">
      _mutate_mass
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#snailz.specimens._place_specimens_on_grid" class="md-nav__link">
    <span class="md-ellipsis">
      _place_specimens_on_grid
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



  <h1>Specimens</h1>

<div class="doc doc-object doc-module">



<a id="snailz.specimens"></a>
    <div class="doc doc-contents first">

        <p>Generate snail specimens.</p>
<p>This module handles the generation of snail specimens with the following process:
1. Generate genomes with random mutations
2. Assign initial masses based on whether they have the significant mutation
3. Place specimens randomly on the grid (no two snails in the same cell)
4. Adjust masses based on whether their location is polluted or not</p>









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="snailz.specimens.SpecimenParams" class="doc doc-heading">
            <code>SpecimenParams</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="pydantic.BaseModel">BaseModel</span></code></p>


        <p>Parameters for specimen generation.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>end_date</code>
            </td>
            <td>
                  <code><span title="datetime.date">date</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>End date for specimen collection</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>length</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Length of specimen genomes (must be positive)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>max_mass</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maximum mass for specimens (must be positive)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>min_mass</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Minimum mass for specimens (must be positive and less than max_mass)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>mut_scale</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Scale factor for mutation effect</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>mutations</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of mutations in specimens (must be between 0 and length)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>number</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of specimens to generate (must be positive)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>seed</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Random seed for reproducibility</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>start_date</code>
            </td>
            <td>
                  <code><span title="datetime.date">date</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Start date for specimen collection</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>







              <details class="quote">
                <summary>Source code in <code>src/snailz/specimens.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">SpecimenParams</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Parameters for specimen generation.&quot;&quot;&quot;</span>

    <span class="n">end_date</span><span class="p">:</span> <span class="n">date</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s2">&quot;End date for specimen collection&quot;</span><span class="p">)</span>
    <span class="n">length</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="n">gt</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Length of specimen genomes (must be positive)&quot;</span>
    <span class="p">)</span>
    <span class="n">max_mass</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="n">gt</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Maximum mass for specimens (must be positive)&quot;</span>
    <span class="p">)</span>
    <span class="n">min_mass</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="n">gt</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Minimum mass for specimens (must be positive and less than max_mass)&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">mut_scale</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">ge</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Scale factor for mutation effect&quot;</span><span class="p">)</span>
    <span class="n">mutations</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="n">ge</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Number of mutations in specimens (must be between 0 and length)&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">number</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="n">gt</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Number of specimens to generate (must be positive)&quot;</span>
    <span class="p">)</span>
    <span class="n">seed</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">ge</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Random seed for reproducibility&quot;</span><span class="p">)</span>
    <span class="n">start_date</span><span class="p">:</span> <span class="n">date</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s2">&quot;Start date for specimen collection&quot;</span><span class="p">)</span>

    <span class="n">model_config</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;extra&quot;</span><span class="p">:</span> <span class="s2">&quot;forbid&quot;</span><span class="p">}</span>

    <span class="nd">@model_validator</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s2">&quot;after&quot;</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">validate_fields</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Validate requirements on fields.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_mass</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_mass</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;max_mass must be greater than min_mass&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mutations</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">length</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;mutations must be between 0 and length&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">end_date</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_date</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;end_date must be greater than or equal to start_date&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="snailz.specimens.SpecimenParams.validate_fields" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">validate_fields</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Validate requirements on fields.</p>


            <details class="quote">
              <summary>Source code in <code>src/snailz/specimens.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@model_validator</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s2">&quot;after&quot;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">validate_fields</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Validate requirements on fields.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_mass</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_mass</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;max_mass must be greater than min_mass&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mutations</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">length</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;mutations must be between 0 and length&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">end_date</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_date</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;end_date must be greater than or equal to start_date&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="snailz.specimens.Specimen" class="doc doc-heading">
            <code>Specimen</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="pydantic.BaseModel">BaseModel</span></code></p>


        <p>A single specimen.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>ident</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>unique identifier</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>collected_on</code>
            </td>
            <td>
                  <code><span title="datetime.date">date</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>date when specimen was collected</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>genome</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>bases in genome</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>mass</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>snail mass in grams</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>site</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Point (snailz.utils.Point)" href="../utils/#snailz.utils.Point">Point</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>grid location where specimen was collected</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>







              <details class="quote">
                <summary>Source code in <code>src/snailz/specimens.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">Specimen</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A single specimen.&quot;&quot;&quot;</span>

    <span class="n">ident</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s2">&quot;unique identifier&quot;</span><span class="p">)</span>
    <span class="n">collected_on</span><span class="p">:</span> <span class="n">date</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s2">&quot;date when specimen was collected&quot;</span><span class="p">)</span>
    <span class="n">genome</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s2">&quot;bases in genome&quot;</span><span class="p">)</span>
    <span class="n">mass</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">gt</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;snail mass in grams&quot;</span><span class="p">)</span>
    <span class="n">site</span><span class="p">:</span> <span class="n">Point</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s2">&quot;grid location where specimen was collected&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="snailz.specimens.AllSpecimens" class="doc doc-heading">
            <code>AllSpecimens</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="pydantic.BaseModel">BaseModel</span></code></p>


        <p>A set of generated specimens.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>individuals</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<a class="autorefs autorefs-internal" title="Specimen (snailz.specimens.Specimen)" href="#snailz.specimens.Specimen">Specimen</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list of individual specimens</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>loci</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>locations where mutations can occur</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>params</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="SpecimenParams (snailz.specimens.SpecimenParams)" href="#snailz.specimens.SpecimenParams">SpecimenParams</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>parameters used to generate this data</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>reference</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>unmutated genome</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>susceptible_base</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>mutant base that induces mass changes</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>susceptible_locus</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>location of mass change mutation</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>







              <details class="quote">
                <summary>Source code in <code>src/snailz/specimens.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">AllSpecimens</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A set of generated specimens.&quot;&quot;&quot;</span>

    <span class="n">individuals</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Specimen</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s2">&quot;list of individual specimens&quot;</span><span class="p">)</span>
    <span class="n">loci</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s2">&quot;locations where mutations can occur&quot;</span><span class="p">)</span>
    <span class="n">params</span><span class="p">:</span> <span class="n">SpecimenParams</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s2">&quot;parameters used to generate this data&quot;</span><span class="p">)</span>
    <span class="n">reference</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s2">&quot;unmutated genome&quot;</span><span class="p">)</span>
    <span class="n">susceptible_base</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s2">&quot;mutant base that induces mass changes&quot;</span><span class="p">)</span>
    <span class="n">susceptible_locus</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">ge</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;location of mass change mutation&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">to_csv</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a CSV string representation of the specimens data.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A CSV-formatted string with people data (without parameters)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">output</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">StringIO</span><span class="p">()</span>
        <span class="n">writer</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">csv_writer</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
        <span class="n">writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">(</span>
            <span class="p">[</span><span class="s2">&quot;ident&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;genome&quot;</span><span class="p">,</span> <span class="s2">&quot;mass&quot;</span><span class="p">,</span> <span class="s2">&quot;collected_on&quot;</span><span class="p">]</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">indiv</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">individuals</span><span class="p">:</span>
            <span class="n">writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">(</span>
                <span class="p">[</span>
                    <span class="n">indiv</span><span class="o">.</span><span class="n">ident</span><span class="p">,</span>
                    <span class="n">indiv</span><span class="o">.</span><span class="n">site</span><span class="o">.</span><span class="n">x</span><span class="p">,</span>
                    <span class="n">indiv</span><span class="o">.</span><span class="n">site</span><span class="o">.</span><span class="n">y</span><span class="p">,</span>
                    <span class="n">indiv</span><span class="o">.</span><span class="n">genome</span><span class="p">,</span>
                    <span class="n">indiv</span><span class="o">.</span><span class="n">mass</span><span class="p">,</span>
                    <span class="n">indiv</span><span class="o">.</span><span class="n">collected_on</span><span class="p">,</span>
                <span class="p">]</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="n">output</span><span class="o">.</span><span class="n">getvalue</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="snailz.specimens.AllSpecimens.to_csv" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">to_csv</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Return a CSV string representation of the specimens data.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A CSV-formatted string with people data (without parameters)</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/snailz/specimens.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">to_csv</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a CSV string representation of the specimens data.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A CSV-formatted string with people data (without parameters)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">output</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">StringIO</span><span class="p">()</span>
    <span class="n">writer</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">csv_writer</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
    <span class="n">writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">(</span>
        <span class="p">[</span><span class="s2">&quot;ident&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;genome&quot;</span><span class="p">,</span> <span class="s2">&quot;mass&quot;</span><span class="p">,</span> <span class="s2">&quot;collected_on&quot;</span><span class="p">]</span>
    <span class="p">)</span>
    <span class="k">for</span> <span class="n">indiv</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">individuals</span><span class="p">:</span>
        <span class="n">writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="n">indiv</span><span class="o">.</span><span class="n">ident</span><span class="p">,</span>
                <span class="n">indiv</span><span class="o">.</span><span class="n">site</span><span class="o">.</span><span class="n">x</span><span class="p">,</span>
                <span class="n">indiv</span><span class="o">.</span><span class="n">site</span><span class="o">.</span><span class="n">y</span><span class="p">,</span>
                <span class="n">indiv</span><span class="o">.</span><span class="n">genome</span><span class="p">,</span>
                <span class="n">indiv</span><span class="o">.</span><span class="n">mass</span><span class="p">,</span>
                <span class="n">indiv</span><span class="o">.</span><span class="n">collected_on</span><span class="p">,</span>
            <span class="p">]</span>
        <span class="p">)</span>
    <span class="k">return</span> <span class="n">output</span><span class="o">.</span><span class="n">getvalue</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h2 id="snailz.specimens.specimens_generate" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">specimens_generate</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Generate specimens with random genomes and masses.</p>
<p>Each genome is a string of bases of the same length. One locus is
randomly chosen as "significant", and a specific mutation there
predisposes the snail to mass changes.</p>
<p>The process follows these steps:
1. Generate genomes with random mutations
2. Assign initial masses based on whether they have the significant mutation
3. Place specimens randomly on the grid (no two snails in the same cell)
4. Adjust masses based on location if a grid is provided</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>params</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="SpecimenParams (snailz.specimens.SpecimenParams)" href="#snailz.specimens.SpecimenParams">SpecimenParams</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>SpecimenParams object</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>grid</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Grid (snailz.grid.Grid)" href="../grid/#snailz.grid.Grid">Grid</a> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Grid object to place specimens on for mass mutation</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="AllSpecimens (snailz.specimens.AllSpecimens)" href="#snailz.specimens.AllSpecimens">AllSpecimens</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>AllSpecimens object containing the generated specimens and parameters</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/snailz/specimens.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">specimens_generate</span><span class="p">(</span>
    <span class="n">params</span><span class="p">:</span> <span class="n">SpecimenParams</span><span class="p">,</span> <span class="n">grid</span><span class="p">:</span> <span class="n">Grid</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AllSpecimens</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generate specimens with random genomes and masses.</span>

<span class="sd">    Each genome is a string of bases of the same length. One locus is</span>
<span class="sd">    randomly chosen as &quot;significant&quot;, and a specific mutation there</span>
<span class="sd">    predisposes the snail to mass changes.</span>

<span class="sd">    The process follows these steps:</span>
<span class="sd">    1. Generate genomes with random mutations</span>
<span class="sd">    2. Assign initial masses based on whether they have the significant mutation</span>
<span class="sd">    3. Place specimens randomly on the grid (no two snails in the same cell)</span>
<span class="sd">    4. Adjust masses based on location if a grid is provided</span>

<span class="sd">    Parameters:</span>
<span class="sd">        params: SpecimenParams object</span>
<span class="sd">        grid: Grid object to place specimens on for mass mutation</span>

<span class="sd">    Returns:</span>
<span class="sd">        AllSpecimens object containing the generated specimens and parameters</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">loci</span> <span class="o">=</span> <span class="n">_make_loci</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
    <span class="n">reference</span> <span class="o">=</span> <span class="n">_make_reference_genome</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
    <span class="n">susc_loc</span> <span class="o">=</span> <span class="n">_choose_one</span><span class="p">(</span><span class="n">loci</span><span class="p">)</span>
    <span class="n">susc_base</span> <span class="o">=</span> <span class="n">reference</span><span class="p">[</span><span class="n">susc_loc</span><span class="p">]</span>
    <span class="n">genomes</span> <span class="o">=</span> <span class="p">[</span><span class="n">_make_genome</span><span class="p">(</span><span class="n">reference</span><span class="p">,</span> <span class="n">loci</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">params</span><span class="o">.</span><span class="n">number</span><span class="p">)]</span>
    <span class="n">identifiers</span> <span class="o">=</span> <span class="n">_make_idents</span><span class="p">(</span><span class="n">params</span><span class="o">.</span><span class="n">number</span><span class="p">)</span>
    <span class="n">collection_dates</span> <span class="o">=</span> <span class="n">_make_collection_dates</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
    <span class="n">masses</span> <span class="o">=</span> <span class="n">_make_initial_masses</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">genomes</span><span class="p">,</span> <span class="n">susc_loc</span><span class="p">,</span> <span class="n">susc_base</span><span class="p">)</span>

    <span class="n">individuals</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">Specimen</span><span class="p">(</span><span class="n">genome</span><span class="o">=</span><span class="n">g</span><span class="p">,</span> <span class="n">mass</span><span class="o">=</span><span class="n">m</span><span class="p">,</span> <span class="n">site</span><span class="o">=</span><span class="n">Point</span><span class="p">(),</span> <span class="n">ident</span><span class="o">=</span><span class="n">i</span><span class="p">,</span> <span class="n">collected_on</span><span class="o">=</span><span class="n">d</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">g</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">genomes</span><span class="p">,</span> <span class="n">masses</span><span class="p">,</span> <span class="n">identifiers</span><span class="p">,</span> <span class="n">collection_dates</span><span class="p">)</span>
    <span class="p">]</span>

    <span class="n">result</span> <span class="o">=</span> <span class="n">AllSpecimens</span><span class="p">(</span>
        <span class="n">individuals</span><span class="o">=</span><span class="n">individuals</span><span class="p">,</span>
        <span class="n">loci</span><span class="o">=</span><span class="n">loci</span><span class="p">,</span>
        <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span>
        <span class="n">reference</span><span class="o">=</span><span class="n">reference</span><span class="p">,</span>
        <span class="n">susceptible_base</span><span class="o">=</span><span class="n">susc_base</span><span class="p">,</span>
        <span class="n">susceptible_locus</span><span class="o">=</span><span class="n">susc_loc</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">grid</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">_place_specimens_on_grid</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>
        <span class="n">_adjust_masses_by_location</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span> <span class="n">params</span><span class="o">.</span><span class="n">mut_scale</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">result</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="snailz.specimens._adjust_masses_by_location" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">_adjust_masses_by_location</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="n">specimens</span><span class="p">,</span> <span class="n">mut_scale</span><span class="p">,</span> <span class="n">specific_index</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Adjust mass based on grid values and genetic susceptibility.</p>
<p>For each specimen, if the cell value is non-zero and the genome is
susceptible, modify the mass. Specimens must already have site
coordinates assigned by _place_specimens_on_grid().</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>grid</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Grid (snailz.grid.Grid)" href="../grid/#snailz.grid.Grid">Grid</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A Grid object containing pollution values</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>specimens</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="AllSpecimens (snailz.specimens.AllSpecimens)" href="#snailz.specimens.AllSpecimens">AllSpecimens</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An AllSpecimens object with individuals to potentially adjust</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>mut_scale</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Scaling factor for mutation effect</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>specific_index</code>
            </td>
            <td>
                  <code><span title="int">int</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional index to adjust only a specific specimen</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/snailz/specimens.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">_adjust_masses_by_location</span><span class="p">(</span>
    <span class="n">grid</span><span class="p">:</span> <span class="n">Grid</span><span class="p">,</span>
    <span class="n">specimens</span><span class="p">:</span> <span class="n">AllSpecimens</span><span class="p">,</span>
    <span class="n">mut_scale</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">specific_index</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Adjust mass based on grid values and genetic susceptibility.</span>

<span class="sd">    For each specimen, if the cell value is non-zero and the genome is</span>
<span class="sd">    susceptible, modify the mass. Specimens must already have site</span>
<span class="sd">    coordinates assigned by _place_specimens_on_grid().</span>

<span class="sd">    Parameters:</span>
<span class="sd">        grid: A Grid object containing pollution values</span>
<span class="sd">        specimens: An AllSpecimens object with individuals to potentially adjust</span>
<span class="sd">        mut_scale: Scaling factor for mutation effect</span>
<span class="sd">        specific_index: Optional index to adjust only a specific specimen</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">susc_locus</span> <span class="o">=</span> <span class="n">specimens</span><span class="o">.</span><span class="n">susceptible_locus</span>
    <span class="n">susc_base</span> <span class="o">=</span> <span class="n">specimens</span><span class="o">.</span><span class="n">susceptible_base</span>

    <span class="k">if</span> <span class="n">specific_index</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">individuals</span> <span class="o">=</span> <span class="n">specimens</span><span class="o">.</span><span class="n">individuals</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">individuals</span> <span class="o">=</span> <span class="p">[</span><span class="n">specimens</span><span class="o">.</span><span class="n">individuals</span><span class="p">[</span><span class="n">specific_index</span><span class="p">]]</span>

    <span class="k">for</span> <span class="n">indiv</span> <span class="ow">in</span> <span class="n">individuals</span><span class="p">:</span>
        <span class="k">assert</span> <span class="n">indiv</span><span class="o">.</span><span class="n">site</span><span class="o">.</span><span class="n">x</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">indiv</span><span class="o">.</span><span class="n">site</span><span class="o">.</span><span class="n">y</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Specimens must be placed on grid first&quot;</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">indiv</span><span class="o">.</span><span class="n">site</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">indiv</span><span class="o">.</span><span class="n">site</span><span class="o">.</span><span class="n">y</span>
        <span class="k">if</span> <span class="n">grid</span><span class="o">.</span><span class="n">grid</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">indiv</span><span class="o">.</span><span class="n">genome</span><span class="p">[</span><span class="n">susc_locus</span><span class="p">]</span> <span class="o">==</span> <span class="n">susc_base</span><span class="p">:</span>
            <span class="n">indiv</span><span class="o">.</span><span class="n">mass</span> <span class="o">=</span> <span class="n">_mutate_mass</span><span class="p">(</span><span class="n">indiv</span><span class="o">.</span><span class="n">mass</span><span class="p">,</span> <span class="n">mut_scale</span><span class="p">,</span> <span class="n">grid</span><span class="o">.</span><span class="n">grid</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">])</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="snailz.specimens._choose_one" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">_choose_one</span><span class="p">(</span><span class="n">values</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Choose a single random item from a collection.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>values</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A sequence to choose from</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A randomly selected item from the values sequence</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/snailz/specimens.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">_choose_one</span><span class="p">(</span><span class="n">values</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Choose a single random item from a collection.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        values: A sequence to choose from</span>

<span class="sd">    Returns:</span>
<span class="sd">        A randomly selected item from the values sequence</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">random</span><span class="o">.</span><span class="n">choices</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="snailz.specimens._choose_other" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">_choose_other</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">exclude</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Choose a value at random except for the excluded values.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>values</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A collection to choose from</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>exclude</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Value or collection of values to exclude from the choice</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A randomly selected item from values that isn't in exclude</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/snailz/specimens.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">_choose_other</span><span class="p">(</span><span class="n">values</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">exclude</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Choose a value at random except for the excluded values.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        values: A collection to choose from</span>
<span class="sd">        exclude: Value or collection of values to exclude from the choice</span>

<span class="sd">    Returns:</span>
<span class="sd">        A randomly selected item from values that isn&#39;t in exclude</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">candidates</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">values</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">exclude</span><span class="p">)))</span>
    <span class="k">return</span> <span class="n">candidates</span><span class="p">[</span><span class="n">random</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">candidates</span><span class="p">))]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="snailz.specimens._make_collection_dates" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">_make_collection_dates</span><span class="p">(</span><span class="n">params</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Generate random collection dates for specimens.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>params</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="SpecimenParams (snailz.specimens.SpecimenParams)" href="#snailz.specimens.SpecimenParams">SpecimenParams</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>SpecimenParams with start_date, end_date, and number attributes</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="datetime.date">date</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of randomly generated collection dates between start_date and end_date</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/snailz/specimens.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">_make_collection_dates</span><span class="p">(</span><span class="n">params</span><span class="p">:</span> <span class="n">SpecimenParams</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">date</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generate random collection dates for specimens.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        params: SpecimenParams with start_date, end_date, and number attributes</span>

<span class="sd">    Returns:</span>
<span class="sd">        List of randomly generated collection dates between start_date and end_date</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">start_ordinal</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">start_date</span><span class="o">.</span><span class="n">toordinal</span><span class="p">()</span>
    <span class="n">end_ordinal</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">end_date</span><span class="o">.</span><span class="n">toordinal</span><span class="p">()</span>
    <span class="k">return</span> <span class="p">[</span>
        <span class="n">date</span><span class="o">.</span><span class="n">fromordinal</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">start_ordinal</span><span class="p">,</span> <span class="n">end_ordinal</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">params</span><span class="o">.</span><span class="n">number</span><span class="p">)</span>
    <span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="snailz.specimens._make_genome" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">_make_genome</span><span class="p">(</span><span class="n">reference</span><span class="p">,</span> <span class="n">loci</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Make an individual genome by mutating the reference genome.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>reference</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Reference genome string to base the new genome on</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>loci</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of positions that can be mutated</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A new genome string with random mutations at some loci</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/snailz/specimens.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">_make_genome</span><span class="p">(</span><span class="n">reference</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">loci</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Make an individual genome by mutating the reference genome.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        reference: Reference genome string to base the new genome on</span>
<span class="sd">        loci: List of positions that can be mutated</span>

<span class="sd">    Returns:</span>
<span class="sd">        A new genome string with random mutations at some loci</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">result</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">reference</span><span class="p">)</span>
    <span class="n">num_mutations</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">loci</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">loc</span> <span class="ow">in</span> <span class="n">random</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">loci</span><span class="p">)),</span> <span class="n">num_mutations</span><span class="p">):</span>
        <span class="n">result</span><span class="p">[</span><span class="n">loc</span><span class="p">]</span> <span class="o">=</span> <span class="n">_choose_other</span><span class="p">(</span><span class="n">BASES</span><span class="p">,</span> <span class="n">reference</span><span class="p">[</span><span class="n">loc</span><span class="p">])</span>
    <span class="k">return</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="snailz.specimens._make_idents" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">_make_idents</span><span class="p">(</span><span class="n">count</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Create unique specimen identifiers.</p>
<p>Each identifier is a 6-character string:
- First two characters are the same uppercase letters for all specimens
- Remaining four chararacters are random uppercase letters and digits</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>count</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of identifiers to generate</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of unique specimen identifiers</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/snailz/specimens.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">_make_idents</span><span class="p">(</span><span class="n">count</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create unique specimen identifiers.</span>

<span class="sd">    Each identifier is a 6-character string:</span>
<span class="sd">    - First two characters are the same uppercase letters for all specimens</span>
<span class="sd">    - Remaining four chararacters are random uppercase letters and digits</span>

<span class="sd">    Parameters:</span>
<span class="sd">        count: Number of identifiers to generate</span>

<span class="sd">    Returns:</span>
<span class="sd">        List of unique specimen identifiers</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">prefix</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">choices</span><span class="p">(</span><span class="n">string</span><span class="o">.</span><span class="n">ascii_uppercase</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
    <span class="n">chars</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">ascii_uppercase</span> <span class="o">+</span> <span class="n">string</span><span class="o">.</span><span class="n">digits</span>
    <span class="n">gen</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">UniqueIdGenerator</span><span class="p">(</span>
        <span class="s2">&quot;specimens&quot;</span><span class="p">,</span> <span class="k">lambda</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">prefix</span><span class="si">}{</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">choices</span><span class="p">(</span><span class="n">chars</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="o">=</span><span class="mi">4</span><span class="p">))</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">gen</span><span class="o">.</span><span class="n">next</span><span class="p">()</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">count</span><span class="p">)]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="snailz.specimens._make_initial_masses" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">_make_initial_masses</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">genomes</span><span class="p">,</span> <span class="n">susceptible_locus</span><span class="p">,</span> <span class="n">susceptible_base</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Generate initial masses for specimens based on significant mutation.</p>
<p>Specimens with the susceptible base at the susceptible locus are given
a higher initial mass range compared to non-susceptible specimens.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>params</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="SpecimenParams (snailz.specimens.SpecimenParams)" href="#snailz.specimens.SpecimenParams">SpecimenParams</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>SpecimenParams with min_mass and max_mass attributes</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>genomes</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of genome strings</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>susceptible_locus</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Position that determines susceptibility</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>susceptible_base</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Base that makes a specimen susceptible</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of generated mass values between min_mass and max_mass,</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>rounded to PRECISION decimal places</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/snailz/specimens.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">_make_initial_masses</span><span class="p">(</span>
    <span class="n">params</span><span class="p">:</span> <span class="n">SpecimenParams</span><span class="p">,</span>
    <span class="n">genomes</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="n">susceptible_locus</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">susceptible_base</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generate initial masses for specimens based on significant mutation.</span>

<span class="sd">    Specimens with the susceptible base at the susceptible locus are given</span>
<span class="sd">    a higher initial mass range compared to non-susceptible specimens.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        params: SpecimenParams with min_mass and max_mass attributes</span>
<span class="sd">        genomes: List of genome strings</span>
<span class="sd">        susceptible_locus: Position that determines susceptibility</span>
<span class="sd">        susceptible_base: Base that makes a specimen susceptible</span>

<span class="sd">    Returns:</span>
<span class="sd">        List of generated mass values between min_mass and max_mass,</span>
<span class="sd">        rounded to PRECISION decimal places</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Calculate mass range midpoint</span>
    <span class="n">midpoint</span> <span class="o">=</span> <span class="p">(</span><span class="n">params</span><span class="o">.</span><span class="n">max_mass</span> <span class="o">+</span> <span class="n">params</span><span class="o">.</span><span class="n">min_mass</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>

    <span class="c1"># Create masses based on susceptibility</span>
    <span class="n">masses</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">genome</span> <span class="ow">in</span> <span class="n">genomes</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">genome</span><span class="p">[</span><span class="n">susceptible_locus</span><span class="p">]</span> <span class="o">==</span> <span class="n">susceptible_base</span><span class="p">:</span>
            <span class="c1"># Susceptible specimens get higher mass range</span>
            <span class="n">mass</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span>
                <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">midpoint</span><span class="p">,</span> <span class="n">params</span><span class="o">.</span><span class="n">max_mass</span><span class="p">),</span>
                <span class="n">utils</span><span class="o">.</span><span class="n">PRECISION</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Non-susceptible specimens get lower mass range</span>
            <span class="n">mass</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span>
                <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">params</span><span class="o">.</span><span class="n">min_mass</span><span class="p">,</span> <span class="n">midpoint</span><span class="p">),</span>
                <span class="n">utils</span><span class="o">.</span><span class="n">PRECISION</span>
            <span class="p">)</span>
        <span class="n">masses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mass</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">masses</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="snailz.specimens._make_locations" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">_make_locations</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">num</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Generate non-overlapping locations for specimens.</p>
<p>Selects random locations from the grid, ensuring no two specimens
are placed in the same cell. This implements the requirement that
no two snails may be placed in the same cell.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>size</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Size of the grid (assuming square grid)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>num</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of locations to generate</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="tuple">tuple</span>[<span title="int">int</span>, <span title="int">int</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of (x, y) coordinate tuples</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If there are not enough cells to place all specimens</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/snailz/specimens.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">_make_locations</span><span class="p">(</span><span class="n">size</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">num</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generate non-overlapping locations for specimens.</span>

<span class="sd">    Selects random locations from the grid, ensuring no two specimens</span>
<span class="sd">    are placed in the same cell. This implements the requirement that</span>
<span class="sd">    no two snails may be placed in the same cell.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        size: Size of the grid (assuming square grid)</span>
<span class="sd">        num: Number of locations to generate</span>

<span class="sd">    Returns:</span>
<span class="sd">        List of (x, y) coordinate tuples</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If there are not enough cells to place all specimens</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">num</span> <span class="o">&gt;</span> <span class="n">size</span> <span class="o">*</span> <span class="n">size</span><span class="p">:</span>
        <span class="n">utils</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cannot place </span><span class="si">{</span><span class="n">num</span><span class="si">}</span><span class="s2"> specimens on a </span><span class="si">{</span><span class="n">size</span><span class="si">}</span><span class="s2">x</span><span class="si">{</span><span class="n">size</span><span class="si">}</span><span class="s2"> grid&quot;</span><span class="p">)</span>

    <span class="c1"># Create all possible grid locations</span>
    <span class="n">all_locations</span> <span class="o">=</span> <span class="p">[(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">size</span><span class="p">)</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">size</span><span class="p">)]</span>

    <span class="c1"># Select locations randomly without replacement</span>
    <span class="n">chosen_locations</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">all_locations</span><span class="p">,</span> <span class="n">num</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">chosen_locations</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="snailz.specimens._make_loci" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">_make_loci</span><span class="p">(</span><span class="n">params</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Make a list of mutable loci positions.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>params</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="SpecimenParams (snailz.specimens.SpecimenParams)" href="#snailz.specimens.SpecimenParams">SpecimenParams</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>SpecimenParams with length and mutations attributes</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of unique randomly selected positions that can be mutated</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/snailz/specimens.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">_make_loci</span><span class="p">(</span><span class="n">params</span><span class="p">:</span> <span class="n">SpecimenParams</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Make a list of mutable loci positions.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        params: SpecimenParams with length and mutations attributes</span>

<span class="sd">    Returns:</span>
<span class="sd">        A list of unique randomly selected positions that can be mutated</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">random</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">params</span><span class="o">.</span><span class="n">length</span><span class="p">)),</span> <span class="n">params</span><span class="o">.</span><span class="n">mutations</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="snailz.specimens._make_reference_genome" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">_make_reference_genome</span><span class="p">(</span><span class="n">params</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Make a random reference genome.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>params</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="SpecimenParams (snailz.specimens.SpecimenParams)" href="#snailz.specimens.SpecimenParams">SpecimenParams</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>SpecimenParams with length attribute</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A randomly generated genome string of the specified length</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/snailz/specimens.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">_make_reference_genome</span><span class="p">(</span><span class="n">params</span><span class="p">:</span> <span class="n">SpecimenParams</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Make a random reference genome.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        params: SpecimenParams with length attribute</span>

<span class="sd">    Returns:</span>
<span class="sd">        A randomly generated genome string of the specified length</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">choices</span><span class="p">(</span><span class="n">BASES</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="n">params</span><span class="o">.</span><span class="n">length</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="snailz.specimens._mutate_mass" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">_mutate_mass</span><span class="p">(</span><span class="n">original</span><span class="p">,</span> <span class="n">mut_scale</span><span class="p">,</span> <span class="n">cell_value</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Mutate a single specimen's mass.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>original</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The original mass value</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>mut_scale</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Scaling factor for mutation effect</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>cell_value</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The grid cell value affecting the mutation</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The mutated mass value, rounded to PRECISION decimal places</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/snailz/specimens.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">_mutate_mass</span><span class="p">(</span><span class="n">original</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">mut_scale</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">cell_value</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Mutate a single specimen&#39;s mass.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        original: The original mass value</span>
<span class="sd">        mut_scale: Scaling factor for mutation effect</span>
<span class="sd">        cell_value: The grid cell value affecting the mutation</span>

<span class="sd">    Returns:</span>
<span class="sd">        The mutated mass value, rounded to PRECISION decimal places</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">round</span><span class="p">(</span><span class="n">original</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="n">mut_scale</span> <span class="o">*</span> <span class="n">cell_value</span><span class="p">)),</span> <span class="n">utils</span><span class="o">.</span><span class="n">PRECISION</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="snailz.specimens._place_specimens_on_grid" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">_place_specimens_on_grid</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="n">specimens</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Place specimens randomly on the grid, ensuring no two share the same cell.</p>
<p>Updates the site coordinates for each specimen.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>grid</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Grid (snailz.grid.Grid)" href="../grid/#snailz.grid.Grid">Grid</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A Grid object containing pollution values</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>specimens</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="AllSpecimens (snailz.specimens.AllSpecimens)" href="#snailz.specimens.AllSpecimens">AllSpecimens</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An AllSpecimens object with individuals to place on the grid</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/snailz/specimens.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">_place_specimens_on_grid</span><span class="p">(</span>
    <span class="n">grid</span><span class="p">:</span> <span class="n">Grid</span><span class="p">,</span>
    <span class="n">specimens</span><span class="p">:</span> <span class="n">AllSpecimens</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Place specimens randomly on the grid, ensuring no two share the same cell.</span>

<span class="sd">    Updates the site coordinates for each specimen.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        grid: A Grid object containing pollution values</span>
<span class="sd">        specimens: An AllSpecimens object with individuals to place on the grid</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">grid_size</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">grid</span><span class="p">)</span>
    <span class="n">locations</span> <span class="o">=</span> <span class="n">_make_locations</span><span class="p">(</span><span class="n">grid_size</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">specimens</span><span class="o">.</span><span class="n">individuals</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">indiv</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">specimens</span><span class="o">.</span><span class="n">individuals</span><span class="p">,</span> <span class="n">locations</span><span class="p">):</span>
        <span class="n">indiv</span><span class="o">.</span><span class="n">site</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span>
        <span class="n">indiv</span><span class="o">.</span><span class="n">site</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">y</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.c8b220af.min.js"></script>
      
    
  </body>
</html>