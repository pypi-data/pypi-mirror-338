[project]
name = "apispec-pydantic-plugin"
version = "0.7.0"
description = "A plugin to enable support for Pydantic models in APISpec."
authors = [{ name = "Kevin Kirsche", email = "kevin.kirsche@one.verizon.com" }]
readme = "README.md"
requires-python = ">=3.10"
dependencies = ["apispec>=6.6.1", "pydantic>=2.8.2"]

[project.urls]
repository = "https://github.com/kkirsche/apispec-pydantic-plugin"

[dependency-groups]
dev = ["codespell>=2.4.1", "mypy>=1.15.0", "pytest>=8.3.5", "ruff>=0.11.2"]

[build-system]
requires = ["hatchling"]
build-backend = "hatchling.build"

[tool.bandit]
exclude = ["/tests"]

[tool.pytest.ini_options]
addopts = "-ra --strict-markers --strict-config"
markers = []
minversion = "8.3"
testpaths = ["tests"]

[tool.pylint."MESSAGES CONTROL"]
disable = "C0330, C0326"
max_line_length = 88

[tool.mypy]
files = ["."]
follow_imports = "normal"
local_partial_types = true
plugins = ["pydantic.mypy"]
python_version = "3.10"
strict = true
warn_return_any = true
warn_unused_configs = true

[tool.pydantic-mypy]
init_forbid_extra = true
init_typed = true
warn_required_dynamic_aliases = true
warn_untyped_fields = true

[tool.ruff]
fix = true
indent-width = 4
line-length = 88
preview = true
target-version = "py310"

[tool.ruff.lint]
# https://docs.astral.sh/ruff/settings/#lint_select
# https://docs.astral.sh/ruff/rules/ defines what the select codes mean
# Last updated Friday, July 26, 2024
# Order of select matches the ruff rules page to make comparisons simpler
select = [
    "F",   # https://docs.astral.sh/ruff/rules/#pyflakes-f
    "E",   # https://docs.astral.sh/ruff/rules/#error-e
    "W",   # https://docs.astral.sh/ruff/rules/#warning-w
    "C90", # https://docs.astral.sh/ruff/rules/#mccabe-c90
    "I",   # https://docs.astral.sh/ruff/rules/#isort-i
    "N",   # https://docs.astral.sh/ruff/rules/#pep8-naming-n
    # "D", # https://docs.astral.sh/ruff/rules/#pydocstyle-d
    "UP",  # https://docs.astral.sh/ruff/rules/#pyupgrade-up
    "YTT", # https://docs.astral.sh/ruff/rules/#flake8-2020-ytt
    # "ANN", # https://docs.astral.sh/ruff/rules/#flake8-annotations-ann
    "ASYNC", # https://docs.astral.sh/ruff/rules/#flake8-async-async
    "S",     # https://docs.astral.sh/ruff/rules/#flake8-bandit-s
    "BLE",   # https://docs.astral.sh/ruff/rules/#flake8-blind-except-ble
    "FBT",   # https://docs.astral.sh/ruff/rules/#flake8-boolean-trap-fbt
    "B",     # https://docs.astral.sh/ruff/rules/#flake8-bugbear-b
    "A",     # https://docs.astral.sh/ruff/rules/#flake8-builtins-a
    # "COM", # https://docs.astral.sh/ruff/rules/#flake8-commas-com
    # "CPY", # https://docs.astral.sh/ruff/rules/#flake8-copyright-cpy
    "C4",  # https://docs.astral.sh/ruff/rules/#flake8-comprehensions-c4
    "DTZ", # https://docs.astral.sh/ruff/rules/#flake8-datetimez-dtz
    "T10", # https://docs.astral.sh/ruff/rules/#flake8-debugger-t10
    # "DJ", # https://docs.astral.sh/ruff/rules/#flake8-django-dj
    # "EM", # https://docs.astral.sh/ruff/rules/#flake8-errmsg-em
    "EXE",  # https://docs.astral.sh/ruff/rules/#flake8-executable-exe
    "FA",   # https://docs.astral.sh/ruff/rules/#flake8-future-annotations-fa
    "ISC",  # https://docs.astral.sh/ruff/rules/#flake8-implicit-str-concat-isc
    "ICN",  # https://docs.astral.sh/ruff/rules/#flake8-import-conventions-icn
    "LOG",  # https://docs.astral.sh/ruff/rules/#flake8-logging-log
    "G",    # https://docs.astral.sh/ruff/rules/#flake8-logging-format-g
    "INP",  # https://docs.astral.sh/ruff/rules/#flake8-no-pep420-inp
    "PIE",  # https://docs.astral.sh/ruff/rules/#flake8-pie-pie
    "T20",  # https://docs.astral.sh/ruff/rules/#flake8-print-t20
    "PYI",  # https://docs.astral.sh/ruff/rules/#flake8-pyi-pyi
    "PT",   # https://docs.astral.sh/ruff/rules/#flake8-pytest-style-pt
    "Q",    # https://docs.astral.sh/ruff/rules/#flake8-quotes-q
    "RSE",  # https://docs.astral.sh/ruff/rules/#flake8-raise-rse
    "RET",  # https://docs.astral.sh/ruff/rules/#flake8-return-ret
    "SLF",  # https://docs.astral.sh/ruff/rules/#flake8-self-slf
    "SLOT", # https://docs.astral.sh/ruff/rules/#flake8-slots-slot
    "SIM",  # https://docs.astral.sh/ruff/rules/#flake8-simplify-sim
    "TID",  # https://docs.astral.sh/ruff/rules/#flake8-tidy-imports-tid
    "INT",  # https://docs.astral.sh/ruff/rules/#flake8-gettext-int
    "ARG",  # https://docs.astral.sh/ruff/rules/#flake8-unused-arguments-arg
    "PTH",  # https://docs.astral.sh/ruff/rules/#flake8-use-pathlib-pth
    "TD",   # https://docs.astral.sh/ruff/rules/#flake8-todos-td
    "FIX",  # https://docs.astral.sh/ruff/rules/#flake8-fixme-fix
    # "ERA", # https://docs.astral.sh/ruff/rules/#eradicate-era
    # "PD", # https://docs.astral.sh/ruff/rules/#pandas-vet-pd
    "PGH", # https://docs.astral.sh/ruff/rules/#pygrep-hooks-pgh
    "PL",  # https://docs.astral.sh/ruff/rules/#pylint-pl
    # "PLC", # https://docs.astral.sh/ruff/rules/#convention-c
    # "PLE", # https://docs.astral.sh/ruff/rules/#error-e_1
    # "PLR", # https://docs.astral.sh/ruff/rules/#refactor-r
    # "PLW", # https://docs.astral.sh/ruff/rules/#warning-w_1
    "TRY", # https://docs.astral.sh/ruff/rules/#tryceratops-try
    "FLY", # https://docs.astral.sh/ruff/rules/#flynt-fly
    # "NPY", # https://docs.astral.sh/ruff/rules/#numpy-specific-rules-npy
    # "FAST", # https://docs.astral.sh/ruff/rules/#fastapi-fast
    # "AIR", # https://docs.astral.sh/ruff/rules/#airflow-air
    "PERF", # https://docs.astral.sh/ruff/rules/#perflint-perf
    "FURB", # https://docs.astral.sh/ruff/rules/#refurb-furb
    # "DOC",  # https://docs.astral.sh/ruff/rules/#pydoclint-doc
    "RUF", # https://docs.astral.sh/ruff/rules/#ruff-specific-rules-ruf
]
extend-ignore = [
    "TRY003",  # Avoid specifying long messages outside the exception class
    "PLR0913", # Too many arguments to function call (n > 5)
    "ISC001",  # doesn't work well with ruff formatter
]

[tool.ruff.lint.mccabe]
max-complexity = 15

[tool.ruff.lint.per-file-ignores]
"poetry-update-helper.py" = ["T201", "S404"]
"tests/**/*.py" = ["S101"]

[tool.ruff.format]
# Use Unix-style line endings.
line-ending = "lf"
docstring-code-format = true
