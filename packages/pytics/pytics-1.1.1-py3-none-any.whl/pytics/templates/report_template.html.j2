{% extends "base_template.html.j2" %}

{% block title %}DataFrame Profile Report{% endblock %}

{% block navigation %}
    <li><a href="#overview" class="active">Overview</a></li>
    <li><a href="#variables">Variables</a></li>
    <li><a href="#correlations">Correlations</a></li>
    <li><a href="#missing">Missing Values</a></li>
    <li><a href="#duplicates">Duplicates</a></li>
{% endblock %}

{% block content %}
    <div id="overview" class="section">
        <h2>Overview</h2>
        <div class="card">
            <h3>Dataset Information</h3>
            <table>
                <tr>
                    <th>Number of Variables</th>
                    <td>{{ n_vars }}</td>
                </tr>
                <tr>
                    <th>Number of Observations</th>
                    <td>{{ n_obs }}</td>
                </tr>
                <tr>
                    <th>Missing Cells</th>
                    <td>{{ n_missing }}</td>
                </tr>
                <tr>
                    <th>Missing Cells (%)</th>
                    <td>{{ missing_percent }}%</td>
                </tr>
                <tr>
                    <th>Duplicate Rows</th>
                    <td>{{ n_duplicates }}</td>
                </tr>
                <tr>
                    <th>Duplicate Rows (%)</th>
                    <td>{{ duplicates_percent }}%</td>
                </tr>
            </table>
        </div>
        
        <div class="card">
            <h3>Variable Types</h3>
            <table>
                <tr>
                    <th>Numeric</th>
                    <td>{{ n_numeric }}</td>
                </tr>
                <tr>
                    <th>Categorical</th>
                    <td>{{ n_categorical }}</td>
                </tr>
                <tr>
                    <th>Boolean</th>
                    <td>{{ n_boolean }}</td>
                </tr>
                <tr>
                    <th>Date</th>
                    <td>{{ n_date }}</td>
                </tr>
                <tr>
                    <th>Text</th>
                    <td>{{ n_text }}</td>
                </tr>
            </table>
        </div>
    </div>

    <div id="variables" class="section">
        <h2>Variables</h2>
        {% for var_name, var_data in variables.items() %}
            <div class="card">
                <h3>{{ var_name }}</h3>
                <table>
                    <tr>
                        <th>Type</th>
                        <td>{{ var_data.type }}</td>
                    </tr>
                    <tr>
                        <th>Missing</th>
                        <td>{{ var_data.missing }} ({{ var_data.missing_percent }}%)</td>
                    </tr>
                    <tr>
                        <th>Unique</th>
                        <td>{{ var_data.unique }} ({{ var_data.unique_percent }}%)</td>
                    </tr>
                    {% if var_data.type == 'Numeric' %}
                        <tr>
                            <th>Mean</th>
                            <td>{{ var_data.mean }}</td>
                        </tr>
                        <tr>
                            <th>Std Dev</th>
                            <td>{{ var_data.std }}</td>
                        </tr>
                        <tr>
                            <th>Min</th>
                            <td>{{ var_data.min }}</td>
                        </tr>
                        <tr>
                            <th>Q1</th>
                            <td>{{ var_data.q1 }}</td>
                        </tr>
                        <tr>
                            <th>Median</th>
                            <td>{{ var_data.median }}</td>
                        </tr>
                        <tr>
                            <th>Q3</th>
                            <td>{{ var_data.q3 }}</td>
                        </tr>
                        <tr>
                            <th>Max</th>
                            <td>{{ var_data.max }}</td>
                        </tr>
                    {% elif var_data.type == 'Categorical' %}
                        <tr>
                            <th>Top Values</th>
                            <td>
                                <ul>
                                    {% for value, count in var_data.top_values.items() %}
                                        <li>{{ value }}: {{ count }} ({{ (count / n_obs * 100)|round(2) }}%)</li>
                                    {% endfor %}
                                </ul>
                            </td>
                        </tr>
                    {% endif %}
                </table>
                
                <div class="plot-container">
                    {{ var_data.plot }}
                </div>
            </div>
        {% endfor %}
    </div>

    <div id="correlations" class="section">
        <h2>Correlations</h2>
        <div class="plot-container">
            {{ correlation_plot }}
        </div>
    </div>

    <div id="missing" class="section">
        <h2>Missing Values</h2>
        <div class="plot-container">
            {{ missing_plot }}
        </div>
    </div>

    <div id="duplicates" class="section">
        <h2>Duplicates</h2>
        {% if n_duplicates > 0 %}
            <div class="alert alert-warning">
                <strong>Warning:</strong> {{ n_duplicates }} duplicate rows found ({{ duplicates_percent }}% of data)
            </div>
            <div class="plot-container">
                {{ duplicates_plot }}
            </div>
        {% else %}
            <div class="alert alert-info">
                No duplicate rows found in the dataset.
            </div>
        {% endif %}
    </div>
{% endblock %} 