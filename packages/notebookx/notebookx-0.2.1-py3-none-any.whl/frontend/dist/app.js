(()=>{"use strict";var e=function(e,t,n,o){return new(n||(n=Promise))((function(c,i){function r(e){try{d(o.next(e))}catch(e){i(e)}}function a(e){try{d(o.throw(e))}catch(e){i(e)}}function d(e){var t;e.done?c(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,a)}d((o=o.apply(e,t||[])).next())}))};function t(e){return new URLSearchParams(window.location.search).get(e)||""}function n(){const e=document.getElementById("delete-button");e&&(e.disabled=!document.querySelector('input[type="checkbox"]:checked'))}document.addEventListener("DOMContentLoaded",(()=>e(void 0,void 0,void 0,(function*(){const o=t("path");try{const e=yield fetch(`/api/files?path=${encodeURIComponent(o)}`);!function(e,t){const o=document.getElementById("directory-container");if(!o)return;o.innerHTML="",o.className="directory-listing";const c=document.createDocumentFragment();if(t){const e=document.createElement("a");e.href=`/?path=${encodeURIComponent(t.split("/").slice(0,-1).join("/"))}`,e.textContent=".. (up)",e.className="up-link",c.appendChild(e),c.appendChild(document.createElement("br"))}const i=document.createElement("table");i.className="directory-table",i.appendChild(function(){const e=document.createElement("tr"),t=document.createElement("th"),o=document.createElement("input");return o.type="checkbox",o.addEventListener("change",(()=>{document.querySelectorAll('input[type="checkbox"]').forEach((e=>{e.checked=o.checked})),n()})),t.appendChild(o),e.appendChild(t),["Name","Type","Size (KB)","Last Modified"].forEach((t=>{const n=document.createElement("th");n.textContent=t,e.appendChild(n)})),e}()),e.forEach((e=>i.appendChild(function(e,t){const o=document.createElement("tr"),c=document.createElement("td"),i=document.createElement("input");i.type="checkbox",i.dataset.filepath=t?`${t}/${e.name}`:e.name,i.addEventListener("change",n),c.appendChild(i),o.appendChild(c);const r=document.createElement("td"),a=document.createElement("a");e.isDir?(a.href=`/?path=${encodeURIComponent(t?`${t}/${e.name}`:e.name)}`,a.textContent=`[DIR] ${e.name}`,a.className="dir-link"):(a.href=`/open/${encodeURIComponent(t?`${t}/${e.name}`:e.name)}`,a.textContent=e.name,a.className=e.name.endsWith(".ipynb")?"notebook-link":"file-link"),r.appendChild(a),o.appendChild(r);const d=document.createElement("td");d.textContent=e.type||"unknown",o.appendChild(d);const l=document.createElement("td");l.textContent=e.size?(e.size/1024).toFixed(2):"-",o.appendChild(l);const s=document.createElement("td");return s.textContent=e.lastModified?new Date(1e3*e.lastModified).toLocaleString():"-",o.appendChild(s),o}(e,t)))),c.appendChild(i),o.appendChild(c)}((yield e.json()).children,o)}catch(e){console.error("Error loading directory:",e)}const c=document.getElementById("delete-button");c&&c.addEventListener("click",(()=>e(void 0,void 0,void 0,(function*(){const e=Array.from(document.querySelectorAll('input[type="checkbox"]:checked')).map((e=>e.dataset.filepath));if(e.length&&confirm(`Are you sure you want to delete ${e.length} files?`))try{if(!(yield fetch("/api/delete_files",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({files:e})})).ok)throw new Error("Failed to delete files");location.reload()}catch(e){console.error("Error deleting files:",e),alert("Error deleting files")}}))))}))));document.addEventListener("DOMContentLoaded",(()=>{return e=void 0,n=void 0,c=function*(){var e;const n=t("path")||"",o=document.getElementById("python-version"),c=document.getElementById("pip-version");if(null===(e=document.getElementById("new-notebook-btn"))||void 0===e||e.addEventListener("click",(()=>{!function(e){var t,n,o,c;t=this,n=void 0,c=function*(){var t;let n=null===(t=prompt("Enter the name of the new notebook"))||void 0===t?void 0:t.trim();if(!n)return;n=n.replace(/[^a-zA-Z0-9 ]/g,"").replace(/\s+/g,"_"),n+=".ipynb";const o=e?`${e}/${n}`:n;try{const e=yield fetch(`/api/notebook/create?path=${encodeURIComponent(o)}`,{method:"POST"});if(!e.ok)throw new Error((yield e.json()).message||"Failed to create notebook");location.reload()}catch(e){console.error("Failed to create notebook:",e),alert(e instanceof Error?e.message:"Failed to create notebook. Please try again.")}},new((o=void 0)||(o=Promise))((function(e,i){function r(e){try{d(c.next(e))}catch(e){i(e)}}function a(e){try{d(c.throw(e))}catch(e){i(e)}}function d(t){var n;t.done?e(t.value):(n=t.value,n instanceof o?n:new o((function(e){e(n)}))).then(r,a)}d((c=c.apply(t,n||[])).next())}))}(n)})),o&&c)try{const e=yield fetch("/api/packages"),t=yield e.json();o.textContent=t.python_version,c.textContent=t.pip_version}catch(e){console.error("Error fetching version info:",e),o.textContent="Python: error",c.textContent="pip: error"}},new((o=void 0)||(o=Promise))((function(t,i){function r(e){try{d(c.next(e))}catch(e){i(e)}}function a(e){try{d(c.throw(e))}catch(e){i(e)}}function d(e){var n;e.done?t(e.value):(n=e.value,n instanceof o?n:new o((function(e){e(n)}))).then(r,a)}d((c=c.apply(e,n||[])).next())}));var e,n,o,c}))})();