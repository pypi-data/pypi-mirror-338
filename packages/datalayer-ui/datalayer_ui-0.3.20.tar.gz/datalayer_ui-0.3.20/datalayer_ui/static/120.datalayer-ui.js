"use strict";(self.webpackChunk_datalayer_ui=self.webpackChunk_datalayer_ui||[]).push([[120,9882,3303],{6143:(e,t,n)=>{n.r(t),n.d(t,{ExerciseNew:()=>P,default:()=>k});var r=n(9387),s=n(97096),i=n(98754),a=n(88996),o=n(48371),c=n(64664),d=n(47785),l=n(77672),p=n(76818),u=n(99180),h=n(38621),_=n(5907),x=n(55388),m=n(63222),j=n(95993);function g(e){const t=j(e);if(0===t)return e;const n=new RegExp(`^[ \\t]{${t}}`,"gm");return e.replace(n,"")}var y=n(68914),A=n(17810),T=n(23530),b=n(97734),f=n(53850),E=n(53564),v=n(50906),w=n(320),C=n(18683);const P=()=>{const e=(0,A.J)(),t=(0,v.mt)(),n=(0,w._O)(),j=(0,x.LC)(),P=(0,T.Z)(),{enqueueToast:k}=(0,b.d)(),{kernelManager:M,defaultKernel:I}=(0,_.PD)(),S=t.layout().leftSidebarVariant,O=t.layout().organization,R=t.layout().space,D=(0,r.useMemo)((()=>I),[M]),{getSpaceDatasets:$,refreshSpaceDatasets:J}=(0,f.E)(),[L,F]=(0,r.useState)($()),N=j.outputs?.get("exercise-pre")?.input,q=j.outputs?.get("exercise-solution")?.input,V=j.outputs?.get("exercise-question")?.input,Y=j.outputs?.get("exercise-test")?.input,[z,B]=(0,r.useState)({name:void 0,description:void 0,help:'Use the assignment operator "=" to create the variable "x".'}),[W,K]=(0,r.useState)({name:void 0,description:void 0,help:!0});(0,r.useEffect)((()=>{R&&J(R,O).then((e=>{e.success&&F($())}))}),[R]),(0,r.useEffect)((()=>{K({...W,name:void 0===z.name?void 0:z.name.length>2,description:void 0===z.description?void 0:z.description.length>2,help:void 0===z.help?void 0:z.help.length>2})}),[z]);const{isLoading:U,isSuccess:X,uploadAndSubmit:Q,progress:H}=(0,E.P)(`${n.configuration.spacerRunUrl}/api/spacer/v1/exercises`);return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(s.z,{children:(0,C.jsx)(s.z.TitleArea,{variant:"large",children:(0,C.jsx)(s.z.Title,{children:"New Exercise"})})}),(0,C.jsxs)(i.A,{children:[(0,C.jsxs)(i.A,{sx:{label:{marginTop:2},"label + span":{marginBottom:2}},children:[(0,C.jsxs)(a.A,{children:[(0,C.jsx)(a.A.Label,{children:"Name"}),(0,C.jsx)(a.A.Caption,{children:"Name of the exercise."}),(0,C.jsx)(o.A,{block:!0,value:z.name,onChange:e=>{B((t=>({...t,name:e.target.value})))}}),!1===W.name&&(0,C.jsx)(a.A.Validation,{variant:"error",children:"Name must have more than 2 characters."})]}),(0,C.jsxs)(a.A,{children:[(0,C.jsx)(a.A.Label,{children:"Description"}),(0,C.jsx)(a.A.Caption,{children:"Description of the exercise."}),(0,C.jsx)(c.Ay,{block:!0,value:z.description,onChange:e=>{B((t=>({...t,description:e.target.value})))}}),!1===W.description&&(0,C.jsx)(a.A.Validation,{variant:"error",children:"Description must have more than 2 characters."})]}),(0,C.jsxs)(i.A,{display:"grid",gridTemplateColumns:"1fr 1fr",sx:{gap:3},children:[(0,C.jsxs)(i.A,{children:[(0,C.jsxs)(a.A,{children:[(0,C.jsx)(a.A.Label,{children:"Preliminary code"}),(0,C.jsx)(a.A.Caption,{children:"This is the preliminary code that will be run before the exercise is taken."})]}),(0,C.jsx)(m.k,{showEditor:!0,autoRun:!0,kernel:D,code:"# Insert your preliminary code here.",id:"exercise-pre"})]}),(0,C.jsxs)(i.A,{children:[(0,C.jsxs)(a.A,{children:[(0,C.jsx)(a.A.Label,{children:"Datasets"}),(0,C.jsx)(a.A.Caption,{children:"Select the datasets to be used in the prelimary code."})]}),(0,C.jsx)(d.l,{showDividers:!0,role:"listbox","aria-label":"Select assignees",children:L.map((e=>(0,C.jsxs)(d.l.Item,{role:"option",onClick:t=>{t.preventDefault(),j.setDataset("exercise-pre",e)},children:[(0,C.jsx)(d.l.LeadingVisual,{children:(0,C.jsx)(h.bN0,{})}),e.name,(0,C.jsxs)(d.l.Description,{children:[e.mimeType," ",(0,y.b)(e.description)]})]},e.id)))})]})]}),(0,C.jsxs)(a.A,{children:[(0,C.jsx)(a.A.Label,{children:"Solution Code"}),(0,C.jsx)(a.A.Caption,{children:"This is the expected solution code. The student will never see this content."})]}),(0,C.jsx)(m.k,{showEditor:!0,autoRun:!0,kernel:D,id:"exercise-solution",code:"# Create a variable x, equals to 3.\nx = 3\n\n# Print x.\nprint(x)"}),(0,C.jsxs)(a.A,{children:[(0,C.jsx)(a.A.Label,{children:"Question code"}),(0,C.jsx)(a.A.Caption,{children:"This the question code that will be shown to the student."})]}),(0,C.jsx)(m.k,{showEditor:!0,autoRun:!1,kernel:D,id:"exercise-question",code:g("# Create a variable x, equals to 3.\n...\n\n# Print x.\n...\n").trim()}),(0,C.jsx)(i.A,{children:(0,C.jsxs)(a.A,{children:[(0,C.jsx)(a.A.Label,{children:"Help for the student"}),(0,C.jsx)(a.A.Caption,{children:"This a help that will be shown to the student if he asks for it."}),(0,C.jsx)(c.Ay,{block:!0,value:z.help,onChange:e=>{B((t=>({...t,help:e.target.value})))}}),!1===W.help&&(0,C.jsx)(a.A.Validation,{variant:"error",children:"Help must have more than 2 characters"})]})}),(0,C.jsxs)(a.A,{children:[(0,C.jsx)(a.A.Label,{children:"Test the Solution code"}),(0,C.jsxs)(a.A.Caption,{children:["Write the test code that will be run on the student's code during the exercise. Please refer to the ",(0,C.jsx)(l.A,{href:"https://nbgrader.readthedocs.io/en/latest/user_guide/autograding_resources.html",target:"_blank",children:"nbgrader"})," documentation."]})]}),(0,C.jsx)(m.k,{showEditor:!0,autoRun:!1,disableRun:!0,kernel:D,id:"exercise-test",code:'Ex().check_object("x")\nEx().check_object("x").has_equal_value()\nEx().has_output("3")\nprint(\'Congratulations. You have successfully passed this exercise.\')'})]}),(0,C.jsx)(p.A,{as:"p",color:"fg.onEmphasis",bg:"neutral.emphasis",p:2,children:'Validate you tests with this button. It will run the "Preliminary code", then will run the "Test code" on the "Solution code". When a student will take the exercise, the "Test code" will be run on the "Student code".'}),(0,C.jsx)(u.Q,{variant:"danger",leadingVisual:h.Qvf,sx:{marginTop:2,marginBottom:2},onClick:e=>{e.preventDefault(),j.setExecuteRequest("exercise-test",`\nsetup_state(stu_code = """${N}\n${q}""", sol_code = """${N}\n${q}""")\n${Y}\n`)},children:"Test"}),(0,C.jsx)(p.A,{as:"p",color:"fg.onEmphasis",bg:"neutral.emphasis",p:2,children:"Once you are confident with your test, you can create the exercise. Don't worry, you can still update it before making it public."}),(0,C.jsx)(u.Q,{variant:"primary",disabled:U||!W.name||!W.description,sx:{marginTop:2},onClick:async()=>{const n=new FormData;n.append("name",z.name),n.append("description",z.description),n.append("help",z.help),n.append("codePre",N??""),n.append("codeSolution",q??""),n.append("codeQuestion",V??""),n.append("codeTest",Y??""),n.append("accountType","organization-space"===S?"organization":"user"),n.append("accountId","organization-space"===S?O?.id:e?.id),n.append("spaceId",R?.id),Q(n).then((n=>{n.success&&(k("The exercise has been created.",{variant:"success"}),"organization"===S||"organization-space"===S?(P(`/${O?.handle}/${R?.handle}/exercises/${n.exercise.uid}`),t.layout().triggerItemsRefresh()):P(`/${e?.handle}/${R?.handle}/exercises`))}))},children:"Create an exercise"})]})]})},k=P},5190:(e,t,n)=>{n.d(t,{l:()=>o});let r="https://cdn.jsdelivr.net/npm/",s=!0;const i=document.getElementsByTagName("script");Array.prototype.forEach.call(i,(e=>{r=e.getAttribute("data-jupyter-widgets-cdn")||r,s=s&&Boolean(e.getAttribute("data-jupyter-widgets-cdn-only"))}));const a=function(e){return new Promise(((t,n)=>{const r=window.requirejs;void 0===r?n("Requirejs is needed, please ensure it is loaded on the page."):r(e,t,n)}))};function o(e,t){const n=window.requirejs;if(void 0===n)throw new Error("Requirejs is needed, please ensure it is loaded on the page.");function i(){const s={paths:{}};return s.paths[e]=function(e,t){let n=e,s="index",i=e.indexOf("/");return-1!=i&&"@"==e[0]&&(i=e.indexOf("/",i+1)),-1!=i&&(s=e.substr(i+1),n=e.substr(0,i)),"@widgetti/jupyter-react"===n&&(t=t.replace("0.4.2","0.4.1")),`${r}${n}@${t}/dist/${s}`}(e,t),n.config(s),a([`${e}`])}return s?(console.log(`Loading from ${r} for ${e}@${t}`),i()):a([`${e}`]).catch((s=>{const a=s.requireModules&&s.requireModules[0];if(a)return n.undef(a),console.log(`Falling back to ${r} for ${e}@${t}`),i()}))}},16608:(e,t,n)=>{n.d(t,{s:()=>r});const r="application/vnd.jupyter.widget-state+json"},48319:(e,t,n)=>{n.d(t,{R:()=>s});var r=n(97164);class s{set(e,t,n){e in this._cache||(this._cache[e]=Object.create(null)),t in this._cache[e]?console.warn(`Version ${t} of key ${e} already registered.`):this._cache[e][t]=n}get(e,t){if(e in this._cache){const n=this._cache[e],s=(0,r.maxSatisfying)(Object.keys(n),t);if(null!==s)return n[s]}}getAllVersions(e){if(e in this._cache)return this._cache[e]}_cache=Object.create(null)}},69882:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{APPLICATION_JAVASCRIPT_MIMETYPE:()=>APPLICATION_JAVASCRIPT_MIMETYPE,ExperimentalRenderedJavascript:()=>ExperimentalRenderedJavascript,TEXT_JAVASCRIPT_MIMETYPE:()=>TEXT_JAVASCRIPT_MIMETYPE,default:()=>__WEBPACK_DEFAULT_EXPORT__,rendererFactory:()=>rendererFactory});var _jupyterlab_rendermime__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(54704);const TEXT_JAVASCRIPT_MIMETYPE="text/javascript",APPLICATION_JAVASCRIPT_MIMETYPE="application/javascript";function evalInContext(code,element,document,window){return eval(code)}class ExperimentalRenderedJavascript extends _jupyterlab_rendermime__WEBPACK_IMPORTED_MODULE_0__.TS{render(e){const t=this.translator.load("jupyterlab"),n=()=>{try{const t=e.data[this.mimeType];return t&&evalInContext(t,this.node,document,window),Promise.resolve()}catch(e){return Promise.reject(e)}};if(!e.trusted){const e=document.createElement("pre");e.textContent=t.__("Are you sure that you want to run arbitrary Javascript within your JupyterLab session?");const r=document.createElement("button");return r.textContent=t.__("Run"),this.node.appendChild(e),this.node.appendChild(r),r.onclick=e=>{this.node.textContent="",n()},Promise.resolve()}return n()}}const rendererFactory={safe:!1,mimeTypes:[TEXT_JAVASCRIPT_MIMETYPE,APPLICATION_JAVASCRIPT_MIMETYPE],createRenderer:e=>new ExperimentalRenderedJavascript(e)},extension={id:"@jupyterlab/javascript-extension:factory",description:"Adds renderer for JavaScript content.",rendererFactory,rank:0,dataType:"string"},__WEBPACK_DEFAULT_EXPORT__=extension},83303:(e,t,n)=>{n.r(t),n.d(t,{MIME_TYPE:()=>c,MIME_TYPES_JSONL:()=>d,RenderedJSON:()=>l,default:()=>u,rendererFactory:()=>p});var r=n(30808),s=n(85181),i=n(14809),a=n(9387),o=n(72447);const c="application/json",d=["text/jsonl","application/jsonl","application/json-lines"];class l extends i.x0{constructor(e){super(),this._rootDOM=null,this.addClass("jp-RenderedJSON"),this.addClass("CodeMirror"),this._mimeType=e.mimeType,this.translator=e.translator||s.wK}[r._.symbol](){return()=>r._.printWidget(this)}async renderModel(e){const{Component:t}=await n.e(1671).then(n.bind(n,74052));let r;if(d.indexOf(this._mimeType)>=0){const t=(e.data[this._mimeType]||"").trim().split(/\n/);r=JSON.parse(`[${t.join(",")}]`)}else r=e.data[this._mimeType]||{};const s=e.metadata[this._mimeType]||{};return null===this._rootDOM&&(this._rootDOM=(0,o.H)(this.node)),new Promise(((e,n)=>{this._rootDOM.render(a.createElement(t,{data:r,metadata:s,translator:this.translator,forwardedRef:()=>e()}))}))}onBeforeDetach(e){this._rootDOM&&(this._rootDOM.unmount(),this._rootDOM=null)}}const p={safe:!0,mimeTypes:[c,...d],createRenderer:e=>new l(e)},u=[{id:"@jupyterlab/json-extension:factory",description:"Adds renderer for JSON content.",rendererFactory:p,rank:0,dataType:"json",documentWidgetFactoryOptions:{name:"JSON",primaryFileType:"json",fileTypes:["json","notebook","geojson"],defaultFor:["json"]}},{id:"@jupyterlab/json-lines-extension:factory",description:"Adds renderer for JSONLines content.",rendererFactory:p,rank:0,dataType:"string",documentWidgetFactoryOptions:{name:"JSONLines",primaryFileType:"jsonl",fileTypes:["jsonl","ndjson"],defaultFor:["jsonl","ndjson"]}}]},95993:e=>{e.exports=e=>{const t=e.match(/^[ \t]*(?=\S)/gm);return t?t.reduce(((e,t)=>Math.min(e,t.length)),1/0):0}}}]);