#!/bin/bash -l
#
#SBATCH --array=1-12
#SBATCH --time=1
#SBATCH --nodes=1 # Number of nodes to use simultaneously
#SBATCH --exclusive=user # Exclusive access to computing node by user
#SBATCH --ntasks-per-core=1  # i.e. HyperThreading disabled
#SBATCH --mem-per-cpu=1G
#SBATCH --ntasks-per-node=12
#SBATCH --cpus-per-task=1
#SBATCH --partition=all
##SBATCH --constraint=mc
###SBATCH --output=/dev/null
###SBATCH --account=uzh10
####SBATCH --output=job.s$jobseed.out  
####SBATCH --error=job.s$jobseed.err

#> Determine starting and ending seed
SEED_FIRST=$(( $SLURM_ARRAY_TASK_ID*$SLURM_NTASKS_PER_NODE + $SLURM_NTASKS_PER_NODE/$SLURM_CPUS_ON_NODE ))
SEED_LAST=$(( $SEED_FIRST + $SLURM_NTASKS_PER_NODE - 1 ))

# #> Change to working folder
#cd id_folder

#> Submit jobs
for SEED in `seq $SEED_FIRST $SEED_LAST`; do
    ./NNLOJET.sh $SEED &
done

#> Wait for all instances in a given array to finish
wait
