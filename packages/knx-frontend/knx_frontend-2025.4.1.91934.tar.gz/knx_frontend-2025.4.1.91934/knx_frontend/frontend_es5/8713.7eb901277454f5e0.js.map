{"version":3,"file":"8713.7eb901277454f5e0.js","sources":["webpack://knx-frontend/./homeassistant-frontend/src/components/ha-selector/ha-selector-tts-voice.ts","webpack://knx-frontend/./homeassistant-frontend/src/components/ha-tts-voice-picker.ts","webpack://knx-frontend/./homeassistant-frontend/src/data/tts.ts"],"sourcesContent":["import { css, html, LitElement } from \"lit\";\nimport { customElement, property } from \"lit/decorators\";\nimport type { TTSVoiceSelector } from \"../../data/selector\";\nimport type { HomeAssistant } from \"../../types\";\nimport \"../ha-tts-voice-picker\";\n\n@customElement(\"ha-selector-tts_voice\")\nexport class HaTTSVoiceSelector extends LitElement {\n  @property({ attribute: false }) public hass!: HomeAssistant;\n\n  @property({ attribute: false }) public selector!: TTSVoiceSelector;\n\n  @property() public value?: any;\n\n  @property() public label?: string;\n\n  @property() public helper?: string;\n\n  @property({ type: Boolean }) public disabled = false;\n\n  @property({ type: Boolean }) public required = true;\n\n  @property({ attribute: false }) public context?: {\n    language?: string;\n    engineId?: string;\n  };\n\n  protected render() {\n    return html`<ha-tts-voice-picker\n      .hass=${this.hass}\n      .value=${this.value}\n      .label=${this.label}\n      .helper=${this.helper}\n      .language=${this.selector.tts_voice?.language || this.context?.language}\n      .engineId=${this.selector.tts_voice?.engineId || this.context?.engineId}\n      .disabled=${this.disabled}\n      .required=${this.required}\n    ></ha-tts-voice-picker>`;\n  }\n\n  static styles = css`\n    ha-tts-picker {\n      width: 100%;\n    }\n  `;\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"ha-selector-tts_voice\": HaTTSVoiceSelector;\n  }\n}\n","import type { PropertyValues } from \"lit\";\nimport { css, html, LitElement, nothing } from \"lit\";\nimport { customElement, property, query, state } from \"lit/decorators\";\nimport { fireEvent } from \"../common/dom/fire_event\";\nimport { stopPropagation } from \"../common/dom/stop_propagation\";\nimport { debounce } from \"../common/util/debounce\";\nimport type { TTSVoice } from \"../data/tts\";\nimport { listTTSVoices } from \"../data/tts\";\nimport type { HomeAssistant } from \"../types\";\nimport \"./ha-list-item\";\nimport \"./ha-select\";\nimport type { HaSelect } from \"./ha-select\";\n\nconst NONE = \"__NONE_OPTION__\";\n\n@customElement(\"ha-tts-voice-picker\")\nexport class HaTTSVoicePicker extends LitElement {\n  @property() public value?: string;\n\n  @property() public label?: string;\n\n  @property({ attribute: false }) public engineId?: string;\n\n  @property() public language?: string;\n\n  @property({ attribute: false }) public hass!: HomeAssistant;\n\n  @property({ type: Boolean, reflect: true }) public disabled = false;\n\n  @property({ type: Boolean }) public required = false;\n\n  @state() _voices?: TTSVoice[] | null;\n\n  @query(\"ha-select\") private _select?: HaSelect;\n\n  protected render() {\n    if (!this._voices) {\n      return nothing;\n    }\n    const value =\n      this.value ?? (this.required ? this._voices[0]?.voice_id : NONE);\n    return html`\n      <ha-select\n        .label=${this.label ||\n        this.hass!.localize(\"ui.components.tts-voice-picker.voice\")}\n        .value=${value}\n        .required=${this.required}\n        .disabled=${this.disabled}\n        @selected=${this._changed}\n        @closed=${stopPropagation}\n        fixedMenuPosition\n        naturalMenuWidth\n      >\n        ${!this.required\n          ? html`<ha-list-item .value=${NONE}>\n              ${this.hass!.localize(\"ui.components.tts-voice-picker.none\")}\n            </ha-list-item>`\n          : nothing}\n        ${this._voices.map(\n          (voice) =>\n            html`<ha-list-item .value=${voice.voice_id}>\n              ${voice.name}\n            </ha-list-item>`\n        )}\n      </ha-select>\n    `;\n  }\n\n  protected willUpdate(changedProperties: PropertyValues<this>): void {\n    super.willUpdate(changedProperties);\n    if (!this.hasUpdated) {\n      this._updateVoices();\n    } else if (\n      changedProperties.has(\"language\") ||\n      changedProperties.has(\"engineId\")\n    ) {\n      this._debouncedUpdateVoices();\n    }\n  }\n\n  private _debouncedUpdateVoices = debounce(() => this._updateVoices(), 500);\n\n  private async _updateVoices() {\n    if (!this.engineId || !this.language) {\n      this._voices = undefined;\n      return;\n    }\n    this._voices = (\n      await listTTSVoices(this.hass, this.engineId, this.language)\n    ).voices;\n\n    if (!this.value) {\n      return;\n    }\n\n    if (\n      !this._voices ||\n      !this._voices.find((voice) => voice.voice_id === this.value)\n    ) {\n      this.value = undefined;\n      fireEvent(this, \"value-changed\", { value: this.value });\n    }\n  }\n\n  protected updated(changedProperties: PropertyValues<this>) {\n    super.updated(changedProperties);\n    if (\n      changedProperties.has(\"_voices\") &&\n      this._select?.value !== this.value\n    ) {\n      this._select?.layoutOptions();\n      fireEvent(this, \"value-changed\", { value: this._select?.value });\n    }\n  }\n\n  static styles = css`\n    ha-select {\n      width: 100%;\n    }\n  `;\n\n  private _changed(ev): void {\n    const target = ev.target as HaSelect;\n    if (\n      !this.hass ||\n      target.value === \"\" ||\n      target.value === this.value ||\n      (this.value === undefined && target.value === NONE)\n    ) {\n      return;\n    }\n    this.value = target.value === NONE ? undefined : target.value;\n    fireEvent(this, \"value-changed\", { value: this.value });\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"ha-tts-voice-picker\": HaTTSVoicePicker;\n  }\n}\n","import type { HomeAssistant } from \"../types\";\n\nexport interface TTSEngine {\n  engine_id: string;\n  supported_languages?: string[];\n  name?: string;\n  deprecated: boolean;\n}\n\nexport interface TTSVoice {\n  voice_id: string;\n  name: string;\n}\n\nexport const convertTextToSpeech = (\n  hass: HomeAssistant,\n  data: {\n    platform: string;\n    message: string;\n    cache?: boolean;\n    language?: string;\n    options?: Record<string, unknown>;\n  }\n) => hass.callApi<{ url: string; path: string }>(\"POST\", \"tts_get_url\", data);\n\nconst TTS_MEDIA_SOURCE_PREFIX = \"media-source://tts/\";\n\nexport const isTTSMediaSource = (mediaContentId: string) =>\n  mediaContentId.startsWith(TTS_MEDIA_SOURCE_PREFIX);\n\nexport const getProviderFromTTSMediaSource = (mediaContentId: string) =>\n  mediaContentId.substring(TTS_MEDIA_SOURCE_PREFIX.length);\n\nexport const listTTSEngines = (\n  hass: HomeAssistant,\n  language?: string,\n  country?: string\n): Promise<{ providers: TTSEngine[] }> =>\n  hass.callWS({\n    type: \"tts/engine/list\",\n    language,\n    country,\n  });\n\nexport const getTTSEngine = (\n  hass: HomeAssistant,\n  engine_id: string\n): Promise<{ provider: TTSEngine }> =>\n  hass.callWS({\n    type: \"tts/engine/get\",\n    engine_id,\n  });\n\nexport const listTTSVoices = (\n  hass: HomeAssistant,\n  engine_id: string,\n  language: string\n): Promise<{ voices: TTSVoice[] | null }> =>\n  hass.callWS({\n    type: \"tts/engine/voices\",\n    engine_id,\n    language,\n  });\n"],"names":["HaTTSVoiceSelector","_decorate","customElement","_initialize","_LitElement","F","constructor","args","d","kind","decorators","property","attribute","key","value","type","Boolean","_this$selector$tts_vo","_this$context","_this$selector$tts_vo2","_this$context2","html","_t","_","this","hass","label","helper","selector","tts_voice","language","context","engineId","disabled","required","static","css","_t2","LitElement","NONE","HaTTSVoicePicker","reflect","state","query","_this$value","_this$_voices$","_voices","nothing","voice_id","localize","_changed","stopPropagation","map","voice","_t3","name","changedProperties","_superPropGet","hasUpdated","has","_debouncedUpdateVoices","_updateVoices","debounce","listTTSVoices","voices","find","undefined","fireEvent","_this$_select","_this$_select2","_this$_select3","_select","layoutOptions","_t4","ev","target","convertTextToSpeech","data","callApi","TTS_MEDIA_SOURCE_PREFIX","isTTSMediaSource","mediaContentId","startsWith","getProviderFromTTSMediaSource","substring","listTTSEngines","country","callWS","getTTSEngine","engine_id"],"mappings":"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"}