{"version":3,"file":"9375.4888213295cec296.js","sources":["webpack://knx-frontend/./homeassistant-frontend/src/components/ha-check-list-item.ts","webpack://knx-frontend/./homeassistant-frontend/src/components/ha-tip.ts","webpack://knx-frontend/./homeassistant-frontend/src/components/media-player/dialog-media-manage.ts","webpack://knx-frontend/./homeassistant-frontend/src/components/media-player/ha-media-upload-button.ts","webpack://knx-frontend/./homeassistant-frontend/src/data/image_upload.ts"],"sourcesContent":["import { css } from \"lit\";\nimport { CheckListItemBase } from \"@material/mwc-list/mwc-check-list-item-base\";\nimport { styles as controlStyles } from \"@material/mwc-list/mwc-control-list-item.css\";\nimport { styles } from \"@material/mwc-list/mwc-list-item.css\";\nimport { customElement } from \"lit/decorators\";\nimport { fireEvent } from \"../common/dom/fire_event\";\n\n@customElement(\"ha-check-list-item\")\nexport class HaCheckListItem extends CheckListItemBase {\n  async onChange(event) {\n    super.onChange(event);\n    fireEvent(this, event.type);\n  }\n\n  static override styles = [\n    styles,\n    controlStyles,\n    css`\n      :host {\n        --mdc-theme-secondary: var(--primary-color);\n      }\n\n      :host([graphic=\"avatar\"]) .mdc-deprecated-list-item__graphic,\n      :host([graphic=\"medium\"]) .mdc-deprecated-list-item__graphic,\n      :host([graphic=\"large\"]) .mdc-deprecated-list-item__graphic,\n      :host([graphic=\"control\"]) .mdc-deprecated-list-item__graphic {\n        margin-inline-end: var(--mdc-list-item-graphic-margin, 16px);\n        margin-inline-start: 0px;\n        direction: var(--direction);\n      }\n      .mdc-deprecated-list-item__meta {\n        flex-shrink: 0;\n        direction: var(--direction);\n        margin-inline-start: auto;\n        margin-inline-end: 0;\n      }\n      .mdc-deprecated-list-item__graphic {\n        margin-top: var(--check-list-item-graphic-margin-top);\n      }\n      :host([graphic=\"icon\"]) .mdc-deprecated-list-item__graphic {\n        margin-inline-start: 0;\n        margin-inline-end: var(--mdc-list-item-graphic-margin, 32px);\n      }\n    `,\n  ];\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"ha-check-list-item\": HaCheckListItem;\n  }\n}\n","import { mdiLightbulbOutline } from \"@mdi/js\";\nimport { css, html, LitElement, nothing } from \"lit\";\nimport { customElement, property } from \"lit/decorators\";\nimport type { HomeAssistant } from \"../types\";\n\nimport \"./ha-svg-icon\";\n\n@customElement(\"ha-tip\")\nclass HaTip extends LitElement {\n  @property({ attribute: false }) public hass!: HomeAssistant;\n\n  public render() {\n    if (!this.hass) {\n      return nothing;\n    }\n\n    return html`\n      <ha-svg-icon .path=${mdiLightbulbOutline}></ha-svg-icon>\n      <span class=\"prefix\"\n        >${this.hass.localize(\"ui.panel.config.tips.tip\")}</span\n      >\n      <span class=\"text\"><slot></slot></span>\n    `;\n  }\n\n  static styles = css`\n    :host {\n      display: block;\n      text-align: center;\n    }\n\n    .text {\n      direction: var(--direction);\n      margin-left: 2px;\n      margin-inline-start: 2px;\n      margin-inline-end: initial;\n      color: var(--secondary-text-color);\n    }\n\n    .prefix {\n      font-weight: 500;\n    }\n  `;\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"ha-tip\": HaTip;\n  }\n}\n","import { animate } from \"@lit-labs/motion\";\nimport \"@material/mwc-list/mwc-list\";\nimport \"@material/mwc-list/mwc-list-item\";\nimport { mdiClose, mdiDelete } from \"@mdi/js\";\nimport type { CSSResultGroup } from \"lit\";\nimport { css, html, LitElement, nothing } from \"lit\";\nimport { customElement, property, state } from \"lit/decorators\";\nimport { repeat } from \"lit/directives/repeat\";\nimport { fireEvent } from \"../../common/dom/fire_event\";\nimport { computeRTLDirection } from \"../../common/util/compute_rtl\";\nimport type { MediaPlayerItem } from \"../../data/media-player\";\nimport { MediaClassBrowserSettings } from \"../../data/media-player\";\nimport {\n  browseLocalMediaPlayer,\n  removeLocalMedia,\n  isLocalMediaSourceContentId,\n  isImageUploadMediaSourceContentId,\n} from \"../../data/media_source\";\nimport { deleteImage, getIdFromUrl } from \"../../data/image_upload\";\nimport { showConfirmationDialog } from \"../../dialogs/generic/show-dialog-box\";\nimport { haStyleDialog } from \"../../resources/styles\";\nimport type { HomeAssistant } from \"../../types\";\nimport \"../ha-button\";\nimport \"../ha-check-list-item\";\nimport \"../ha-spinner\";\nimport \"../ha-dialog\";\nimport \"../ha-dialog-header\";\nimport \"../ha-svg-icon\";\nimport \"../ha-tip\";\nimport \"./ha-media-player-browse\";\nimport \"./ha-media-upload-button\";\nimport type { MediaManageDialogParams } from \"./show-media-manage-dialog\";\nimport { isComponentLoaded } from \"../../common/config/is_component_loaded\";\n\n@customElement(\"dialog-media-manage\")\nclass DialogMediaManage extends LitElement {\n  @property({ attribute: false }) public hass!: HomeAssistant;\n\n  @state() private _currentItem?: MediaPlayerItem;\n\n  @state() private _params?: MediaManageDialogParams;\n\n  @state() private _uploading = false;\n\n  @state() private _deleting = false;\n\n  @state() private _selected = new Set<number>();\n\n  private _filesChanged = false;\n\n  public showDialog(params: MediaManageDialogParams): void {\n    this._params = params;\n    this._refreshMedia();\n  }\n\n  public closeDialog() {\n    if (this._filesChanged && this._params!.onClose) {\n      this._params!.onClose();\n    }\n    this._params = undefined;\n    this._currentItem = undefined;\n    this._uploading = false;\n    this._deleting = false;\n    this._filesChanged = false;\n    fireEvent(this, \"dialog-closed\", { dialog: this.localName });\n  }\n\n  protected render() {\n    if (!this._params) {\n      return nothing;\n    }\n\n    const children =\n      this._currentItem?.children?.filter((child) => !child.can_expand) || [];\n\n    let fileIndex = 0;\n\n    return html`\n      <ha-dialog\n        open\n        scrimClickAction\n        escapeKeyAction\n        hideActions\n        flexContent\n        .heading=${this._params.currentItem.title}\n        @closed=${this.closeDialog}\n      >\n        <ha-dialog-header slot=\"heading\">\n          ${this._selected.size === 0\n            ? html`\n                <span slot=\"title\">\n                  ${this.hass.localize(\n                    \"ui.components.media-browser.file_management.title\"\n                  )}\n                </span>\n\n                <ha-media-upload-button\n                  .disabled=${this._deleting}\n                  .hass=${this.hass}\n                  .currentItem=${this._params.currentItem}\n                  @uploading=${this._startUploading}\n                  @media-refresh=${this._doneUploading}\n                  slot=\"actionItems\"\n                ></ha-media-upload-button>\n                ${this._uploading\n                  ? \"\"\n                  : html`\n                      <ha-icon-button\n                        .label=${this.hass.localize(\"ui.common.close\")}\n                        .path=${mdiClose}\n                        dialogAction=\"close\"\n                        slot=\"navigationIcon\"\n                        dir=${computeRTLDirection(this.hass)}\n                      ></ha-icon-button>\n                    `}\n              `\n            : html`\n                <ha-button\n                  class=\"danger\"\n                  slot=\"navigationIcon\"\n                  .disabled=${this._deleting}\n                  .label=${this.hass.localize(\n                    `ui.components.media-browser.file_management.${\n                      this._deleting ? \"deleting\" : \"delete\"\n                    }`,\n                    { count: this._selected.size }\n                  )}\n                  @click=${this._handleDelete}\n                >\n                  <ha-svg-icon .path=${mdiDelete} slot=\"icon\"></ha-svg-icon>\n                </ha-button>\n\n                ${this._deleting\n                  ? \"\"\n                  : html`\n                      <ha-button\n                        slot=\"actionItems\"\n                        .label=${this.hass.localize(\n                          `ui.components.media-browser.file_management.deselect_all`\n                        )}\n                        @click=${this._handleDeselectAll}\n                      >\n                        <ha-svg-icon\n                          .path=${mdiClose}\n                          slot=\"icon\"\n                        ></ha-svg-icon>\n                      </ha-button>\n                    `}\n              `}\n        </ha-dialog-header>\n        ${!this._currentItem\n          ? html`\n              <div class=\"refresh\">\n                <ha-spinner></ha-spinner>\n              </div>\n            `\n          : !children.length\n            ? html`<div class=\"no-items\">\n                <p>\n                  ${this.hass.localize(\n                    \"ui.components.media-browser.file_management.no_items\"\n                  )}\n                </p>\n                ${this._currentItem?.children?.length\n                  ? html`<span class=\"folders\"\n                      >${this.hass.localize(\n                        \"ui.components.media-browser.file_management.folders_not_supported\"\n                      )}</span\n                    >`\n                  : \"\"}\n              </div>`\n            : html`\n                <mwc-list multi @selected=${this._handleSelected}>\n                  ${repeat(\n                    children,\n                    (item) => item.media_content_id,\n                    (item) => {\n                      const icon = html`\n                        <ha-svg-icon\n                          slot=\"graphic\"\n                          .path=${MediaClassBrowserSettings[\n                            item.media_class === \"directory\"\n                              ? item.children_media_class || item.media_class\n                              : item.media_class\n                          ].icon}\n                        ></ha-svg-icon>\n                      `;\n                      return html`\n                        <ha-check-list-item\n                          ${animate({\n                            id: item.media_content_id,\n                            skipInitial: true,\n                          })}\n                          graphic=\"icon\"\n                          .disabled=${this._uploading || this._deleting}\n                          .selected=${this._selected.has(fileIndex++)}\n                          .item=${item}\n                        >\n                          ${icon} ${item.title}\n                        </ha-check-list-item>\n                      `;\n                    }\n                  )}\n                </mwc-list>\n              `}\n        ${isComponentLoaded(this.hass, \"hassio\")\n          ? html`<ha-tip .hass=${this.hass}>\n              ${this.hass.localize(\n                \"ui.components.media-browser.file_management.tip_media_storage\",\n                {\n                  storage: html`<a\n                    href=\"/config/storage\"\n                    @click=${this.closeDialog}\n                  >\n                    ${this.hass.localize(\n                      \"ui.components.media-browser.file_management.tip_storage_panel\"\n                    )}</a\n                  >`,\n                }\n              )}\n            </ha-tip>`\n          : nothing}\n      </ha-dialog>\n    `;\n  }\n\n  private _handleSelected(ev) {\n    this._selected = ev.detail.index;\n  }\n\n  private _startUploading() {\n    this._uploading = true;\n    this._filesChanged = true;\n  }\n\n  private _doneUploading() {\n    this._uploading = false;\n    this._refreshMedia();\n  }\n\n  private _handleDeselectAll() {\n    if (this._selected.size) {\n      this._selected = new Set();\n    }\n  }\n\n  private async _handleDelete() {\n    if (\n      !(await showConfirmationDialog(this, {\n        text: this.hass.localize(\n          \"ui.components.media-browser.file_management.confirm_delete\",\n          { count: this._selected.size }\n        ),\n        warning: true,\n      }))\n    ) {\n      return;\n    }\n    this._filesChanged = true;\n    this._deleting = true;\n\n    const toDelete: MediaPlayerItem[] = [];\n    let fileIndex = 0;\n    this._currentItem!.children!.forEach((item) => {\n      if (item.can_expand) {\n        return;\n      }\n      if (this._selected.has(fileIndex++)) {\n        toDelete.push(item);\n      }\n    });\n\n    try {\n      await Promise.all(\n        toDelete.map(async (item) => {\n          if (isLocalMediaSourceContentId(item.media_content_id)) {\n            await removeLocalMedia(this.hass, item.media_content_id);\n          } else if (isImageUploadMediaSourceContentId(item.media_content_id)) {\n            const media_id = getIdFromUrl(item.media_content_id);\n            if (media_id) {\n              await deleteImage(this.hass, media_id);\n            }\n          }\n          this._currentItem = {\n            ...this._currentItem!,\n            children: this._currentItem!.children!.filter((i) => i !== item),\n          };\n        })\n      );\n    } finally {\n      this._deleting = false;\n      this._selected = new Set();\n    }\n  }\n\n  private async _refreshMedia() {\n    this._selected = new Set();\n    this._currentItem = undefined;\n    this._currentItem = await browseLocalMediaPlayer(\n      this.hass,\n      this._params!.currentItem.media_content_id\n    );\n  }\n\n  static get styles(): CSSResultGroup {\n    return [\n      haStyleDialog,\n      css`\n        ha-dialog {\n          --dialog-z-index: 9;\n          --dialog-content-padding: 0;\n        }\n\n        @media (min-width: 800px) {\n          ha-dialog {\n            --mdc-dialog-max-width: 800px;\n            --dialog-surface-position: fixed;\n            --dialog-surface-top: 40px;\n            --mdc-dialog-max-height: calc(100vh - 72px);\n          }\n        }\n\n        ha-dialog-header ha-media-upload-button,\n        ha-dialog-header ha-button {\n          --mdc-theme-primary: var(--primary-text-color);\n          margin: 6px;\n          display: block;\n        }\n\n        .danger {\n          --mdc-theme-primary: var(--error-color);\n        }\n\n        ha-svg-icon[slot=\"icon\"] {\n          vertical-align: middle;\n        }\n\n        ha-tip {\n          margin: 16px;\n        }\n\n        ha-svg-icon[slot=\"icon\"] {\n          margin-inline-start: 0px !important;\n          margin-inline-end: 8px !important;\n          direction: var(--direction);\n        }\n\n        .refresh {\n          display: flex;\n          height: 200px;\n          justify-content: center;\n          align-items: center;\n        }\n\n        .no-items {\n          text-align: center;\n          padding: 16px;\n        }\n        .folders {\n          color: var(--secondary-text-color);\n          font-style: italic;\n        }\n      `,\n    ];\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"dialog-media-manage\": DialogMediaManage;\n  }\n}\n","import \"@material/mwc-button\";\nimport { mdiUpload } from \"@mdi/js\";\nimport { css, html, LitElement, nothing } from \"lit\";\nimport { customElement, property, state } from \"lit/decorators\";\nimport { fireEvent } from \"../../common/dom/fire_event\";\nimport type { MediaPlayerItem } from \"../../data/media-player\";\nimport {\n  isLocalMediaSourceContentId,\n  uploadLocalMedia,\n} from \"../../data/media_source\";\nimport { showAlertDialog } from \"../../dialogs/generic/show-dialog-box\";\nimport type { HomeAssistant } from \"../../types\";\nimport \"../ha-spinner\";\nimport \"../ha-svg-icon\";\n\ndeclare global {\n  interface HASSDomEvents {\n    uploading: unknown;\n    \"media-refresh\": unknown;\n  }\n}\n\n@customElement(\"ha-media-upload-button\")\nclass MediaUploadButton extends LitElement {\n  @property({ attribute: false }) public hass!: HomeAssistant;\n\n  @property({ attribute: false }) currentItem?: MediaPlayerItem;\n\n  @state() _uploading = 0;\n\n  protected render() {\n    if (\n      !this.currentItem ||\n      !isLocalMediaSourceContentId(this.currentItem.media_content_id || \"\")\n    ) {\n      return nothing;\n    }\n    return html`\n      <mwc-button\n        .label=${this._uploading > 0\n          ? this.hass.localize(\n              \"ui.components.media-browser.file_management.uploading\",\n              {\n                count: this._uploading,\n              }\n            )\n          : this.hass.localize(\n              \"ui.components.media-browser.file_management.add_media\"\n            )}\n        .disabled=${this._uploading > 0}\n        @click=${this._startUpload}\n      >\n        ${this._uploading > 0\n          ? html`\n              <ha-spinner\n                size=\"small\"\n                area-label=\"Uploading\"\n                slot=\"icon\"\n              ></ha-spinner>\n            `\n          : html` <ha-svg-icon .path=${mdiUpload} slot=\"icon\"></ha-svg-icon> `}\n      </mwc-button>\n    `;\n  }\n\n  private async _startUpload() {\n    if (this._uploading > 0) {\n      return;\n    }\n    const input = document.createElement(\"input\");\n    input.type = \"file\";\n    input.accept = \"audio/*,video/*,image/*\";\n    input.multiple = true;\n    input.addEventListener(\n      \"change\",\n      async () => {\n        fireEvent(this, \"uploading\");\n        const files = input.files!;\n        document.body.removeChild(input);\n        const target = this.currentItem!.media_content_id!;\n\n        for (let i = 0; i < files.length; i++) {\n          this._uploading = files.length - i;\n\n          try {\n            // eslint-disable-next-line no-await-in-loop\n            await uploadLocalMedia(this.hass, target, files[i]);\n          } catch (err: any) {\n            showAlertDialog(this, {\n              text: this.hass.localize(\n                \"ui.components.media-browser.file_management.upload_failed\",\n                {\n                  reason: err.message || err,\n                }\n              ),\n            });\n            break;\n          }\n        }\n        this._uploading = 0;\n        fireEvent(this, \"media-refresh\");\n      },\n      { once: true }\n    );\n    // https://stackoverflow.com/questions/47664777/javascript-file-input-onchange-not-working-ios-safari-only\n    input.style.display = \"none\";\n    document.body.append(input);\n    input.click();\n  }\n\n  static styles = css`\n    mwc-button {\n      /* We use icon + text to show disabled state */\n      --mdc-button-disabled-ink-color: --mdc-theme-primary;\n    }\n\n    ha-svg-icon[slot=\"icon\"],\n    ha-spinner[slot=\"icon\"] {\n      vertical-align: middle;\n    }\n\n    ha-svg-icon[slot=\"icon\"] {\n      margin-inline-start: 0px;\n      margin-inline-end: 8px;\n      direction: var(--direction);\n    }\n  `;\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"ha-media-upload-button\": MediaUploadButton;\n  }\n}\n","import type { HomeAssistant } from \"../types\";\n\ninterface Image {\n  filesize: number;\n  name: string;\n  uploaded_at: string; // isoformat date\n  content_type: string;\n  id: string;\n}\n\nexport const URL_PREFIX = \"/api/image/serve/\";\nexport const MEDIA_PREFIX = \"media-source://image_upload\";\n\nexport interface ImageMutableParams {\n  name: string;\n}\n\nexport const getIdFromUrl = (url: string): string | undefined => {\n  let id;\n  if (url.startsWith(URL_PREFIX)) {\n    id = url.substring(URL_PREFIX.length);\n    const idx = id.indexOf(\"/\");\n    if (idx >= 0) {\n      id = id.substring(0, idx);\n    }\n  } else if (url.startsWith(MEDIA_PREFIX)) {\n    id = url.substring(MEDIA_PREFIX.length + 1);\n  }\n  return id;\n};\n\nexport const generateImageThumbnailUrl = (\n  mediaId: string,\n  size?: number,\n  original = false\n) => {\n  if (!original && !size) {\n    throw new Error(\"Size must be provided if original is false\");\n  }\n\n  return original\n    ? `/api/image/serve/${mediaId}/original`\n    : `/api/image/serve/${mediaId}/${size}x${size}`;\n};\n\nexport const fetchImages = (hass: HomeAssistant) =>\n  hass.callWS<Image[]>({ type: \"image/list\" });\n\nexport const createImage = async (\n  hass: HomeAssistant,\n  file: File\n): Promise<Image> => {\n  const fd = new FormData();\n  fd.append(\"file\", file);\n  const resp = await hass.fetchWithAuth(\"/api/image/upload\", {\n    method: \"POST\",\n    body: fd,\n  });\n  if (resp.status === 413) {\n    throw new Error(`Uploaded image is too large (${file.name})`);\n  } else if (resp.status !== 200) {\n    throw new Error(\"Unknown error\");\n  }\n  return resp.json();\n};\n\nexport const updateImage = (\n  hass: HomeAssistant,\n  id: string,\n  updates: Partial<ImageMutableParams>\n) =>\n  hass.callWS<Image>({\n    type: \"image/update\",\n    media_id: id,\n    ...updates,\n  });\n\nexport const deleteImage = (hass: HomeAssistant, id: string) =>\n  hass.callWS({\n    type: \"image/delete\",\n    image_id: id,\n  });\n\nexport const getImageData = async (hass: HomeAssistant, url: string) => {\n  const response = await fetch(hass.hassUrl(url));\n\n  if (!response.ok) {\n    throw new Error(\n      `Failed to fetch image: ${\n        response.statusText ? response.statusText : response.status\n      }`\n    );\n  }\n\n  return response.blob();\n};\n"],"names":["_decorate","customElement","_initialize","_CheckListItemBase","HaCheckListItem","constructor","args","F","d","kind","key","value","async","event","_superPropGet","fireEvent","this","type","static","styles","controlStyles","css","_t","_","CheckListItemBase","_LitElement","decorators","property","attribute","hass","html","localize","nothing","_t2","LitElement","mdiClose","mdiDelete","state","Set","params","_params","_refreshMedia","_filesChanged","onClose","undefined","_currentItem","_uploading","_deleting","dialog","localName","_this$_currentItem","_this$_currentItem2","children","filter","child","can_expand","fileIndex","currentItem","title","closeDialog","_selected","size","_startUploading","_doneUploading","_t3","computeRTLDirection","_t4","count","_handleDelete","_t5","_handleDeselectAll","length","_t9","_handleSelected","repeat","item","media_content_id","icon","_t10","MediaClassBrowserSettings","media_class","children_media_class","_t11","animate","id","skipInitial","has","_t7","_t8","_t6","isComponentLoaded","_t12","storage","_t13","ev","detail","index","showConfirmationDialog","text","warning","toDelete","forEach","push","Promise","all","map","isLocalMediaSourceContentId","removeLocalMedia","isImageUploadMediaSourceContentId","media_id","getIdFromUrl","deleteImage","Object","assign","i","browseLocalMediaPlayer","haStyleDialog","_t14","mdiUpload","_startUpload","input","document","createElement","accept","multiple","addEventListener","files","body","removeChild","target","uploadLocalMedia","err","showAlertDialog","reason","message","once","style","display","append","click","URL_PREFIX","MEDIA_PREFIX","url","startsWith","substring","idx","indexOf","generateImageThumbnailUrl","mediaId","original","Error","createImage","file","fd","FormData","resp","fetchWithAuth","method","status","name","json","callWS","image_id","getImageData","response","fetch","hassUrl","ok","statusText","blob"],"mappings":"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"}